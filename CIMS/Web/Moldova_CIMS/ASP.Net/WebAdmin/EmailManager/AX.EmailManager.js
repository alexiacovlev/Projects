// Email Tempaltes Client Script Library
// Alfa-XP, Michael Isipciuc, 2013.
//
AX.EmailManager=function(e,a,d,c){this.folderPath="/ASP.Net/WebAdmin/EmailManager/";var b=e;this.$listItems=$("#listItems",b);this.$panelDesign=$("#panelDesign",b);this.$listItems.addHandler("click",this.row_onclick,this)};AX.EmailManager.prototype={row_onclick:function(k){var c=k.target;var g=c.getAttribute("cmd");if(!g){return}var m=c.parentNode.parentNode;var b=m.getAttribute("f");if(!b){return}var a=m.getAttribute("t");if(g=="add"){return this.add(b)}else{if(g=="info"){var l=$($(m).children()[4]);var i=$(l.children()[0]).text();var h=$(l.children()[1]).text();this.editInfo(b,a,i,h)}else{if(g=="more"){var j=$(c);j.prev().css("display","block");j.remove()}else{if(g=="edit"){var d="folder="+b+"&name="+a;var f=AX.Window.createFrameWindow("/ASP.Net/WebAdmin/HtmlDesigner/compact.html",a+" - Email Template",950,600);f.HTML_LoadUrl=this.folderPath+"TemplateContent.aspx?load&"+d;f.HTML_SaveUrl=this.folderPath+"TemplateContent.aspx?save&"+d}}}}},add:function(a){var c=$("<div><input class='fm'/><div style='padding-top:10px;font-size:8pt;font-style:italic'>Folder: "+a+"</div></div>");var b=$("INPUT",c);AX.Window.dialog("Register new Template",c,function(){this.registerTemplate(a,b.val())},this);b.focus()},registerTemplate:function(b,a){this.postData("add",b,a,"")},editInfo:function(e,c,g,d){var f=$("<div><div style='font-weight:bold;margin-bottom:5px;font-size:9pt;'>Description:</div><textarea id='tb1' class='fm' style='width: 400px; height: 80px; font-size: 9pt;'></textarea><div style='font-weight:bold;margin-top:10px;margin-bottom:5px;font-size:9pt'>Additional Info:</div><textarea id='tb2' class='fm' style='width: 400px; height: 120px; font-size: 9pt;'></textarea></div>");var b=f.find("textarea#tb1");var a=f.find("textarea#tb2");b.val(g);a.val(d);AX.Window.dialog("Tempalte Info",f,function(){this.saveInfo(e,c,b.val(),a.val())},this,false);b.focus()},saveInfo:function(c,a,e,b){var d={description:e,more:b};this.postData("info",c,a,d)},postData:function(d,b,a,c){$.post(this.folderPath+"TemplateContent.aspx?"+d+"&folder="+b+"&name="+a,c,function(e){if(e!=""){AX.Window.alert(e)}else{window.location.reload()}},"html")}};