<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/tr/xhtml11/dtd/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" class="redTableWizard"><head>
<base target="_self" />
<title>
        Table Wizard
</title>
<link href="axd_dialog_tablewizard.skins.form.css" type="text/css" rel="stylesheet" /></head>
<body><form method="post" action="Telerik.Web.UI.DialogHandler.aspx?DialogName=TableWizard&amp;UseRSM=true&amp;Skin=Default&amp;Title=Table+Wizard&amp;doid=7641970f-7c9c-4cbc-bf61-393cb650a852&amp;dpptn=&amp;dp=aWFXSiwmV1BzZGdOG2cYXGIfC201ZxE0TDQDMwEwSzsMOjdRCgQWFwd5CQ9iD3lTWm4gEiEcaUl4ZDJLIlwITlp7G1U3Oy8xdRU2BwoKdTI1WxVYCwEzWTdpZVJuak9aXlskEhQcFkl0dBAXIHMycGEfIUMOBgo2YwkPIQIwSy01BCxZCikWHjp5JE5tDWVGYVsOVxQTfUxDAWJSE3cmX1oPYFcCHRE2dRhOHDowZjIEBAZYJXARHS5tJG9lDG1QbFoKaRYMaQlvZT5GFwAmBm4kD0swAzcZeiM5HwodX3QCLjR4JQQoNgZmBll6eAIYYltXcRAcZkVEeyZqI3YAWG8faA02EyQ4TQkhLg8iQzMDAiRYJwUOJix5aXVmDX18bFoGFhcMYUhDexxqI3cYRG8fMggCOTMVS38fIzoxaXQPEwpYIi8OHy5mMHZleGEcb3ESbBEeHmlwaz5oFEobQGwkFwoOZDg7eSM1HwshaXQBBRFTIhQ0NzVEHlJVaG1Qb3MsYSAcfWRyXRhPFwB%2fem8kMUoCAjQ4SwoDHTkNcXUCPjBsJBQoNjV6EmhleGJTb1oGaRQOH0V0ZxcQE2giB2IQE0wNAgUETho9BzpVVzsDLgYbJwE8KTp5JEJtbkBdd3IWbywcGlJFZBBJG2MycGEfIUMOBgo2YwsLLBYvYRYAAnASCXISGzp5FkttaGFeYls0SS8MeVdwXhBdG2YEB10fIVU3ZxUtdRUqBwoKdTI1WxVYCzs8OwBAClR4DVtQbgQWUhcnfUpFZBhIDXUQX1oAF1UYETAyfSA9BztVZnw%3d" id="Form1">
<div class="aspNetHidden">
<input type="hidden" name="RadScriptManager1_TSM" id="RadScriptManager1_TSM" value="" />
<input type="hidden" name="RadStyleSheetManager1_TSSM" id="RadStyleSheetManager1_TSSM" value="" />
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="" />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['Form1'];
if (!theForm) {
    theForm = document.Form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>


<script src="axd_dialog_forms.js" type="text/javascript"></script>
<script src="axd_dialog_tablewizard.js" type="text/javascript"></script>


<div class="aspNetHidden">

        <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEdAAJOwGmWsP6uJBHj2S7rq+7+r1eUXYH2SY42AOoXP1wAYwwtExvkfqWd5rjkjj5BAx+YMOYvo6hjht9NDEjEaOHM" />
</div><script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('RadScriptManager1', 'Form1', [], [], [], 90, '');
//]]>
</script>
<input type="hidden" name="dialogParametersHolder" id="dialogParametersHolder" /><div id="dialogsDecorator" class="RadFormDecorator" style="display:none;">
        <!-- 2013.3.1015.45 --><script type="text/javascript">
//<![CDATA[
if (typeof(WebForm_AutoFocus) != 'undefined')
{
        var old_WebForm_AutoFocus = WebForm_AutoFocus;
        WebForm_AutoFocus = function(arg)
        {
                Sys.Application.add_load(function()
                {
                        old_WebForm_AutoFocus(arg);
                        WebForm_AutoFocus = old_WebForm_AutoFocus;
                });
        }
}
if (typeof(Telerik) != 'undefined' && Type.isNamespace(Telerik.Web))
{
        if (Telerik.Web.UI.RadFormDecorator)
        {
                Telerik.Web.UI.RadFormDecorator.initializePage("dialogsDecorator", "", "Default", 65527);
        }
}
//]]>
</script><input id="dialogsDecorator_ClientState" name="dialogsDecorator_ClientState" type="hidden" />
</div><div id="initializer">
        <div id="dialogControl">
                <div id="resourcesTableWizard">
                        <script type="text/javascript">
//<![CDATA[
if (typeof(localization) == "undefined")
{
        var localization = {
                _fill : function(newStrings)
                {
                        for (var key in newStrings)
                        {
                                this[key] = newStrings[key];
                        }
                },
                setTitle : function(elementId, resourceKey) {
                        $get(elementId).title = this[resourceKey];
                }
        };
}
localization._fill({ActualSize:"Actual Size",Add:"Add",AddCustomColor:"Add Custom Color...",AddCustomTarget:"[add custom target...]",AllowedExtensions:"File extensions allowed",AllProperties:"All Properties...",ApplyClass:"Apply Class",Back:"Back",BackgroundColor:"Background Color",BackgroundImage:"Back Image",BestFit:"Best Fit",BorderColor:"Border Color",BorderWidth:"Border Width",Bottom:"Bottom",bytes:"bytes",Cancel:"Cancel",CellCss:"Cell CSS",ClassID:"Specify Class ID",ClassIDText:"Class ID",Clear:"Clear",ClearClass:"Clear Class",Client_AlertFile:"Please, provide file to upload!",ConfirmDelete:"Are you sure you want to delete the selected item?\r\nIt might still be in use. If deleted, some pages will not be displayed properly.\r\nPress \"OK\" to confirm deletion.",Close:"Close",ConstrainProportions:"Constrain proportions?",ControlButtons:"Control Buttons",Copy:"Copy",Create:"Create",CreateNewFolder:"Enter the new folder name",CreateThumbnail:"Create thumbnail",CssClass:"CSS Class",Decrease:"Decrease",Delete:"Delete",GridView:"Grid View",ThumbnailsView:"Thumbnails View",DimensionUnit:"Dimension unit",FileExists:"A file with a name same as the target already exists!",FileListSummary:"Table that lists the contents of the current directory",Forward:"Forward",GridPagerText:"{4} Page <strong>{0}</strong> of <strong>{1}</strong>. Items <strong>{2}</strong> to <strong>{3}</strong> of <strong>{5}</strong>",GridSortedAscToolTip:"Sort asc",GridSortedDescToolTip:"Sort desc",GridSortToolTip:"Click here to sort",Height:"Height",Id:"Id",ImageAltText:"Alt Text",ImageTitleText:"Title Text",ImageEditor:"Image Editor",ImageFieldSet:"Image Properties",Increase:"Increase",Insert:"Insert",InvalidCharactersInPath:"Invalid characters in folder name.",InvalidFileExtension:"The extension of the uploaded file is not valid. Please, provide a valid file!",InvalidFileSize:"The size of the uploaded file exceeds max size allowed",Kilobytes:"KB",Left:"Left",LookIn:"Look in",MaxFileSize:"Max file size allowed",Margin:"Margin",Megabytes:"MB",MessageCannotWriteToFolder:"Cannot write to the target folder!",MessageNoValidDimensions:"Please, provide valid image dimensions",MessageSourceNotLocal:"The specified for conversion image file resides on a different server!",Middle:"Middle",NameExists:"An object with the same name already exists in this directory!",NewFolder:"New Folder",NewImageName:"New image name",No:"No",None:"None",NonExistingFolder:"You are trying to navigate to a non-existing folder or you do not have proper permissions to view this folder. Please, contact the administrator.",NoPermissionsToCreateFolder:"The selected folder could not be created because the application did not have enough permissions. Please, contact the administrator.",NoPermissionsToDeleteFile:"The selected file could not be deleted because the application did not have enough permissions. Please, contact the administrator.",NoPermissionsToDeleteFolder:"The selected folder could not be deleted because the application did not have enough permissions. Please, contact the administrator.",NoUploadedFile:"Please, select a file to upload!",OK:"OK",Open:"Open",OverwriteExisting:"Overwrite if file exists?",Percent:"Percent",Pixel:"Pixel",Preview:"Preview",Properties:"Properties",PropertiesPanel:"Properties panel",Refresh:"Refresh",Remove:"Remove",Rename:"Rename",Right:"Right",Select:"Select",SelectFile:"Select file",SortByExt:"Ext",SortByExtTitle:"Sort by Extension",SortByFilename:"Filename",SortByFilenameTitle:"Sort by Filename",SortBySize:"Size",SortBySizeTitle:"Sort by Size",StyleBuilder:"Style Builder",TableCss:"Table CSS",Target:"Target",TargetBlank:"New Window",TargetMedia:"Media Pane",TargetParent:"Parent Window",TargetSearch:"Search Pane",TargetSelf:"Same Window",TargetTop:"Browser Window",Top:"Top",Up:"Up",Upload:"Upload",UploadFile:"Upload",Uploading:"Uploading...",Url:"URL",Width:"Width",Yes:"Yes",ZoomIn:"Zoom In",ZoomOut:"Zoom Out",Black:"Black",Blue:"Blue",Green:"Green",NoColor:"No Color",Orange:"Orange",Red:"Red",White:"White",Yellow:"Yellow",CustomTargets:"Custom Targets",PresetTargets:"Preset Targets",Paste:"Paste",UseControlVMessage:"Please, use CTRL + V to paste below the content you would like to be cleaned",PasteHtmlMessage:"Please, insert the Html content, which you want to paste",PasteMarkdownMessage:"Please, insert the Markdown content, which you want to paste"});
localization._fill({AccessibilityOptions:"Accessibility Options",AddHexColor:"Add Hex Color...",Additional:"Additional",Alignment:"Alignment",AllFourSides:"All four sides",AllRowsAndColomns:"All rows and columns",ApplySpecialFormatsTo:"Apply special formats to",AssociateCellsWithHeaders:"Associate cells with headers",Baseline:"Baseline",Betweenall:"Between all rows and columns",BetweenColumns:"Between columns",Betweengroup:"Between row and column group",BetweenRows:"Between rows",Border:"Border",Bottom:"Bottom",BottomSide:"Bottom side only",Caption:"Caption",CaptionAlign:"Caption Align",CellPadding:"Cell Padding",CellSpacing:"Cell Spacing",Center:"Center",Columns:"Columns",ColumnSettings:"Column Number and Column Span",ColumnSpan:"Column Span",Content:"Content",ContentAlignment:"Content Alignment",Custom:"Custom",Customh:"Custom -",Dimensions:"Dimensions",Frame:"Frame",FirstColumn:"First Column",HeadingColumns:"Heading columns",HeadingRows:"Heading rows",HeadingRow:"Heading Row",HeadingsLabel:"Headings",Horizontal:"Horizontal",InvalidCellHeight:"Invalid cell height.",InvalidCellWidth:"Invalid cell width.",InvalidTableHeight:"Invalid table height.",InvalidTableWidth:"Invalid table width.",Layout:"Layout",LeftAndRightSide:"Right and left sides only",LeftSide:"Left side",LastColumn:"Last Column",LastRow:"Last Row",Middle:"Middle",NoBorders:"No borders",NoCSSClassLayout:"No CSS Class Layout",NoInteriorBorders:"No interior borders",NoTextWrapping:"no text wrapping",NoWrapping:"No Wrapping",OtherOptionsLabel:"Other Options",PixelsOrPercents:"pixels, %",PromptColor:"Please, provide the custom color HEX value",Right:"Right",RightSide:"Right-hand side only",Rows:"Rows",RowSettings:"Row Number and Row Span",RowSpan:"Row Span",SelectAll:"Select All",Size:"Size",Summary:"Summary",Tab1HeaderText:"Table Design",Tab2HeaderText:"Table Properties",Tab3HeaderText:"Cell Properties",Tab4HeaderText:"Accessibility",TableBorderControlSizeOverflow:"You are trying to set border size to a greater value than maximum (1000). It will be set to 1000.",TableControls:"Table Controls",TableDesignPreviewLabel:"Table Design Preview",Title:"Table Wizard",TopAndBottomSide:"Top and bottom sides only",TopSide:"Top side only",UseColor:"Use Color",Vertical:"Vertical"});
//]]>
</script>
<input id="resourcesTableWizard_ClientState" name="resourcesTableWizard_ClientState" type="hidden" />
                </div>

<script type="text/javascript">
Type.registerNamespace("Telerik.Web.UI.Widgets");

Telerik.Web.UI.Widgets.TablePreview = function(element)
{
        Telerik.Web.UI.Widgets.TablePreview.initializeBase(this);

        this._previewHolder = null;
        this._previewTable = null;
        this._editedCells = [];
        this._selectedCell = null;
        this._selectedCells = [];
        this._allowMultiCellSelection = false;
        this._selectAllButton = null;
        this._selectAllHolder = null;
}

Telerik.Web.UI.Widgets.TablePreview.prototype = {
        initialize : function()
        {
                Telerik.Web.UI.Widgets.TablePreview.callBaseMethod(this, "initialize");
        },

        _configureChildren : function()
        {
                var dummyTable = document.createElement("table");
                dummyTable.className = "tableDesign";
                this._previewHolder.appendChild(dummyTable);
                this._previewTable = dummyTable;

                //select all element
                var divSelectAllHolder = document.createElement("div");
                divSelectAllHolder.style.cssText = "display: none; text-align: right; margin-top: 3px; margin-right: 3px;";
                this._selectAllHolder = divSelectAllHolder;
                var btnSelectAll = document.createElement("a");
                btnSelectAll.href = "javascript: void(0);";
                btnSelectAll.title = localization["SelectAll"];
                btnSelectAll.innerHTML = localization["SelectAll"];
                var attributeName = ($telerik.isIE) ? "className" : "class";
                btnSelectAll.setAttribute(attributeName, "reTableWizardSelectAllBtn");
                this._selectAllButton = btnSelectAll;
                this._selectAllHolder.appendChild(this._selectAllButton);
                this._previewHolder.appendChild(this._selectAllHolder);
                $addHandlers(this._selectAllButton, {"click" : this._handleSelectAllButtonClick}, this);
        },

        _updateTable : function(modelTable, selectedCell)
        {
                var newTable = document.createElement("table");
                newTable.className = "tableDesign";
                newTable.cellPadding = 1;
                newTable.cellSpacing = 1;

                for (var i=0; i < modelTable.rows.length; i++)
                {
                        var currentRow = modelTable.rows[i];
                        var newRow = newTable.insertRow(-1);//newTable.rows.length
                        for (var j=0; j<currentRow.cells.length; j++)
                        {
                                var currentCell = currentRow.cells[j];
                                var newCell = newRow.insertCell(-1);//newRow.cells.length

                                newCell.rowSpan = currentCell.rowSpan;
                                newCell.colSpan = currentCell.colSpan;
                                if (currentCell == selectedCell)
                                {
                                        this._selectCell(newCell);
                                }
                                else
                                {
                                        this._deSelectCell(newCell);
                                }

                                newCell.theTablePreviewControl = this;
                                $addHandlers(newCell, {"click" : this._handleCellClick}, this);
                                newCell.innerHTML = "&nbsp;&nbsp;";
                        }
                }
                this._previewTable.parentNode.replaceChild(newTable, this._previewTable);
                this._previewTable = newTable;
        },

        _handleSelectAllButtonClick: function(e)
        {
                if (this._allowMultiCellSelection)
                {
                        var rows = this._previewTable.rows;
                        var rl = rows.length;
                        for (var i = 0; i < rl; i++)
                        {
                                var cells = rows[i].cells;
                                var cl = cells.length;
                                for (var j = 0; j < cl; j++)
                                {
                                        this._selectCell(cells[j]);
                                }
                        }
                }
        },

        _handleCellClick : function(e)
        {
                var cell = null;
                if (!e)
                        cell = window.event.srcElement;
                else
                        cell = e.target;

                if (this._allowMultiCellSelection && e.ctrlKey)
                {
                        /**
                         *
                         * If the control key is pressed a multiple selection
                         * is being done.
                         *
                         */
                        if (this._isCellSelected(cell))
                        {
                                this._deSelectCell(cell);
                        }
                        else
                        {
                                this._selectCell(cell);
                        }
                }
                else
                {
                        this._changeSelectedCell(cell);
                }
        },

        _changeSelectedCell : function(cell)
        {
                this.set_editedCells(this.get_selectedCells());
                var isCellSelected = this._isCellSelected(cell);
                var isMultiCellSelection = this._isMultiCellSelection();
                this.deSelectAllCells();
                if (!isCellSelected || isMultiCellSelection)
                {
                        this._selectCell(cell);
                }

                if (this._onSelectedCellChanged)
                {
                        this._onSelectedCellChanged();
                }
        },

        _getCellIndex : function(oCell)
        {

                var selCol = oCell ? (oCell.cellIndex) : 0;

                if ($telerik.isSafari) //SAFARI
                {
                        var oP = oCell.parentNode;
                        for (var i = 0; i < oP.cells.length; i++)
                        {
                                if (oCell == oP.cells[i])
                                {
                                        selCol = i;
                                        break;
                                }
                        }
                }
                return selCol;
        },

        _selectCell : function(cell)
        {
                this._selectedCell = cell;

                var rowIndex  = cell.parentNode.rowIndex;
                var cellIndex = this._getCellIndex(cell);//cell.cellIndex; TEKI - SAFARI support.

                if (typeof(this._selectedCells[rowIndex]) == 'undefined')
                {
                        this._selectedCells[rowIndex] = [];
                }

                this._selectedCells[rowIndex][cellIndex] = cell;

                //TODO do this with $telerik.addCssClasses
                cell.className = "selectedCell";
        },

        _deSelectCell : function(cell)
        {
            if(!cell) return;
                if (this._isCellSelected(cell))
                {
                        var rowIndex  = cell.parentNode.rowIndex;
                        var cellIndex = this._getCellIndex(cell);//cell.cellIndex; TEKI - SAFARI support. Defined in Common.js
                        if (rowIndex >=0 && cellIndex >=0)
                        {
                                this._selectedCells[rowIndex][cellIndex] = null;
                        }
                        if (cell == this._selectedCell)
                        {
                                this._selectedCell = null;
                        }
                }

                cell.className = "";
        },

        deSelectAllCells : function ()
        {
                var selectedCells = this.get_selectedCells();
                for (var i = 0; i < selectedCells.length; i ++)
                {
                        this._deSelectCell(selectedCells[i]);
                }

                this._selectedCells = [];
        },

        _isCellSelected : function(cell)
        {
                return (cell && cell.className == "selectedCell"); // Or use the this.selectedCells Array ?
        },

        _isMultiCellSelection : function ()
        {
                return (this.get_selectedCells().length > 1);
        },

        get_previewHolder : function()
        {
                return this._previewHolder;
        },

        set_previewHolder : function(value)
        {
                this._previewHolder = value;

                if(this._previewHolder) this._configureChildren();
        },

        set_editedCells : function(editedCells)
        {
                this._editedCells = editedCells;
        },

        get_editedCells : function()
        {
                return this._editedCells;
        },

        get_previewTable : function()
        {
                return this._previewTable;
        },

        get_selectedCells : function()
        {
                var selectedCells = [];
                for (var rowIndex in this._selectedCells)
                {
                        for (var cellIndex in this._selectedCells[rowIndex])
                        {
                                selectedCells.push(this._selectedCells[rowIndex][cellIndex]);
                        }
                }
                return selectedCells;
        },

        get_selectedCell : function()
        {
                var selectedCells = this.get_selectedCells();
                if (selectedCells && selectedCells.length > 0)
                {
                        return selectedCells[selectedCells.length - 1];
                }
                return null;
        },

        set_allowMultiCellSelection : function(value)
        {
                this._selectAllHolder.style.display = (value) ? "" : "none";
                this._allowMultiCellSelection = value;
        },

        _disposeChildEvents : function()
        {
                if(this._previewTable)
                {
                        for (var i=0; i < this._previewTable.rows.length; i++)
                        {
                                var currentRow = this._previewTable.rows[i];
                                for (var j=0; j<currentRow.cells.length; j++)
                                {
                                        $clearHandlers(currentRow.cells[j]);
                                }
                        }
                }
        },

        dispose : function()
        {
                this._disposeChildEvents();

                this._previewHolder = null;
                this._previewTable = null;
                this._editedCells = [];
                this._selectedCell = null;
                this._selectedCells = [];

                Telerik.Web.UI.Widgets.TablePreview.callBaseMethod(this, "dispose");
        }
}

Telerik.Web.UI.Widgets.TablePreview.registerClass('Telerik.Web.UI.Widgets.TablePreview', Sys.Component);

Telerik.Web.UI.Widgets.TableWizard = function(element)
{
        Telerik.Web.UI.Widgets.TableWizard.initializeBase(this, [element]);

        this._clientParameters = null;
        this._insertButton = null;
        this._cancelButton = null;
        this._table = null;
        this._originalSelectedCell = null;
        this._currentlyEditedCell = null;
        this._originalTableClone = null;
        this._selectedTabIndex = 0;

        this._selectedCell = null;
        this._selectedCellIndex        = -1;

        this._accessibleTableControl = null;
        this._tablePropertiesControl = null;
        this._tableDesignControl = null;
        this._cellPropertiesControl        = null;
        this._tablePreviewControl = null;

        //Due to dialog caching make and difference in sequence of initialization we will use a trick to call
        this._isLoaded = false;
}

Telerik.Web.UI.Widgets.TableWizard.prototype = {
        initialize: function ()
        {
                Telerik.Web.UI.Widgets.TableWizard.callBaseMethod(this, 'initialize');
                this._setupChildren();
        },

        _initializeControl: function ()
        {
                var params = this._clientParameters;
                if (params.selectedTabIndex && params.selectedTabIndex >= 0)
                {
                        this._tab.set_selectedIndex(params.selectedTabIndex);
                        this._selectedTabIndex = params.selectedTabIndex;
                }

                //New - initialize manually subcontrols
                this._tableDesignControl.clientInit(params);
                this._tablePropertiesControl.clientInit(params);
                this._cellPropertiesControl.clientInit(params);
                this._accessibleTableControl.clientInit(params);


                this.tabChangedHandler = Function.createDelegate(this, this._tabChangedHandler);
                this._tab.add_tabSelected(this.tabChangedHandler);
                this._loadTableProperties();
        },

        //Called also when a dilog is cached
        clientInit: function (clientParameters)
        {
                this._clientParameters = clientParameters;
                this._table = this._clientParameters.originalTable;
                this._originalTableClone = this._clientParameters.tableToModify;
                this._originalSelectedCell = this._clientParameters.cellToModify;

                this._initializeControl();
        },

        _tabChangedHandler: function (sender, args)
        {
                var selectedTab = sender.get_selectedIndex();
                this._initTabControl(selectedTab);
                this._selectedTabIndex = selectedTab;
        },

        _loadTableProperties: function ()
        {
                this._initTabControl(this._selectedTabIndex);
        },

        _initTabControl: function (selectedTab)
        {
                switch (selectedTab)
                {
                        case 0:
                                this._initDesigner();
                                break;
                        case 1:
                                this._initTableProperties();
                                break;
                        case 2:
                                this._initCellProperties();
                                break;
                        case 3:
                                this._initAccessibleTable();
                                break;
                }
        },

        _setupChildren: function ()
        {
                this._tableDesignControl = $find("tableDesignPanel");
                this._tablePropertiesControl = $find("tablePropertiesPanel");
                this._cellPropertiesControl = $find("cellPropertiesPanel");
                this._accessibleTableControl = $find("accessibilityPanel");

                this._tablePreviewControl = this._cellPropertiesControl.get_tablePreviewControl();

                this._insertButton = $get("InsertButton");
                this._cancelButton = $get("CancelButton");

                this._tab = $find("TableWizardTab");

                this._initializeChildEvents();
        },

        _initializeChildEvents: function ()
        {
                $addHandlers(this._insertButton, { "click": this._insertClickHandler }, this);
                $addHandlers(this._cancelButton, { "click": this._cancelClickHandler }, this);
        },

        _removeEmptyThead: function (table)
        {
                if (!table) return;
                var thead = table.tHead;
                if (thead && thead.innerHTML.match(/^\s*$/))
                {
                        table.removeChild(thead);
                }
        },

        _getModifiedTable: function ()
        {
                this._accessibleTableControl.set_tableToModify(this._table.cloneNode(true));
                this._originalTableClone = this._accessibleTableControl._updateTable();

                this._tablePropertiesControl.set_tableToModify(this._originalTableClone);
                var modifiedTable = this._tablePropertiesControl._updateTable();
                if (modifiedTable) this._originalTableClone = modifiedTable;
                this._removeEmptyThead(this._originalTableClone);
                return this._originalTableClone;
        },

        _insertClickHandler: function (e)
        {
                if (!this._saveLastEditedCellProperties(false))
                {
                        return;
                }
                Telerik.Web.UI.Dialogs.CommonDialogScript.get_windowReference().close({
                        tableToModify: this._getModifiedTable()
                    , styleSheetToImport: this._tablePropertiesControl._tableBorderControl._selectedStyleSheet
                    , styleSheetToRemove: this._tablePropertiesControl._tableBorderControl._styleSheetToRemove
                });
        },

        _cancelClickHandler: function (e)
        {
                if (this._table && this._table.parentNode) //TEKI: According to SAFARI parentNode could be null when Cancel is pressed
                        this._table.parentNode.replaceChild(this._originalTableClone, this._table);
                this._table = this._originalTableClone;

                Telerik.Web.UI.Dialogs.CommonDialogScript.get_windowReference().close();
        },

        /////////////////////////////////////////////////////////
        _getCurrentlyEditedCell: function ()
        {
                return this._currentlyEditedCell;
        },

        _onCellPropertiesSelectedCellChanged: function ()
        {
                // Update the last edited cells
                var editedCells = this._tablePreviewControl.get_editedCells();
                this._cellPropertiesControl._updateMultiple(this._getModifyCellsForPreviewCells(editedCells));

                this._synchronizeSelectedCell();

                if (this._selectedCell)
                {
                        this._currentlyEditedCell = this._selectedCell;
                        this._cellPropertiesControl._loadPropertyValues(this._selectedCell);
                }
        },

        _onCellPropertiesSelectedMultipleCells: function ()
        {
                this._cellPropertiesControl._clear();
        },


        _synchronizeSelectedCell: function ()
        {
                var previewSelectedCell = this._tablePreviewControl.get_selectedCell();
                var previewTable = this._tablePreviewControl.get_previewTable();

                var previewTableRows = previewTable.rows;

                this._selectedCell = null;
                this._selectedCellIndex = -1;

                for (var i = 0; i < previewTableRows.length; i++)
                {
                        var previewTableCells = previewTableRows[i].cells;
                        for (var j = 0; j < previewTableCells.length; j++)
                        {
                                if (previewTableCells[j] == previewSelectedCell)
                                {
                                        this._selectedCell = (this._table.rows.length > 0) ? this._table.rows[i].cells[j] : null;

                                        this._selectedCellIndex = j;
                                        return;
                                }
                        }
                }
        },

        _synchronizeSelection: function (selectedCell, selectedIndex)
        {
                this._selectedCell = selectedCell;
                this._selectedCellIndex = selectedIndex;
        },

        /**
        *
        * For a given preview cell return the model cell
        *
        */
        _getModifyCellForPreviewCell: function (previewCell)
        {
                if (!previewCell) return null;
                var rowIndex = previewCell.parentNode.rowIndex;
                var cellIndex = this._tablePreviewControl._getCellIndex(previewCell); // PreviewCell.cellIndex; TEKI - SAFARI support! Defined in Common.js

                return (this._table.rows.length > 0) ? this._table.rows[rowIndex].cells[cellIndex] : null;
        },

        _getModifyCellsForPreviewCells: function (previewCells)
        {
                var modifyCells = [];

                for (var i = 0; i < previewCells.length; i++)
                {
                        modifyCells.push(this._getModifyCellForPreviewCell(previewCells[i]));
                }

                return modifyCells;
        },

        _saveLastEditedCellProperties: function (saveSelectedCell)
        {
                if (this._currentlyEditedCell)
                {

                        var selectedCells = this._tablePreviewControl.get_selectedCells();
                        if (!this._cellPropertiesControl._updateMultiple(this._getModifyCellsForPreviewCells(selectedCells)))
                        {
                                return false;
                        }
                        if (!saveSelectedCell)
                        {
                                this._selectedCell = null;
                                this._selectedCellIndex = -1;
                        }
                }
                return true;
        },

        _initCellProperties: function ()
        {
                /*WARNING! POSSIBLE CROSS REFERENCE! */
                var theTableWizardControl = this;
                this._tablePreviewControl._onSelectedCellChanged = function anon()
                {
                        theTableWizardControl._onCellPropertiesSelectedCellChanged();
                };
                this._tablePreviewControl.deSelectAllCells();
                this._tablePreviewControl.set_allowMultiCellSelection(true);

                if (!this._originalSelectedCell)
                {
                        if (!this._selectedCell)
                                this._initSelectedCell();
                }
                else
                {
                        this._selectedCell = this._originalSelectedCell;
                        //Clear the originally selected cell.
                        this._originalSelectedCell = null;
                }

                this._tablePreviewControl._updateTable(this._table, this._selectedCell);

                this._currentlyEditedCell = this._selectedCell;
                this._cellPropertiesControl.set_cellToModify(this._currentlyEditedCell);
                this._cellPropertiesControl._loadPropertyValues(this._currentlyEditedCell);
        },

        _initTableProperties: function ()
        {
                if (!this._originalSelectedCell)
                {
                        if (!this._selectedCell)
                                this._initSelectedCell();
                }
                else
                {
                        this._selectedCell = this._originalSelectedCell;
                        //Clear the originally selected cell.
                        this._originalSelectedCell = null;
                }

                this._currentlyEditedCell = this._selectedCell;
                this._tablePropertiesControl.set_tableToModify(this._table.cloneNode(true));
                this._initCellProperties();
        },

        _initAccessibleTable: function ()
        {
                //Clear the originally selected cell.
                this._originalSelectedCell = null;

                this._saveLastEditedCellProperties(true);
                this._accessibleTableControl.set_tableToModify(this._table.cloneNode(true));
        },

        _initSelectedCell: function ()
        {
                if (this._table.rows.length > 0)
                {
                        if (this._table.rows[0].cells.length > 0)
                        {
                                this._selectedCell = this._table.rows[0].cells[0];
                        }
                }
        },

        _initDesigner: function ()
        {
                //Clear the originally selected cell.
                this._originalSelectedCell = null;
                this._saveLastEditedCellProperties(true);

                this._tableDesignControl.set_tableWizardControl(this);

                //NEW _initSelectedCell on every opening of the Table Wizard
                if (!this._selectedCell || this._tableDesignControl._selectedCell != this._selectedCell)
                        this._initSelectedCell();

                this._tableDesignControl.set_selectedCell(this._selectedCell);
        },


        //////////////////////////////////////////////////////////


        dispose: function ()
        {
                $clearHandlers(this._insertButton);
                $clearHandlers(this._cancelButton);

                this._tab.remove_tabSelected(this.tabChangedHandler);

                this._clientParameters = null;
                this._insertButton = null;
                this._cancelButton = null;
                this._table = null;
                this._originalSelectedCell = null;
                this._currentlyEditedCell = null;
                this._originalTableClone = null;
                this._selectedCell = null;
                this._tablePreviewControl = null;

                this._accessibleTableControl = null;
                this._tablePropertiesControl = null;
                this._tableDesignControl = null;
                this._cellPropertiesControl = null;

                Telerik.Web.UI.Widgets.TableWizard.callBaseMethod(this, 'dispose');
        }
}

Telerik.Web.UI.Widgets.TableWizard.registerClass('Telerik.Web.UI.Widgets.TableWizard', Telerik.Web.UI.RadWebControl, Telerik.Web.IParameterConsumer);
</script>

<style type="text/css">
/* NEW TABLE WIZARD DIALOG */

#TableDesign_PreviewTableHolder
{
   clear: both;
   padding-top: 4px;
}

#TableDesign_PreviewTableHolder table
{
    clear: both;
}

.reDialog .spinList
{
    height: 26px;
}

.reDialog .spinItem span
{
    line-height: 26px;
}
/*.reDialog.reTableWizard
{
        height: 420px;
        float: left;
}

*+html .reDialog.reTableWizard
{
        height: 410px;
}

.reDialog.reTableWizard .dialogtabstrip
{
        width: 653px;
}

.reDialog.reTableWizard .dialogtabstrip .tabIcon
{
        display: none;
}

.reDialog.reTableWizard .customControl .reToolbar,
.reDialog.reTableWizard .customControl .reToolbar li
{
        background: none;
}

.reDialog.reTableWizard .reColorPickerContainer li,
.reDialog.reTableWizard .reAlignmentContainer li
{
        height: 24px !important;
        line-height: 24px;
}

.reDialog.reTableWizard .customControl .reGrip
{
        display: none;
}

.reDialog.reTableWizard #tableWizardControlButtons
{
        position: absolute;
        bottom: 0;
        left: 17px;
        width: 620px;
        border: 0;
        border-top: 1px solid #868686;

        padding: 0;
        margin: 0;
}

.reDialog.reTableWizard #tableWizardControlButtons .floatright
{
        margin: 8px 0 0;
        padding: 0;
}

.reDialog.reTableWizard #tableWizardControlButtons legend
{
        display: none;
}

.reDialog.reTableWizard #tableWizardControlButtons ul
{
        list-style-type: none;
        width: 150px;
}

.reDialog.reTableWizard table.tableDesignPreview
{
        border: 0;
        background: #b0b0b0;
        empty-cells: show;
        width: 310px;
        height: 256px;
}

.reDialog.reTableWizard table.tableDesignPreview td
{
        background: #ececec;
        padding: 0; margin: 0;
        cursor: pointer;
        border: 1px solid #fdfdfd;
        width: auto !important;
}

.reDialog.reTableWizard table.tableDesignPreview td.reSelectedCell
{
        background: #cecece;
        border: 1px solid #d6d6d6;
}*/
/* END OF NEW TABLE WIZARD DIALOG */
</style>
<!-- table wizard -->
<table cellpadding="0" cellspacing="0" class="reDialog NoMarginDialog TableWizard" style="width: 706px">
        <tr>
                <td class="reTopcell">
                        <div id="TableWizardTab" class="RadTabStrip RadTabStrip_Default RadTabStripTop_Default RadTabStripTop_Default_Baseline">
                        <div class="rtsLevel rtsLevel1">
                                <ul class="rtsUL"><li class="rtsLI rtsFirst"><a title="Table Design" class="rtsLink rtsSelected" href="#"><span class="rtsOut"><span class="rtsIn"><span class="rtsTxt">Table Design</span></span></span></a></li><li class="rtsLI"><a title="Table Properties" class="rtsLink rtsAfter" href="#"><span class="rtsOut"><span class="rtsIn"><span class="rtsTxt">Table Properties</span></span></span></a></li><li class="rtsLI"><a title="Cell Properties" class="rtsLink" href="#"><span class="rtsOut"><span class="rtsIn"><span class="rtsTxt">Cell Properties</span></span></span></a></li><li class="rtsLI rtsLast"><a title="Accessibility" class="rtsLink" href="#"><span class="rtsOut"><span class="rtsIn"><span class="rtsTxt">Accessibility</span></span></span></a></li></ul>
                        </div><input id="TableWizardTab_ClientState" name="TableWizardTab_ClientState" type="hidden" />
                </div>
                </td>
        </tr>
        <tr>
                <td class="reMiddlecell reTableWizardDialog" style="height: 400px; padding: 0; vertical-align: top;">
                        <div id="dialogMultiPage">
                        <div id="tableDesignRow">

                                        <div id="tableDesignPanel">
                                        <div id="resourcesTableDesign">
                                                <script type="text/javascript">
//<![CDATA[
localization._fill({});
//]]>
</script>
<input id="resourcesTableDesign_ClientState" name="resourcesTableDesign_ClientState" type="hidden" />
                                        </div>
<script type="text/javascript">
        Type.registerNamespace("Telerik.Web.UI.Widgets");

        Telerik.Web.UI.Widgets.TableDesign = function (element)
        {
                Telerik.Web.UI.Widgets.TableDesign.initializeBase(this, [element]);

                this._clientParameters = null;
                this._currentRowSpan = 1;
                this._currentColSpan = 1;

                this._spinBoxColumns = null;
                this._spinBoxColumnSpan = null;
                this._spinBoxRows = null;
                this._spinBoxRowSpan = null;

                /*THE SELECTED CELL AND ITS INDEX IN THE MODEL TABLE!!!*/
                this._selectedCell = null;
                this._selectedCellIndex = -1;
                this._victimColumns = new Array();
                this._victimRows = new Array();
                this._rowsCount = 0;

                this._tableToModify = null;
                this._tablePreviewControl = null;
                this._tableWizardDialog = null;
                this._tableLayoutBuilderEngine = new Telerik.Web.UI.LayoutBuilderEngine();
        }

        Telerik.Web.UI.Widgets.TableDesign.prototype = {
                initialize: function ()
                {
                        Telerik.Web.UI.Widgets.TableDesign.callBaseMethod(this, "initialize");
                        this._initializeChildren();
                },

                _initializeChildren: function ()
                {
                        this._spinBoxDelegate = Function.createDelegate(this, this._spinBoxValueChanged);
                        this._selectedCellDelegate = Function.createDelegate(this, this._onSelectedCellChanged);

                        this._spinBoxColumns = this._initializeSpinBox("SpinBoxColumns");
                        this._spinBoxColumnSpan = this._initializeSpinBox("SpinBoxColumnSpan");
                        this._spinBoxRows = this._initializeSpinBox("SpinBoxRows");
                        this._spinBoxRowSpan = this._initializeSpinBox("SpinBoxRowSpan");

                        this._tablePreviewControl = new Telerik.Web.UI.Widgets.TablePreview();
                        this._tablePreviewControl.set_previewHolder($get("TableDesign_PreviewTableHolder"));
                        this._tablePreviewControl._onSelectedCellChanged = this._selectedCellDelegate;
                },

                clientInit: function (clientParameters)
                {
                        this._clientParameters = clientParameters;
                        this._tableToModify = this._clientParameters.originalTable;
                        this._tableLayoutBuilderEngine.set_selectedTable(this._tableToModify);
                        //this._selectedCell = this._clientParameters.selectedCell;
                        this._loadData();
                },

                _initializeSpinBox: function (boxId)
                {
                        var spinBox = $find(boxId);
                        spinBox.add_valueSelected(this._spinBoxDelegate);
                        spinBox.set_value(9999);
                        return spinBox;
                },

                _spinBoxValueChanged: function (sender, args)
                {
                        var oldValue = args.get_oldValue();
                        var newValue = args.get_newValue();
                        var diff = newValue - oldValue;
                        //difference should be either +1 or -1
                        if (diff != -1 && diff != 1)
                        {
                                return;
                        }
                        switch (sender)
                        {
                                case this._spinBoxColumns:
                                        return (diff == 1) ? this._addNewColumn() : this._deleteLastColumn();
                                        break;
                                case this._spinBoxColumnSpan:
                                        return (diff == 1) ? this._increaseColSpan() : this._decreaseColSpan();
                                        break;
                                case this._spinBoxRows:
                                        return (diff == 1) ? this._addNewRow() : this._deleteLastRow();
                                        break;
                                case this._spinBoxRowSpan:
                                        return (diff == 1) ? this._increaseRowSpan() : this._decreaseRowSpan();
                                        break;
                                default:
                                        break;
                        }
                },

                _loadData: function ()
                {
                        //clear dialog data because the page is not reloaded each time the dialog is opened!
                        this._currentRowSpan = 1;
                        this._currentColSpan = 1;
                        this._selectedCell = null;
                        this._selectedCellIndex = -1;
                        this._victimColumns = new Array();
                        this._victimRows = new Array();

                        //clear the table preview control as well
                        this._tablePreviewControl.deSelectAllCells();
                        if (this._tableToModify)
                        {
                                this._rowsCount = this._tableToModify.rows.length;
                        }
                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                _onSelectedCellChanged: function ()
                {
                        this._synchronizeSelectedCell();
                        this._checkButtonAvailability();
                },

                _synchronizeSelectedCell: function ()
                {
                        var previewSelectedCell = this._tablePreviewControl.get_selectedCell();
                        var previewTable = this._tablePreviewControl.get_previewTable();

                        var previewTableRows = previewTable.rows;
                        this._selectedCell = null;
                        this._selectedCellIndex = -1;
                        for (var i = 0; i < previewTableRows.length; i++)
                        {
                                var previewTableCells = previewTableRows[i].cells;
                                for (var j = 0; j < previewTableCells.length; j++)
                                {
                                        if (previewTableCells[j] == previewSelectedCell)
                                        {
                                                this._selectedCell = this._tableToModify.rows[i].cells[j];
                                                this._tableLayoutBuilderEngine.set_selectedCell(this._selectedCell);
                                                this._selectedCellIndex = j;
                                                if (this._tableWizardDialog)
                                                        this._tableWizardDialog._synchronizeSelection(this._selectedCell, this._selectedCellIndex);
                                                return;
                                        }
                                }
                        }
                },

                _checkButtonAvailability: function ()
                {
                        if (!this._selectedCell)
                        {
                                var table = this._tablePreviewControl.get_previewTable();

                                //check row and column count for the row and column spinboxes
                                if (this._getNamedNodesLength(table.firstChild, "TR") > 1)
                                        this._spinBoxRows.set_enabledDecrease(true);
                                else
                                        this._spinBoxRows.set_enabledDecrease(false);

                                if (this._getMaxColumns() > 1)
                                        this._spinBoxColumns.set_enabledDecrease(true);
                                else
                                        this._spinBoxColumns.set_enabledDecrease(false);

                                this._spinBoxColumnSpan.set_enabledDecrease(false);
                                this._spinBoxRowSpan.set_enabledDecrease(false);
                        }
                        else
                        {
                                var layoutBulider = this._tableLayoutBuilderEngine;
                                var layoutBuliderSelectedCell = layoutBulider._selectedCell;
                                var spinBoxColumnSpan = this._spinBoxColumnSpan;
                                var spinBoxRowSpan = this._spinBoxRowSpan;
                                var spinBoxColumns = this._spinBoxColumns;
                                var spinBoxRows = this._spinBoxRows;

                                //_spinBoxColumnSpan
                                if (layoutBulider.canMergeRight())
                                        spinBoxColumnSpan.set_enabledIncrease(true);
                                else
                                        spinBoxColumnSpan.set_enabledIncrease(false);

                                if (layoutBulider._getColSpan(layoutBuliderSelectedCell) > 1)
                                        spinBoxColumnSpan.set_enabledDecrease(true);
                                else
                                        spinBoxColumnSpan.set_enabledDecrease(false);


                                //_spinBoxColumnSpan
                                if (layoutBulider.canMergeDown())
                                        spinBoxRowSpan.set_enabledIncrease(true);
                                else
                                        spinBoxRowSpan.set_enabledIncrease(false);

                                if (layoutBulider._getRowSpan(layoutBuliderSelectedCell) > 1)
                                        spinBoxRowSpan.set_enabledDecrease(true);
                                else
                                        spinBoxRowSpan.set_enabledDecrease(false);

                                //_spinBoxColumns
                                if (layoutBulider._tableStateColsCount != 1)
                                        spinBoxColumns.set_enabledDecrease(true);
                                else
                                        spinBoxColumns.set_enabledDecrease(false);

                                //_spinBoxRows
                                if (layoutBulider._tableStateRowsCount != 1)
                                        spinBoxRows.set_enabledDecrease(true);
                                else
                                        spinBoxRows.set_enabledDecrease(false);
                        }
                },

                _getNamedNodesLength: function (node, name)
                {
                        var counter = 0;
                        if (node)
                        {
                                for (var i = 0; i < node.childNodes.length; i++)
                                {
                                        if (node.childNodes[i].nodeName == name)
                                        {
                                                counter++;
                                        }
                                }
                        }
                        return counter;
                },

                _getMaxColumns: function ()
                {
                        var maxCols = 0;
                        var firstRow = this._tableToModify.rows[0];
                        if (firstRow)
                        {
                                var cells = firstRow.cells; //childNodes;
                                for (var i = 0; i < cells.length; i++)
                                {
                                        maxCols += this._getColSpan(cells[i]);
                                }
                        }
                        return maxCols;
                },

                _findNextNamedSibling: function (node, name)
                {
                        if (node != null)
                        {
                                var nSibling = node.nextSibling;
                                while (nSibling != null)
                                {
                                        if (nSibling.nodeName == name)
                                        {
                                                return nSibling;
                                        }
                                        nSibling = nSibling.nextSibling;
                                }
                        }
                        return null;
                },

                _getRowSpan: function (oCell)
                {
                        if (!oCell) return;
                        return oCell.rowSpan > 0 ? oCell.rowSpan : 1;
                },

                _getColSpan: function (oCell)
                {
                        if (!oCell) return;
                        return oCell.colSpan > 0 ? oCell.colSpan : 1;
                },

                _getEquivalentModelTableCell: function (previewTableCell)
                {
                        var table = this._tablePreviewControl.get_previewTable();
                        var rows = table.rows;
                        for (var i = 0; i < rows.length; i++)
                        {
                                var cells = rows[i].cells;
                                for (var j = 0; j < cells.length; j++)
                                {
                                        if (cells[j] == previewTableCell)
                                        {
                                                return this._tableToModify.rows[i].cells[j];
                                        }
                                }
                        }
                },

                _getCellByOffset: function (row, offset)
                {
                        var cells = row.cells;
                        for (var i = 0; i < cells.length; i++)
                        {
                                if (cells[i].offsetLeft == offset)
                                {
                                        return cells[i];
                                }
                        }
                        return null;
                },

                _getNamedNodeIndex: function (node, name)
                {
                        if (node && node.parentNode && node.parentNode.childNodes)
                        {
                                var nodesChild = node.parentNode.childNodes;
                                var nodeIndex = 0;
                                for (var i = 0; i < nodesChild.length; i++)
                                {
                                        if (nodesChild[i] == node)
                                        {
                                                return nodeIndex;
                                        }
                                        else if (nodesChild[i].nodeName == name)
                                        {
                                                nodeIndex++;
                                        }
                                }
                        }
                        return -1;
                },

                _removeLastChild: function (node, name)
                {
                        if (!node || !node.childNodes)
                        {
                                return;
                        }
                        var i = node.childNodes.length - 1;
                        while (i >= 0 && node.childNodes[i].nodeName != name)
                        {
                                i--;
                        }
                        if (i >= 0)
                        {
                                node.removeChild(node.childNodes[i]);
                        }
                },

                _deleteLastColumn: function ()
                {
                        var cells = [];
                        if (this._getMaxColumns() == 1)
                        {
                                return false;
                        }

                        if (!this._selectedCell)
                        {
                                var previewTable = this._tablePreviewControl.get_previewTable();
                                if (previewTable)
                                {
                                        cells = previewTable.rows[0].cells;
                                        this._selectedCell = cells[cells.length - 1];
                                }
                        }

                        cells = this._selectedCell.parentNode.cells;
                        var lastCellIndex = cells.length - 1;
                        if (this._selectedCell.cellIndex == lastCellIndex)
                        {
                                var result = this._tableLayoutBuilderEngine.executeCommand("deleteColumn");
                                this.set_selectedCell(this._tableLayoutBuilderEngine._selectedTable.rows[0].cells[0]);
                        }
                        else
                        {
                                var cell = this._selectedCell;
                                this.set_selectedCell(cells[lastCellIndex]);
                                var result = this._tableLayoutBuilderEngine.executeCommand("deleteColumn");
                                this.set_selectedCell(cell);
                        }

                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                _deleteLastRow: function ()
                {
                        if (this._rowsCount == 1)
                        {
                                return false;
                        }

                        var lasRowIndex = this._tableLayoutBuilderEngine._tableStateRowsCount - 1;
                        if (this._tableLayoutBuilderEngine._selectedRowIndex == lasRowIndex)
                        {
                                var result = this._tableLayoutBuilderEngine.executeCommand("deleteRow");
                                this.set_selectedCell(this._tableLayoutBuilderEngine._selectedTable.rows[0].cells[0]);
                        }
                        else
                        {
                                var cell = this._selectedCell;
                                this.set_selectedCell(this._tableLayoutBuilderEngine._selectedTable.rows[lasRowIndex].cells[0]);
                                var result = this._tableLayoutBuilderEngine.executeCommand("deleteRow");
                                this.set_selectedCell(cell);
                        }
                        this._rowsCount -= 1;
                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                _addNewColumn: function ()
                {
                        if (!this._tableLayoutBuilderEngine._selectedCell) return false;
                        var result = this._tableLayoutBuilderEngine.executeCommand("insertColumnToTheRight");
                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                _addNewRow: function ()
                {
                        if (!this._tableLayoutBuilderEngine._selectedCell) return false;
                        var result = this._tableLayoutBuilderEngine.executeCommand("insertRowBelow");
                        this._rowsCount += 1;
                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                _increaseColSpan: function ()
                {
                        if (!this._tableLayoutBuilderEngine._selectedCell) return false;
                        if (this._tableLayoutBuilderEngine.canMergeRight()) this._tableLayoutBuilderEngine.executeCommand("mergeRight");
                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                _decreaseColSpan: function ()
                {
                        if (!this._tableLayoutBuilderEngine._selectedCell) return false;
                        if (this._tableLayoutBuilderEngine._getColSpan(this._tableLayoutBuilderEngine._selectedCell) > 1)
                        {
                                var args = { rightColSpan: 1 }
                                this._tableLayoutBuilderEngine.executeCommand("splitCellHorizontally", args);
                        }

                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                _increaseRowSpan: function ()
                {
                        if (!this._tableLayoutBuilderEngine._selectedCell) return false;
                        if (this._tableLayoutBuilderEngine.canMergeDown()) this._tableLayoutBuilderEngine.executeCommand("mergeDown");
                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                _decreaseRowSpan: function ()
                {
                        if (!this._tableLayoutBuilderEngine._selectedCell) return false;
                        if (this._tableLayoutBuilderEngine._getRowSpan(this._tableLayoutBuilderEngine._selectedCell) > 1)
                        {
                                var args = { downRowSpan: 1 }
                                this._tableLayoutBuilderEngine.executeCommand("splitCellVertically", args);
                        }

                        this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        this._checkButtonAvailability();
                },

                set_selectedCell: function (value)
                {
                        this._selectedCell = value;
                        this._tableLayoutBuilderEngine.set_selectedCell(value);
                        if (this._tableToModify != null)
                        {
                                this._tablePreviewControl._updateTable(this._tableToModify, this._selectedCell);
                        }

                        //NEW always check _checkButtonAvailability when you set selected cell
                        this._checkButtonAvailability();
                },

                set_tableWizardControl: function (value)
                {
                        this._tableWizardDialog = value;
                },

                getParentTable: function (oNode)
                {
                        if (!oNode)
                                return null;

                        while (null != oNode
                                && oNode.parentNode != oNode
                                && "TABLE" != oNode.tagName)
                        {
                                oNode = oNode.parentNode;
                        }

                        return (oNode && oNode.tagName == "TABLE" ? oNode : null);
                },

                getNextSiblingCell: function (cell)
                {
                        if (!cell) return null;

                        var row = cell.parentNode;
                        var nextIndex = cell.cellIndex + 1;

                        if (0 <= nextIndex && nextIndex < row.cells.length)
                                return row.cells[nextIndex];

                        return null;
                },

                getLowerCell: function (cell)
                {
                        if (!cell) return null;

                        var table = this.getParentTable(cell);
                        var row = cell.parentNode;

                        var nextRow = table.rows[row.rowIndex + this._getRowSpan(cell)];
                        if (!nextRow) return null;

                        var lowerCell = nextRow.cells[cell.cellIndex];
                        return lowerCell;
                },

                dispose: function ()
                {
                        this._clientParameters = null;

                        this._selectedCell = null;
                        this._victimColumns = [];
                        this._victimRows = [];

                        this._spinBoxColumns = null;
                        this._spinBoxColumnSpan = null;
                        this._spinBoxRows = null;
                        this._spinBoxRowSpan = null;

                        this._tableToModify = null;
                        this._tablePreviewControl = null;
                        this._tableWizardDialog = null;
                        Telerik.Web.UI.Widgets.TableDesign.callBaseMethod(this, "dispose");
                }
        }
        Telerik.Web.UI.Widgets.TableDesign.registerClass('Telerik.Web.UI.Widgets.TableDesign', Telerik.Web.UI.RadWebControl, Telerik.Web.IParameterConsumer);
</script>
<!-- table design pane -->
<table border="0" cellpadding="0" cellspacing="0" style="margin-left: 4px;">
        <tr>
                <td style="padding-right: 4px;">
                        <table border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                        <td>
                                                <fieldset style="width: 378px; height: 44px;" class="reTableWizardColumns">
                                                        <legend>
                                                                <script type="text/javascript">                                                                        document.write(localization["Columns"]);</script>
                                                        </legend>
                                                        <table border="0" cellpadding="0" cellspacing="0">
                                                                <tr>
                                                                        <td><div class="propertyLabel" style="width: 80px; text-align: left; margin-left: 8px; margin-bottom: 6px;"><script type="text/javascript">                                                                                                                                                                                            document.write(localization["Columns"]);</script>:</div></td>
                                                                        <td><div class="reToolWrapper Default" id="SpinBoxColumns">

                                        </div></td>
                                                                        <td><div class="propertyLabel" style="width: 80px; text-align: left; margin-left: 40px; margin-bottom: 6px;"><script type="text/javascript">                                                                                                                                                                                             document.write(localization["ColumnSpan"]);</script>:</div></td>
                                                                        <td style="vertical-align: top;"><div class="reToolWrapper Default" id="SpinBoxColumnSpan">

                                        </div></td>
                                                                </tr>
                                                        </table>
                                                </fieldset>
                                        </td>
                                </tr>
                                <tr>
                                        <td><div id="TableDesign_PreviewTableHolder" class="reTableDesignPreviewTableHolder" ><!-- / --></div></td>
                                </tr>
                        </table>
                </td>
                <td>
                        <fieldset style="width: 302px; height: 394px;" class="reTableWizardRows">
                                <legend><script type="text/javascript">                                                document.write(localization["Rows"]);</script></legend>
                                <table border="0" cellpadding="0" cellspacing="0" style="margin: 40px 0 0 6px;">
                                        <tr>
                                                <td><div class="propertyLabel" style="text-align: left; margin-left: 6px; width: 60px;"><script type="text/javascript">                                                                                                                                                document.write(localization["Rows"]);</script>:</div></td>
                                                <td><div class="reToolWrapper Default" id="SpinBoxRows">

                                        </div></td>
                                        </tr>
                                        <tr>
                                                <td><div class="propertyLabel" style="text-align: left; margin-left: 6px; width: 60px;"><script type="text/javascript">                                                                                                                                                document.write(localization["RowSpan"]);</script>:</div></td>
                                                <td><div class="reToolWrapper Default" id="SpinBoxRowSpan">

                                        </div></td>
                                        </tr>
                                </table>
                        </fieldset>
                </td>
        </tr>
</table>
<!-- end of table design pane --><input id="tableDesignPanel_ClientState" name="tableDesignPanel_ClientState" type="hidden" />
                                </div>

                        </div><div id="tablePropertiesRow" class="rmpHiddenView">

                                        <div id="tablePropertiesPanel">
                                        <div id="resourcesTableProperties">
                                                <script type="text/javascript">
//<![CDATA[
localization._fill({});
//]]>
</script>
<input id="resourcesTableProperties_ClientState" name="resourcesTableProperties_ClientState" type="hidden" />
                                        </div>
<script type="text/javascript">
        Type.registerNamespace("Telerik.Web.UI.Widgets");
        Telerik.Web.UI.Widgets.TableProperties = function (element)
        {
                Telerik.Web.UI.Widgets.TableProperties.initializeBase(this, [element]);

                this._clientParameters = null;
                this._editorRef = null;

                this._table = null;
                this._id = "";
                this._skinPath = "";
                this._tableWidth = "";
                this._tableHeight = "";

                //New StyleBuilder
                this._cssText = "";

                this._idInput = null;

                this._imageCaller = null;
                this._spinBoxWidth = null;
                this._spinBoxHeight = null;
                this._spinBoxCellSpacing = null;
                this._spinBoxCellPadding = null;
                this._colorPicker = null;
                this._classSelector = null;
                this._alignmentSelectorTable = null;

                this._tableBorderControl = null;
        }

        Telerik.Web.UI.Widgets.TableProperties.prototype = {
                initialize: function ()
                {
                        Telerik.Web.UI.Widgets.TableProperties.callBaseMethod(this, "initialize");
                        this._initializeChildren();
                },

                _initializeChildren: function ()
                {
                        this._idInput = $get("TableId");
                        this._spinBoxWidth = $find("SpinBoxWidth");
                        this._spinBoxHeight = $find("SpinBoxHeight");
                        this._spinBoxCellSpacing = $find("SpinBoxCellSpacing");
                        this._spinBoxCellPadding = $find("SpinBoxCellSPadding");
                        this._alignmentSelectorTable = $find("AlignmentSelectorTable");
                        this._styleBuilder = $find("StyleBuilder");

                        this._initializeChildEvents();
                },

                _initializeChildEvents: function ()
                {
                        //NEW: StyleBuilder
                        this._styleBuilder.add_valueSelected(Function.createDelegate(this, this._styleBuilderClicked));
                },

                //NEW: StyleBuilder
                _styleBuilderClicked: function (oTool, args)
                {
                        //Editor object is supplied to all dialogs in the dialog parameters
                        var editor = this._clientParameters.editor;
                        var callbackFunction = Function.createDelegate(this, function (sender, args)
                        {
                                //Returned link - TODO: Use args.get_value() when the dialog returm methods are changed to return proper args object
                                var resulTable = args.get_value();

                                var cssText = resulTable.style.cssText;
                                this._cssText = cssText;
                                this._table.style.cssText = cssText;
                                this._loadData();
                        });

                        //NEW: Use EditorCommandEventArgs
                        var parameterTable = this._table.cloneNode(true);
                        parameterTable = this._update(parameterTable);
                        var argument = new Telerik.Web.UI.EditorCommandEventArgs("StyleBuilder", null, parameterTable);

                        Telerik.Web.UI.Editor.CommandList._getDialogArguments(argument, "*", editor, "StyleBuilder");
                        argument.fontNames = editor.get_fontNames();
                        editor.showDialog("StyleBuilder", argument, callbackFunction);
                },

                clientInit: function (clientParameters)
                {
                        this._clientParameters = clientParameters;
                        if (clientParameters)
                        {
                                this._table = clientParameters.tableToModify;
                        }

                        this._editorRef = clientParameters.editor;

                        this._imageCaller = $find("ImageCaller");
                        this._imageCaller.set_editor(this._editorRef);

                        this._colorPicker = $find("ColorPicker");
                        if (this._colorPicker._popupVisible) this._colorPicker.hide();
                        this._colorPicker.set_items(clientParameters.Colors);
                        this._colorPicker.set_addCustomColorText(localization["AddCustomColor"]);

                        this._classSelector = $find("ClassSelector");
                        //localization
                        this._classSelector.set_showText(true);
                        this._classSelector.set_clearclasstext(localization["ClearClass"]);
                        this._classSelector.set_text(localization["ApplyClass"]);
                        this._classSelector.set_items(clientParameters.CssClasses);
                        this._classSelector.add_valueSelected(this._cssValueSelected);

                        this._tableBorderControl = $find("TableBorder");
                        this._tableBorderControl.set_tableToModify(this._table);

                        this._tableBorderControl.clientInit(clientParameters);

                        this._loadData();
                },

                _cssValueSelected: function (oTool, args)
                {
                        if (!oTool) return;
                        var commandName = oTool.get_name();

                        if ("ApplyClass" == commandName)
                        {
                                var attribValue = oTool.get_selectedItem();
                                oTool.updateValue(attribValue);
                        }
                },

                _setCssPropertyValue: function (element, cssProperty, value, attribute)
                {
                        if (!element || !cssProperty) return;
                        if (attribute) element.removeAttribute(attribute);
                        element.style[cssProperty] = value;
                },

                _loadData: function ()
                {
                        if (this._table)
                        {
                                this._cssText = this._table.style.cssText;

                                this._idInput.value = this._table.getAttribute("id") ? this._table.getAttribute("id") : "";

                                if (this._imageCaller)
                                {
                                        var imagePath = this._table.style.backgroundImage;
                                        imagePath = (!imagePath) ? "" : imagePath.substring(4, imagePath.length - 1);
                                        this._imageCaller.set_value(imagePath);
                                }

                                this._tableWidth = this._table.style.width ? this._table.style.width : this._table.getAttribute("width");
                                this._spinBoxWidth.set_value(this._tableWidth);

                                this._tableHeight = this._table.style.height ? this._table.style.height : this._table.getAttribute("height");
                                this._spinBoxHeight.set_value(this._tableHeight);

                                this._spinBoxCellSpacing.set_value(this._table.cellSpacing);
                                this._spinBoxCellPadding.set_value(this._table.cellPadding);


                                var backgroundColor = this._table.style.backgroundColor;
                                this._colorPicker.set_color(backgroundColor);

                                if (this._table.className && this._table.className != '') this._classSelector.updateValue(this._table.className);

                                this._alignmentSelectorTable.setTagName("TABLE");
                                this._alignmentSelectorTable.updateValue(this._table.align);
                        }
                },

                _updateTable: function ()
                {
                        var table = this._update(this._table);
                        var updatedTable = this._tableBorderControl._updateTarget();
                        if (updatedTable) table = updatedTable;
                        return table;
                },

                _update: function (table)
                {
                        //New StyleBuilder
                        table.style.cssText = this._cssText;

                        var widthValue = this._spinBoxWidth.get_value();
                        if (widthValue == "") table.removeAttribute("width", false);
                        else if (!this._isValueValid(widthValue)) return null;

                        table.removeAttribute("width", false);
                        table.style.width = widthValue ? this._convertIntToPixel(widthValue) : ""; //SAFARI - px

                        var heightValue = this._spinBoxHeight.get_value();
                        if (heightValue == "") table.removeAttribute("height", false);
                        else if (!this._isValueValid(heightValue)) return null;

                        table.removeAttribute("height", false);
                        table.style.height = heightValue ? this._convertIntToPixel(heightValue) : ""; //SAFARI - px

                        this._setAttribValue("id", this._idInput.value);
                        this._setAttribValue("align", this._alignmentSelectorTable.getAlign());

                        var oSpacing = this._spinBoxCellSpacing.get_value();
                        if (!isNaN(parseInt(oSpacing))) this._setAttribValue("cellSpacing", oSpacing >= 0 ? oSpacing : "", (oSpacing >= 0));

                        var oPadding = this._spinBoxCellPadding.get_value();
                        if (!isNaN(parseInt(oPadding))) this._setAttribValue("cellPadding", oPadding >= 0 ? oPadding : "", (oPadding >= 0));


                        this._setCssPropertyValue(table, "backgroundColor", this._colorPicker.get_color(), "bgColor");

                        var backgroundImage = this._imageCaller.get_value();
                        backgroundImage = (backgroundImage) ? "url(" + backgroundImage + ")" : "";
                        this._setCssPropertyValue(table, "backgroundImage", backgroundImage, "background");

                        table.className = this._classSelector.get_value();

                        return table;
                },

                _isValueValid: function (value)
                {
                        var valueInt = parseFloat(value, 10);
                        if (!isNaN(valueInt))
                        {
                                //NEW support for all css units
                                var isValidPercent = (valueInt + '%' == value);
                                var isValidPixel = (valueInt + 'px' == value.toLowerCase());
                                var isValidEm = (valueInt + 'em' == value.toLowerCase());
                                var isValidEx = (valueInt + 'ex' == value.toLowerCase());
                                var isValidIn = (valueInt + 'in' == value.toLowerCase());
                                var isValidCm = (valueInt + 'cm' == value.toLowerCase());
                                var isValidMm = (valueInt + 'mm' == value.toLowerCase());
                                var isValidPt = (valueInt + 'pt' == value.toLowerCase());
                                var isValidPc = (valueInt + 'pc' == value.toLowerCase());
                                var isValidNumber = (valueInt.toString() == value);

                                if (isValidPercent || isValidPixel || isValidEm || isValidEx || isValidIn || isValidCm || isValidMm || isValidPt || isValidPc || isValidNumber)
                                {
                                        return true;
                                }
                        }
                        return false;
                },

                _convertIntToPixel: function (oVal)
                {
                        var oNew = "" + oVal;

                        if (oNew.indexOf("%") != -1)
                        {
                                return oNew;
                        }
                        else
                        {
                                var arMatch = oNew.match(/(em|ex|px|in|cm|mm|pt|pc)$/); //NEW support for all css units
                                oNew = parseFloat(oNew);
                                if (!isNaN(oNew))
                                {
                                        oNew = (arMatch) ? oNew + arMatch[0] : oNew + "px"; //NEW support for all css units
                                        return oNew;
                                }
                        }
                        return oVal;
                },

                _setAttribValue: function (attribName, oVal, forceVal)
                {
                        if (oVal || (true == forceVal))//cellSpacing or cellPadding have by default 1 so we might want to set it to 0
                        {
                                this._table.setAttribute(attribName, oVal);
                        }
                        else
                        {
                                this._table.removeAttribute(attribName, false);
                        }
                },

                set_tableToModify: function (value)
                {
                        this._table = value;
                        if (this._tableBorderControl) this._tableBorderControl.set_tableToModify(this._table);
                },

                dispose: function ()
                {
                        this._clientParameters = null;
                        this._editorRef = null;

                        this._table = null;
                        this._idInput = null;

                        this._imageCaller = null;
                        this._spinBoxWidth = null;
                        this._spinBoxHeight = null;
                        this._spinBoxCellSpacing = null;
                        this._spinBoxCellPadding = null;
                        this._colorPicker = null;
                        this._classSelector = null;
                        this._alignmentSelectorTable = null;

                        this._tableBorderControl = null;

                        Telerik.Web.UI.Widgets.TableProperties.callBaseMethod(this, "dispose");
                }
        }

        Telerik.Web.UI.Widgets.TableProperties.registerClass('Telerik.Web.UI.Widgets.TableProperties', Telerik.Web.UI.RadWebControl, Telerik.Web.IParameterConsumer);
</script>
<style type="text/css">
.reLabelCell
{
        width: 105px;
        padding: 3px;
        text-align: right;
}

.reControlCell
{
        padding: 3px;
}

</style>
<table border="0" cellpadding="0" cellspacing="0" style="margin-left: 4px;">
        <tr>
                <td style="padding-right: 4px;">
                        <fieldset style="width:305px;" class="reTablePropertiesDimensions">
                                <legend>
                                        <script type="text/javascript">document.write(localization["Dimensions"]);</script>
                                </legend>
                                <table border="0" cellpadding="0" cellspacing="0" style="width: 100%;" class="tableWizardTableProperties">
                                        <tr>
                                                <td class="reLabelCell">
                                                        <label class="reDialogLabel"><script type="text/javascript">document.write(localization["Height"]);</script>:</label>
                                                </td>
                                                <td class="reControlCell">
                                                        <div class="reToolWrapper Default" id="SpinBoxHeight">

                                        </div>
                                                        <span style="padding-left: 10px;"><script type="text/javascript">document.write(localization["PixelsOrPercents"]);</script></span>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell">
                                                        <label class="reDialogLabel" ><script type="text/javascript">document.write(localization["Width"]);</script>:</label>
                                                </td>
                                                <td class="reControlCell">
                                                        <div class="reToolWrapper Default" id="SpinBoxWidth">

                                        </div>
                                                        <span style="padding-left: 10px;"><script type="text/javascript">document.write(localization["PixelsOrPercents"]);</script></span>
                                                </td>
                                        </tr>
                                </table>
                        </fieldset>
                </td>
                <td rowspan="2" style="vertical-align: top;">
                        <fieldset style="height: 394px;width:375px;"  class="reTablePropertiesCssClass">
                                <legend>
                                        <script type="text/javascript">document.write(localization["CssClass"]);</script>
                                        <script type="text/javascript">document.write(localization["Layout"]);</script>
                                </legend>
                                <div id="TableBorder">
                                                <div id="resourcesTableBorder">
                                                        <script type="text/javascript">
//<![CDATA[
localization._fill({});
//]]>
</script>
<input id="resourcesTableBorder_ClientState" name="resourcesTableBorder_ClientState" type="hidden" />
                                                </div>
<style type="text/css" id="telerik-reTable-1">
        .telerik-reTable-1
        {
                border-width: 0px;
                border-style: none;
                border-collapse: collapse;
                font-family: Tahoma;
        }
        .telerik-reTable-1 tr.telerik-reTableHeaderRow-1
        {
                margin: 10px;
                padding: 10px;
                color: #3F4D6B;
                background: #D6E8FF;
                text-align: left;
                font-size: 10pt;
                font-style: normal;
                font-family: Tahoma;
                text-transform: capitalize;
                font-weight: bold;
                border-spacing: 10px;
                line-height: 14pt;
                vertical-align: top;
        }
        .telerik-reTable-1 td.telerik-reTableHeaderFirstCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
                line-height: 14pt;
        }
        .telerik-reTable-1 td.telerik-reTableHeaderLastCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
                line-height: 14pt;
        }
        .telerik-reTable-1 td.telerik-reTableHeaderOddCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
                line-height: 14pt;
        }
        .telerik-reTable-1 td.telerik-reTableHeaderEvenCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
                line-height: 14pt;
        }
        .telerik-reTable-1 tr.telerik-reTableOddRow-1
        {
                color: #666666;
                background-color: #F2F3F4;
                font-size: 10pt;
                vertical-align: top;
        }
        .telerik-reTable-1 tr.telerik-reTableEvenRow-1
        {
                color: #666666;
                background-color: #E7EBF7;
                font-size: 10pt;
                vertical-align: top;
        }
        .telerik-reTable-1 td.telerik-reTableFirstCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-1 td.telerik-reTableLastCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-1 td.telerik-reTableOddCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-1 td.telerik-reTableEvenCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-1 tr.telerik-reTableFooterRow-1
        {
                background-color: #D6E8FF;
                color: #4A5A80;
                font-weight: 500;
                font-size: 10pt;
                font-family: Tahoma;
                line-height: 11pt;
        }
        .telerik-reTable-1 td.telerik-reTableFooterFirstCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
                border-top: solid gray 1.0pt;
                text-align: left;
        }
        .telerik-reTable-1 td.telerik-reTableFooterLastCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
                border-top: solid gray 1.0pt;
                text-align: left;
        }
        .telerik-reTable-1 td.telerik-reTableFooterOddCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
                border-top: solid gray 1.0pt;
        }
        .telerik-reTable-1 td.telerik-reTableFooterEvenCol-1
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
                border-top: solid gray 1.0pt;
        }
</style>
<style type="text/css" id="telerik-reTable-2">
        .telerik-reTable-2
        {
                border-collapse: collapse;
                border: solid 0px;
                font-family: Tahoma;
        }
        .telerik-reTable-2 tr.telerik-reTableHeaderRow-2
        {
                border-width: 1.0pt 1.0pt 3.0pt 1.0pt;
                margin-top: 0in;
                margin-right: 0in;
                margin-bottom: 10.0pt;
                margin-left: 0in;
                line-height: 115%;
                font-size: 11.0pt;
                font-family: "Calibri" , "sans-serif";
                width: 119.7pt;
                border: solid white 1.0pt;
                border-bottom: solid white 3.0pt;
                background: #4F81BD;
                padding: 0in 5.4pt 0in 5.4pt;
                color: #FFFFFF;
        }
        .telerik-reTable-2 td.telerik-reTableHeaderFirstCol-2
        {
                border-width: 1.0pt 1.0pt 3.0pt 1.0pt;
                border: solid white 1.0pt;
                border-bottom: solid white 3.0pt;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 td.telerik-reTableHeaderLastCol-2
        {
                border-width: 1.0pt 1.0pt 3.0pt 1.0pt;
                border: solid white 1.0pt;
                border-bottom: solid white 3.0pt;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 td.telerik-reTableHeaderOddCol-2
        {
                border-width: 1.0pt 1.0pt 3.0pt 1.0pt;
                border: solid white 1.0pt;
                border-bottom: solid white 3.0pt;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 td.telerik-reTableHeaderEvenCol-2
        {
                border-width: 1.0pt 1.0pt 3.0pt 1.0pt;
                border: solid white 1.0pt;
                border-bottom: solid white 3.0pt;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 tr.telerik-reTableOddRow-2
        {
                color: #666666;
                background-color: #F2F3F4;
                font-size: 10pt;
                vertical-align: top;
        }
        .telerik-reTable-2 tr.telerik-reTableEvenRow-2
        {
                color: #666666;
                background-color: #E7EBF7;
                font-size: 10pt;
                vertical-align: top;
        }
        .telerik-reTable-2 td.telerik-reTableFirstCol-2
        {
                margin-top: 0in;
                margin-right: 0in;
                margin-bottom: 10.0pt;
                margin-left: 0in;
                line-height: 115%;
                font-size: 11.0pt;
                font-family: "Calibri" , "sans-serif";
                width: 119.7pt;
                border-top: none;
                border-left: solid white 1.0pt;
                border-bottom: none;
                border-right: solid white 3.0pt;
                background: #4F81BD;
                padding: 0in 5.4pt 0in 5.4pt;
                color: #FFFFFF;
        }
        .telerik-reTable-2 td.telerik-reTableLastCol-2
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 td.telerik-reTableOddCol-2
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 td.telerik-reTableEvenCol-2
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 tr.telerik-reTableFooterRow-2
        {
                color: #666666;
                background-color: #FFFFFF;
                font-size: 10pt;
                vertical-align: top;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 td.telerik-reTableFooterFirstCol-2
        {
                margin-top: 0in;
                margin-right: 0in;
                margin-bottom: 10.0pt;
                margin-left: 0in;
                line-height: 115%;
                font-size: 11.0pt;
                font-family: "Calibri" , "sans-serif";
                width: 119.7pt;
                border-top: none;
                border-left: solid white 1.0pt;
                border-bottom: none;
                border-right: solid white 3.0pt;
                background: #4F81BD;
                padding: 0in 5.4pt 0in 5.4pt;
                color: #FFFFFF;
        }
        .telerik-reTable-2 td.telerik-reTableFooterLastCol-2
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 td.telerik-reTableFooterOddCol-2
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-2 td.telerik-reTableFooterEvenCol-2
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
</style>
<style type="text/css" id="telerik-reTable-3">
        .telerik-reTable-3
        {
                border-collapse: collapse;
                border: solid 0px;
                font-family: Tahoma;
        }
        .telerik-reTable-3 tr.telerik-reTableHeaderRow-3
        {
                margin: 10px;
                padding: 10px;
                color: #3a4663;
                text-align: left;
                font-size: 10pt;
                font-style: normal;
                font-family: Verdana;
                text-transform: capitalize;
                font-weight: normal;
                border-spacing: 10px;
                vertical-align: top;
                background-color: #C4D1E3;
        }
        .telerik-reTable-3 td.telerik-reTableHeaderFirstCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
                line-height: 14pt;
        }
        .telerik-reTable-3 td.telerik-reTableHeaderLastCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
                line-height: 14pt;
        }
        .telerik-reTable-3 td.telerik-reTableHeaderOddCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
                line-height: 14pt;
        }
        .telerik-reTable-3 td.telerik-reTableHeaderEvenCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
                line-height: 14pt;
        }
        .telerik-reTable-3 tr.telerik-reTableOddRow-3
        {
                color: #666666;
                vertical-align: top;
                font-size: 10pt;
        }
        .telerik-reTable-3 tr.telerik-reTableEvenRow-3
        {
                color: #666666;
                vertical-align: top;
                font-size: 10pt;
        }
        .telerik-reTable-3 td.telerik-reTableFirstCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                background-color: #E7EBF7;
        }
        .telerik-reTable-3 td.telerik-reTableLastCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                background-color: #E7EBF7;
        }
        .telerik-reTable-3 td.telerik-reTableOddCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                background-color: #F7F3F7;
        }
        .telerik-reTable-3 td.telerik-reTableEvenCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                background-color: #E7EBF7;
        }
        .telerik-reTable-3 tr.telerik-reTableFooterRow-3
        {
                background-color: #C4D1E3;
                color: #3a4663;
                font-weight: normal;
                font-size: 10pt;
                font-family: Verdana;
                line-height: 11pt;
        }
        .telerik-reTable-3 td.telerik-reTableFooterFirstCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
        }
        .telerik-reTable-3 td.telerik-reTableFooterLastCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
        }
        .telerik-reTable-3 td.telerik-reTableFooterOddCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
        }
        .telerik-reTable-3 td.telerik-reTableFooterEvenCol-3
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
        }
</style>
<style type="text/css" id="telerik-reTable-4">
        .telerik-reTable-4
        {
                border-collapse: collapse;
                border: solid 0px;
                font-family: Tahoma;
        }
        .telerik-reTable-4 tr.telerik-reTableHeaderRow-4
        {
                border-width: 1.0pt 1.0pt 3.0pt 1.0pt;
                margin-top: 0in;
                margin-right: 0in;
                margin-bottom: 10.0pt;
                margin-left: 0in;
                line-height: 115%;
                font-size: 11.0pt;
                font-family: "Calibri" , "sans-serif";
                width: 119.7pt;
                background: #4F81BD;
                padding: 0in 5.4pt 0in 5.4pt;
                color: #FFFFFF;
        }
        .telerik-reTable-4 td.telerik-reTableHeaderFirstCol-4
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 td.telerik-reTableHeaderLastCol-4
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 td.telerik-reTableHeaderOddCol-4
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 td.telerik-reTableHeaderEvenCol-4
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 tr.telerik-reTableOddRow-4
        {
                border-width: 1pt;
                color: #666666;
                font-size: 10pt;
                vertical-align: top;
                border-bottom-style: solid;
                border-bottom-color: #4F81BD;
        }
        .telerik-reTable-4 tr.telerik-reTableEvenRow-4
        {
                color: #666666;
                font-size: 10pt;
                vertical-align: top;
        }
        .telerik-reTable-4 td.telerik-reTableFirstCol-4
        {
                border-width: 1pt;
                border-color: #4F81BD;
                padding: 0in 5.4pt 0in 5.4pt;
                border-bottom-style: solid;
                border-left-style: solid;
        }
        .telerik-reTable-4 td.telerik-reTableLastCol-4
        {
                border-width: 1pt;
                border-color: #4F81BD;
                border-bottom-style: solid;
                border-right-style: solid;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 td.telerik-reTableOddCol-4
        {
                border-width: 1pt;
                border-color: #4F81BD;
                padding: 0in 5.4pt 0in 5.4pt;
                border-bottom-style: solid;
        }
        .telerik-reTable-4 td.telerik-reTableEvenCol-4
        {
                border-width: 1pt;
                border-color: #4F81BD;
                padding: 0in 5.4pt 0in 5.4pt;
                border-bottom-style: solid;
        }
        .telerik-reTable-4 tr.telerik-reTableFooterRow-4
        {
                color: #355C8C;
                background-color: #FFFFFF;
                font-size: 10pt;
                vertical-align: top;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 td.telerik-reTableFooterFirstCol-4
        {
                border-width: 1pt;
                border-color: #4F81BD;
                border-bottom-style: solid;
                border-left-style: solid;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 td.telerik-reTableFooterLastCol-4
        {
                border-width: 1pt;
                border-color: #4F81BD;
                border-bottom-style: solid;
                border-right-style: solid;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 td.telerik-reTableFooterOddCol-4
        {
                border-width: 1pt;
                border-color: #4F81BD;
                border-bottom-style: solid;
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-4 td.telerik-reTableFooterEvenCol-4
        {
                border-width: 1pt;
                border-color: #4F81BD;
                border-bottom-style: solid;
                padding: 0in 5.4pt 0in 5.4pt;
        }
</style>
<style type="text/css" id="telerik-reTable-5">
        .telerik-reTable-5
        {
                border-collapse: collapse;
                border: solid 0px;
                font-family: Tahoma;
        }
        .telerik-reTable-5 tr.telerik-reTableHeaderRow-5
        {
                margin: 10px;
                padding: 10px;
                color: #3A4663;
                text-align: left;
                font-size: 10pt;
                font-style: normal;
                font-family: Tahoma;
                text-transform: capitalize;
                font-weight: 500;
                border-spacing: 10px;
                line-height: 11pt;
                vertical-align: top;
        }
        .telerik-reTable-5 td.telerik-reTableHeaderFirstCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
        }
        .telerik-reTable-5 td.telerik-reTableHeaderLastCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
        }
        .telerik-reTable-5 td.telerik-reTableHeaderOddCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
        }
        .telerik-reTable-5 td.telerik-reTableHeaderEvenCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
                color: #3a4663;
        }
        .telerik-reTable-5 tr.telerik-reTableOddRow-5
        {
                color: #666666;
                vertical-align: top;
                font-size: 10pt;
        }
        .telerik-reTable-5 tr.telerik-reTableEvenRow-5
        {
                color: #666666;
                vertical-align: top;
                font-size: 10pt;
        }
        .telerik-reTable-5 td.telerik-reTableFirstCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-5 td.telerik-reTableLastCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-5 td.telerik-reTableOddCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-5 td.telerik-reTableEvenCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
        }
        .telerik-reTable-5 tr.telerik-reTableFooterRow-5
        {
                color: #3a4663;
                font-weight: 500;
                font-size: 10pt;
                font-family: Tahoma;
                line-height: 11pt;
        }
        .telerik-reTable-5 td.telerik-reTableFooterFirstCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
        }
        .telerik-reTable-5 td.telerik-reTableFooterLastCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
        }
        .telerik-reTable-5 td.telerik-reTableFooterOddCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
        }
        .telerik-reTable-5 td.telerik-reTableFooterEvenCol-5
        {
                padding: 0in 5.4pt 0in 5.4pt;
                text-align: left;
        }
</style>

<script type="text/javascript">
        Type.registerNamespace("Telerik.Web.UI.Widgets");
        Telerik.Web.UI.Widgets.TableBorder = function(element)
        {
                Telerik.Web.UI.Widgets.TableBorder.initializeBase(this, [element]);

                //Initioalize properties
                this._editorRef = null;
                this._previewTable = null;
                this._table = null;
                this._cssFilePath = null;

                this._tableFormat = null;
                this._formatName = null;
                this._headerRow = null;
                this._lastRow = null;
                this._firstColumn = null;
                this._lastColumn = null;

                this._formats = [];

                this._selectedStyleSheet = null;
                this._styleSheetToRemove = null;
                this._classToClear = null;
                this._canFormatTable = false;
        }

        var TABLE_BORDER_CONTROL = null;

        Telerik.Web.UI.Widgets.TableBorder.prototype = {
                initialize: function ()
                {
                        Telerik.Web.UI.Widgets.TableBorder.callBaseMethod(this, "initialize");

                        this._styleSheetToRemove = null;
                        this._classToClear = null;
                        this._initializeChildren();
                        this._initializeChildEvents();
                },

                _initializeChildren: function ()
                {
                        //initialize elements
                        this._previewTable = $get("PreviewTable");

                        this._formatName = $get("FormatName");
                        this._headerRow = $get("HeaderRow");
                        this._lastRow = $get("LastRow");
                        this._firstColumn = $get("FirstColumn");
                        this._lastColumn = $get("LastColumn");

                        TABLE_BORDER_CONTROL = this;
                },

                _setClassName: function (element, className)
                {
                        if (element)
                        {
                                if ($telerik.isIE) element.className = className;
                                else element.setAttribute("class", className);
                        }
                },

                _getClassName: function (element)
                {
                        if (element)
                        {
                                var className = (element.className) ? element.className : element.getAttribute("class");
                                return (className != null) ? className : "";
                        }

                        return "";
                },

                _initializeChildEvents: function ()
                {
                        $addHandlers(this._formatName, { "change": this._formatNameHandler }, this);
                        $addHandlers(this._headerRow, { "click": this._headerRowHandler }, this);
                        $addHandlers(this._lastRow, { "click": this._lastRowHandler }, this);
                        $addHandlers(this._firstColumn, { "click": this._firstColumnHandler }, this);
                        $addHandlers(this._lastColumn, { "click": this._lastColumnHandler }, this);
                },

                get_tableFormat: function ()
                {
                        return this._tableFormat();
                },

                set_tableFormat: function (value)
                {
                        this._tableFormat = value;
                },

                clientInit: function (clientParameters)
                {
                        this._clientParameters = clientParameters;

                        this._editorRef = clientParameters.editor;

                        //initialize
                        this._table = this._clientParameters.tableToModify;
                        this._cssFilePath = clientParameters.tableLayoutCssFile;
                        if (this._cssFilePath) Telerik.Web.UI.Editor.Utils.addStyleSheet(this._cssFilePath);

                        this._formats = clientParameters.tableFormats;
                        this._loadData();
                },

                _formatNameHandler: function (e)
                {
                        if (e) this._canFormatTable = true;
                        var formatName = this._formatName.value;

                        if (!formatName)
                        {
                                this._tableFormat = null;
                                this._clearTableFormat(this._previewTable);

                                this._headerRow.checked = "checked";
                                this._lastRow.checked = "checked";
                                this._firstColumn.checked = "checked";
                                this._lastColumn.checked = "checked";

                                this._headerRow.disabled = "disabled";
                                this._lastRow.disabled = "disabled";
                                this._firstColumn.disabled = "disabled";
                                this._lastColumn.disabled = "disabled";
                        }
                        else
                        {
                                this._headerRow.disabled = "";
                                this._lastRow.disabled = "";
                                this._firstColumn.disabled = "";
                                this._lastColumn.disabled = "";

                                var formatsLength = this._formats.length;
                                for (var i = 0; i < formatsLength; i++)
                                {
                                        var format = this._formats[i];
                                        if (formatName == format.name)
                                        {
                                                this._tableFormat = this._formats[i];
                                                this._setTableFormat(this._previewTable, this._tableFormat);
                                                break;
                                        }
                                }
                        }
                },

                _headerRowHandler: function (e)
                {
                        if (e) this._canFormatTable = true;
                        this._setTableFormat(this._previewTable, this._tableFormat);
                },

                _lastRowHandler: function (e)
                {
                        if (e) this._canFormatTable = true;
                        this._setTableFormat(this._previewTable, this._tableFormat);
                },

                _firstColumnHandler: function (e)
                {
                        if (e) this._canFormatTable = true;
                        this._setTableFormat(this._previewTable, this._tableFormat);
                },

                _lastColumnHandler: function (e)
                {
                        if (e) this._canFormatTable = true;
                        this._setTableFormat(this._previewTable, this._tableFormat);
                },

                _loadStyleSheetFormats: function (styleSheet)
                {
                        if (styleSheet)
                        {
                                if (typeof (this._formats) != "object") this._formats = [];
                                var formats = [];
                                var itemsArray = [];
                                this._editorRef._getStyleSheetRules(itemsArray, styleSheet, null);
                                var arTableClasses = this._getTableClassesArray(itemsArray);

                                if (!arTableClasses) return;
                                var arTableClassesLength = arTableClasses.length;
                                for (var i = 0; i < arTableClassesLength; i++)
                                {
                                        var tableClassName = arTableClasses[i];
                                        formats[i] = this._setFormatByClassName(itemsArray, tableClassName);
                                }

                                this._formats = this._formats.concat(formats);
                        }
                },

                _setFormatByClassName: function (itemsArray, tableClassName)
                {
                        var format = {
                                name: "",
                                text: "",
                                table: "",
                                evenRow: "",
                                oddRow: "",
                                headerRow: "",
                                footerRow: "",
                                evenHeaderCol: "",
                                oddHeaderCol: "",
                                firstHeaderCol: "",
                                lastHeaderCol: "",
                                evenCol: "",
                                oddCol: "",
                                firstCol: "",
                                lastCol: "",
                                evenFooterCol: "",
                                oddFooterCol: "",
                                firstFooterCol: "",
                                lastFooterCol: ""
                        };

                        format.name = tableClassName;
                        format.text = tableClassName;
                        format.table = tableClassName;

                        var tableClassNameMachString = tableClassName + " ";
                        var itemsArrayLength = itemsArray.length;
                        for (var i = 0; i < itemsArrayLength; i++)
                        {
                                var selectorText = itemsArray[i][1].selectorText.substr(1);
                                if (selectorText.indexOf(" ") != -1 && selectorText.indexOf(tableClassNameMachString) != -1)
                                {
                                        var className = itemsArray[i][0];
                                        if (selectorText.match(/TableEvenRow/i) != null)
                                                format.evenRow = className.replace(/TableEvenRow/i, "TableEvenRow");
                                        else if (selectorText.match(/TableOddRow/i) != null)
                                                format.oddRow = className.replace(/TableOddRow/i, "TableOddRow");
                                        else if (selectorText.match(/TableHeaderRow/i) != null)
                                                format.headerRow = className.replace(/TableHeaderRow/i, "TableHeaderRow");
                                        else if (selectorText.match(/TableFooterRow/i) != null)
                                                format.footerRow = className.replace(/TableFooterRow/i, "TableFooterRow");
                                        else if (selectorText.match(/TableHeaderEvenCol/i) != null)
                                                format.evenHeaderCol = className.replace(/TableHeaderEvenCol/i, "TableHeaderEvenCol");
                                        else if (selectorText.match(/TableHeaderOddCol/i) != null)
                                                format.oddHeaderCol = className.replace(/TableHeaderOddCol/i, "TableHeaderOddCol");
                                        else if (selectorText.match(/TableHeaderFirstCol/i) != null)
                                                format.firstHeaderCol = className.replace(/TableHeaderFirstCol/i, "TableHeaderFirstCol");
                                        else if (selectorText.match(/TableHeaderLastCol/i) != null)
                                                format.lastHeaderCol = className.replace(/TableHeaderLastCol/i, "TableHeaderLastCol");
                                        else if (selectorText.match(/TableEvenCol/i) != null)
                                                format.evenCol = className.replace(/TableEvenCol/i, "TableEvenCol");
                                        else if (selectorText.match(/TableOddCol/i) != null)
                                                format.oddCol = className.replace(/TableOddCol/i, "TableOddCol");
                                        else if (selectorText.match(/TableFirstCol/i) != null)
                                                format.firstCol = className.replace(/TableFirstCol/i, "TableFirstCol");
                                        else if (selectorText.match(/TableLastCol/i) != null)
                                                format.lastCol = className.replace(/TableLastCol/i, "TableLastCol");
                                        else if (selectorText.match(/TableFooterEvenCol/i) != null)
                                                format.evenFooterCol = className.replace(/TableFooterEvenCol/i, "TableFooterEvenCol");
                                        else if (selectorText.match(/TableFooterOddCol/i) != null)
                                                format.oddFooterCol = className.replace(/TableFooterOddCol/i, "TableFooterOddCol");
                                        else if (selectorText.match(/TableFooterFirstCol/i) != null)
                                                format.firstFooterCol = className.replace(/TableFooterFirstCol/i, "TableFooterFirstCol");
                                        else if (selectorText.match(/TableFooterLastCol/i) != null)
                                                format.lastFooterCol = className.replace(/TableFooterLastCol/i, "TableFooterLastCol");
                                }
                        }

                        return format;
                },

                _getTableClassesArray: function (itemsArray)
                {
                        var arTableClasses = [];
                        var itemsArrayLength = itemsArray.length;

                        count = 0;
                        for (var i = 0; i < itemsArrayLength; i++)
                        {
                                var selectorText = itemsArray[i][1].selectorText.substr(1);
                                if (selectorText.indexOf(" ") == -1)
                                {
                                        arTableClasses[count++] = selectorText;
                                }
                        }

                        return arTableClasses;
                },

                _loadData: function ()
                {
                        // check if formatting was applied over the selected table
                        this._styleSheetToRemove = null;
                        this._classToClear = "";
                        this._canFormatTable = false;



                        if (!this._formats)
                        {
                                var styleSheets = this._editorRef.get_document().styleSheets,
                                        cssStyleSheet = null,
                                        styleSheet = null,
                                        styleSheetsLength = styleSheets.length,
                                        stripPathRegEx = /^.*(\\|\/|\:)/,
                                        cssFilePath = (this._cssFilePath || "").replace(stripPathRegEx, '');

                                if (cssFilePath)
                                {
                                        for (var i = 0; i < styleSheetsLength; i++)
                                        {
                                                var styleSheetHref = "";
                                                styleSheet = styleSheets[i];
                                                var ownerNode = (styleSheet.ownerNode) ? styleSheet.ownerNode : styleSheet.owningElement;
                                                if (ownerNode)
                                                        styleSheetHref = (ownerNode.getAttribute("href", 2) || "").replace(stripPathRegEx, '');

                                                if (styleSheetHref == cssFilePath)
                                                {
                                                        cssStyleSheet = styleSheet;
                                                        break;
                                                }
                                        }
                                        this._loadStyleSheetFormats(cssStyleSheet);
                                }

                                if (!cssStyleSheet && !this._cssFilePath)
                                {
                                        styleSheets = document.styleSheets;
                                        styleSheetsLength = styleSheets.length;
                                        for (var i = 0; i < styleSheetsLength; i++)
                                        {
                                                styleSheet = styleSheets[i];
                                                var styleSheetId = (typeof (styleSheet.id) != "undefined") ? styleSheet.id : styleSheet.ownerNode.id;
                                                if (styleSheetId.indexOf("telerik-reTable") != -1)
                                                {
                                                        cssStyleSheet = styleSheet;
                                                        this._loadStyleSheetFormats(cssStyleSheet);
                                                }
                                        }
                                }
                        }

                        if (this._formats)
                        {
                                //clear this._formatName
                                var options = this._formatName.options;
                                var optionsLength = options.length;
                                var formatsLength = this._formats.length;
                                if (optionsLength == 1) //loading the table formats
                                {
                                        for (var i = 0; i < formatsLength; i++)
                                        {
                                                var tableFormat = this._formats[i];
                                                var option = document.createElement('option');
                                                option.setAttribute('value', tableFormat.name);
                                                option.appendChild(document.createTextNode(tableFormat.text));
                                                this._formatName.appendChild(option);
                                        }
                                }

                                if (this._table)
                                {
                                        var bClearFormat = true;
                                        var tableClassName = this._getClassName(this._table);
                                        if (tableClassName)
                                        {
                                                for (var i = 0; i < formatsLength; i++)
                                                {
                                                        var format = this._formats[i];
                                                        if (format.table == tableClassName)
                                                        {
                                                                this._formatName.value = format.name;

                                                                if (!this._cssFilePath && this._editorRef) this._styleSheetToRemove = $get(tableClassName); //load styleSheet to remove only if there is no cssFilePath
                                                                this._classToClear = tableClassName; //can clear format if you selected no formatting

                                                                //check end cells
                                                                var rows = this._table.rows;
                                                                var firstRow = rows[0];
                                                                var lastRow = rows[rows.length - 1];

                                                                if (this._getClassName(firstRow) == format.headerRow)
                                                                        this._headerRow.checked = "checked";
                                                                else
                                                                        this._headerRow.checked = "";

                                                                if (this._getClassName(lastRow) == format.footerRow)
                                                                        this._lastRow.checked = "checked";
                                                                else
                                                                        this._lastRow.checked = "";

                                                                //check the className of the first and the last cell of the first row
                                                                var cells = firstRow.cells;
                                                                var firstCellClassName = this._getClassName(cells[0]);
                                                                var lastCellClassName = this._getClassName(cells[cells.length - 1]);
                                                                if (firstCellClassName == format.firstCol || firstCellClassName == format.firstHeaderCol)
                                                                        this._firstColumn.checked = "checked";
                                                                else
                                                                        this._firstColumn.checked = "";

                                                                if (lastCellClassName == format.lastCol || lastCellClassName == format.lastHeaderCol)
                                                                        this._lastColumn.checked = "checked";
                                                                else
                                                                        this._lastColumn.checked = "";

                                                                bClearFormat = false;
                                                                break;
                                                        }
                                                }
                                        }

                                        if (bClearFormat)
                                        {
                                                this._formatName.value = "";
                                                this._headerRow.checked = "checked";
                                                this._lastRow.checked = "checked";
                                                this._firstColumn.checked = "checked";
                                                this._lastColumn.checked = "checked";
                                        }

                                        this._formatNameHandler(false);
                                }
                        }
                },

                _updateTarget: function ()
                {
                        if (null != this._table)
                        {
                                if (this._canFormatTable)
                                {
                                        if (this._tableFormat)
                                        {
                                                this._setTableFormat(this._table, this._tableFormat);
                                                if (!this._cssFilePath && this._editorRef)
                                                {
                                                        this._selectedStyleSheet = $get(this._tableFormat.name);
                                                }
                                        }
                                        else if (this._classToClear)
                                        {
                                                var oldClassName = this._getClassName(this._table);
                                                this._clearTableFormat(this._table);
                                                if (oldClassName != this._classToClear) this._setClassName(this._table, oldClassName);
                                        }
                                }
                                if (!this._cssFilePath && this._getClassName(this._table) == this._classToClear) this._styleSheetToRemove = null; //if there is no chenge of the formating do not remove the StyleSheet.

                                return this._table;
                        }

                        return null;
                },

                set_tableToModify: function (value)
                {
                        this._table = value;
                },

                _clearTableFormat: function (table)
                {
                        if (!table) return false;
                        this._setClassName(table, "");
                        var rows = table.rows;
                        var rowsLength = rows.length;
                        for (var i = 0; i < rowsLength; i++)
                        {
                                var row = rows[i];
                                this._setClassName(row, "");
                                var cells = row.cells;
                                var cellsLength = cells.length;
                                for (var j = 0; j < cellsLength; j++)
                                {
                                        var cell = cells[j];
                                        this._setClassName(cell, "");
                                }
                        }
                },

                _setTableFormat: function (table, format)
                {
                        if (!table || !format) return false;

                        var headerRowChecked = this._headerRow.checked;
                        var lastRowChecked = this._lastRow.checked;
                        var firstColumnChecked = this._firstColumn.checked;
                        var lastColumnChecked = this._lastColumn.checked;

                        //set the calss name of the table
                        this._setClassName(table, format.table);
                        var rows = table.rows;
                        if (rows)
                        {
                                var rowsLength = rows.length;
                                var rowsEndIndex = rowsLength - 1;
                                for (var i = 0; i < rowsLength; i++)
                                {
                                        var row = rows[i];
                                        var rowClassName = "";
                                        // setting the class name to the row
                                        if (i == 0 && headerRowChecked)
                                                rowClassName = format.headerRow;
                                        else if (i == rowsEndIndex && lastRowChecked)
                                                rowClassName = format.footerRow;
                                        else
                                                rowClassName = (i % 2 == 0) ? format.evenRow : format.oddRow;

                                        this._setClassName(row, rowClassName);
                                        var cells = row.cells;
                                        if (cells)
                                        {
                                                var cellsLength = cells.length;
                                                var cellsEndIndex = cellsLength - 1;
                                                for (var j = 0; j < cellsLength; j++)
                                                {
                                                        var cell = cells[j];
                                                        var cellClassName = "";

                                                        //setting the class name of the cell
                                                        if (i == 0 && j == 0) //first cell of first row
                                                        {
                                                                if (!headerRowChecked && !firstColumnChecked)
                                                                        cellClassName = format.evenCol;
                                                                else if (!headerRowChecked && firstColumnChecked)
                                                                        cellClassName = format.firstCol;
                                                                else if (headerRowChecked && !firstColumnChecked)
                                                                        cellClassName = format.evenHeaderCol;
                                                                else if (headerRowChecked && firstColumnChecked)
                                                                        cellClassName = format.firstHeaderCol;
                                                        }
                                                        else if (i == 0 && j == cellsEndIndex) //last cell of first row
                                                        {
                                                                if (!headerRowChecked && !lastColumnChecked)
                                                                        cellClassName = (cellsEndIndex % 2 == 0) ? format.evenCol : format.oddCol;
                                                                else if (!headerRowChecked && lastColumnChecked)
                                                                        cellClassName = format.lastCol;
                                                                else if (headerRowChecked && !lastColumnChecked)
                                                                        cellClassName = (cellsEndIndex % 2 == 0) ? format.evenHeaderCol : format.oddHeaderCol;
                                                                else if (headerRowChecked && lastColumnChecked)
                                                                        cellClassName = format.lastHeaderCol;
                                                        }
                                                        else if (i == 0 && headerRowChecked) //non-end cell of the first row. If !headerRowChecked it will be processed as normal cell
                                                        {
                                                                cellClassName = (j % 2 == 0) ? format.evenHeaderCol : format.oddHeaderCol;
                                                        }
                                                        else if (i == rowsEndIndex && j == 0) //first cell of the last row.
                                                        {
                                                                if (!lastRowChecked && !firstColumnChecked)
                                                                        cellClassName = format.evenCol;
                                                                else if (!lastRowChecked && firstColumnChecked)
                                                                        cellClassName = format.firstCol;
                                                                else if (lastRowChecked && !firstColumnChecked)
                                                                        cellClassName = format.evenFooterCol;
                                                                else if (lastRowChecked && firstColumnChecked)
                                                                        cellClassName = format.firstFooterCol;
                                                        }
                                                        else if (i == rowsEndIndex && j == cellsEndIndex) //last cell of the last row.
                                                        {
                                                                if (!lastRowChecked && !lastColumnChecked)
                                                                        cellClassName = (cellsEndIndex % 2 == 0) ? format.evenCol : format.oddCol;
                                                                else if (!lastRowChecked && lastColumnChecked)
                                                                        cellClassName = format.lastCol;
                                                                else if (lastRowChecked && !lastColumnChecked)
                                                                        cellClassName = (cellsEndIndex % 2 == 0) ? format.evenFooterCol : format.oddFooterCol;
                                                                else if (lastRowChecked && lastColumnChecked)
                                                                        cellClassName = format.lastFooterCol;
                                                        }
                                                        else if (i == rowsEndIndex && lastRowChecked) //non-end cell of the last row. If !headerRowChecked it will be processed as normal cell
                                                                cellClassName = (j % 2 == 0) ? format.evenFooterCol : format.oddFooterCol;
                                                        else if (j == 0 && firstColumnChecked) //first cell of non-end row.
                                                                cellClassName = format.firstCol;
                                                        else if (j == cellsEndIndex && lastColumnChecked) //last cell of non-end row.
                                                                cellClassName = format.lastCol;
                                                        else
                                                                cellClassName = (j % 2 == 0) ? format.evenCol : format.oddCol;

                                                        this._setClassName(cell, cellClassName);
                                                }
                                        }

                                }
                        }
                },

                _disposeChildEvents: function ()
                {
                        $clearHandlers(this._formatName);
                        $clearHandlers(this._headerRow);
                        $clearHandlers(this._lastRow);
                        $clearHandlers(this._firstColumn);
                        $clearHandlers(this._lastColumn);
                },

                dispose: function ()
                {
                        this._disposeChildEvents();

                        this._tableFormat = null;
                        this._formatName = null;
                        this._headerRow = null;
                        this._lastRow = null;
                        this._firstColumn = null;
                        this._lastColumn = null;

                        TABLE_BORDER_CONTROL = null;
                        Telerik.Web.UI.Widgets.TableBorder.callBaseMethod(this, "dispose");
                }
        }

        Telerik.Web.UI.Widgets.TableBorder.registerClass('Telerik.Web.UI.Widgets.TableBorder', Telerik.Web.UI.RadWebControl, Telerik.Web.IParameterConsumer);
</script>

<style type="text/css">
        .TableFormatter table
        {
                table-layout: fixed;
        }
</style>
<div style="margin: 10px;" class="TableFormatter">
        <div style="margin-bottom: 5px;">
                <select id="FormatName" style="width: 200px;">
                        <option selected="selected" value="">
                                <script type="text/javascript">document.write(localization["NoCSSClassLayout"]);</script>
                        </option>
                </select>
        </div>
        <div style="margin-bottom: 5px;">
                <script type="text/javascript">document.write(localization["ApplySpecialFormatsTo"]);</script>
        </div>
        <table id="toolsTable" width="100%" border="0" cellpadding="0" cellspacing="0" style="text-align: left;
                margin-bottom: 50px;">
                <tr>
                        <td style="vertical-align: top;">
                                <div>
                                        <input type="checkbox" disabled="disabled" checked="checked" id="HeaderRow" />
                                        <script type="text/javascript">document.write(localization["HeadingRow"]);</script>
                                </div>
                                <div>
                                        <input type="checkbox" disabled="disabled" checked="checked" id="FirstColumn" />
                                        <script type="text/javascript">document.write(localization["FirstColumn"]);</script>
                                </div>
                        </td>
                        <td style="vertical-align: top;">
                                <div>
                                        <input type="checkbox" disabled="disabled" checked="checked" id="LastRow" />
                                        <script type="text/javascript">document.write(localization["LastRow"]);</script>
                                </div>
                                <div>
                                        <input type="checkbox" disabled="disabled" checked="checked" id="LastColumn" />
                                        <script type="text/javascript">document.write(localization["LastColumn"]);</script>
                                </div>
                        </td>
                </tr>
        </table>
        <div style="margin-bottom: 5px;">
                <script type="text/javascript">document.write(localization["Preview"]);</script> :
        </div>
        <table id="PreviewTable" style="width: 100%; text-align: left;">
                <thead>
                        <tr>
                                <th></th>
                                <th>Jan</th>
                                <th>Feb</th>
                                <th>Mar</th>
                                <th>Total</th>
                        </tr>
                </thead>
                <tbody>
                        <tr>
                                <td>East</td>
                                <td>7</td>
                                <td>7</td>
                                <td>5</td>
                                <td>19</td>
                        </tr>
                        <tr>
                                <td>West</td>
                                <td>6</td>
                                <td>4</td>
                                <td>7</td>
                                <td>17</td>
                        </tr>
                        <tr>
                                <td>South</td>
                                <td>8</td>
                                <td>7</td>
                                <td>9</td>
                                <td>24</td>
                        </tr>
                </tbody>
                <tfoot>
                        <tr>
                                <td>Total</td>
                                <td>21</td>
                                <td>18</td>
                                <td>21</td>
                                <td>60</td>
                        </tr>
                </tfoot>
        </table>
</div>
<input id="TableBorder_ClientState" name="TableBorder_ClientState" type="hidden" />
                                        </div>
                        </fieldset>
                </td>
        </tr>
        <tr>
                <td>
                        <fieldset style="width:305px;"  class="reTablePropertiesLayout">
                                <legend>
                                        <script type="text/javascript">document.write(localization["Layout"]);</script>
                                </legend>
                                <table border="0" cellpadding="0" cellspacing="0" style="width: 100%;">
                                        <tr>
                                                <td class="reLabelCell"><label class="reDialogLabel" ><script type="text/javascript">document.write(localization["CellSpacing"]);</script>:</label></td>
                                                <td class="reControlCell"><div class="reToolWrapper Default" id="SpinBoxCellSpacing">

                                        </div></td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell"><label class="reDialogLabel" ><script type="text/javascript">document.write(localization["CellPadding"]);</script>:</label></td>
                                                <td class="reControlCell"><div class="reToolWrapper Default" id="SpinBoxCellSPadding">

                                        </div></td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell"><label class="reDialogLabel" ><script type="text/javascript">document.write(localization["Alignment"]);</script>:</label></td>
                                                <td class="reControlCell"><div class="reToolWrapper Default">
                                                <a id="AlignmentSelectorTable" title="Alignment selector" class="reTool reSplitButton" href="#"><span class="AlignmentSelector">&nbsp;</span><span class="split_arrow">&nbsp;</span></a>
                                        </div></td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell"><label class="reDialogLabel" ><script type="text/javascript">document.write(localization["BackgroundColor"]);</script>:</label></td>
                                                <td class="reControlCell"><div class="reToolWrapper Default">
                                                <a id="ColorPicker" title="ColorPicker" class="reTool reSplitButton" href="#"><span class="BackColor">&nbsp;</span><span class="split_arrow">&nbsp;</span></a>
                                        </div></td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell"><label class="reDialogLabel" ><script type="text/javascript">document.write(localization["StyleBuilder"]);</script>:</label></td>
                                                <td class="reControlCell"><div class="reToolWrapper Default">
                                                <a id="StyleBuilder" title="Style Builder" class="reTool" href="#"><span class="StyleBuilder">&nbsp;</span></a>
                                        </div></td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell"><label class="reDialogLabel" ><script type="text/javascript">document.write(localization["CssClass"])</script>:</label></td>
                                                <td class="reControlCell"><div class="reToolWrapper Default">
                                                <a id="ClassSelector" title="ApplyClass" class="reDropdown" href="#"><span class="ApplyClass" style="width:100px;">ApplyClass</span></a>
                                        </div></td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell"><label class="reDialogLabel" ><script type="text/javascript">document.write(localization["BackgroundImage"]);</script>:</label></td>
                                                <td class="reControlCell"><div class="reToolWrapper Default" id="ImageCaller">
                                                <table class="reImageDialogCaller">
                                                        <tbody>
                                                                <tr>
                                                                        <td><input type="text" /></td><td><div class="reToolWrapper Default">
                                                                                <a id="ImageCaller_CallerButton" title="Image Manager" class="reTool" href="#"><span class="ImageManager">&nbsp;</span></a>
                                                                        </div></td>
                                                                </tr>
                                                        </tbody>
                                                </table>
                                        </div></td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell"><label class="reDialogLabel" ><script type="text/javascript">document.write(localization["Id"]);</script>:</label></td>
                                                <td class="reControlCell"><input type="text" id="TableId" value="" /></td>
                                        </tr>
                                </table>
                        </fieldset>
                </td>
        </tr>
</table><input id="tablePropertiesPanel_ClientState" name="tablePropertiesPanel_ClientState" type="hidden" />
                                </div>

                        </div><div id="cellPropertiesRow" class="rmpHiddenView">

                                        <div id="cellPropertiesPanel">
                                        <div id="resourcesCellProperties">
                                                <script type="text/javascript">
//<![CDATA[
localization._fill({});
//]]>
</script>
<input id="resourcesCellProperties_ClientState" name="resourcesCellProperties_ClientState" type="hidden" />
                                        </div>
<script type="text/javascript">
        Type.registerNamespace("Telerik.Web.UI.Widgets");
        Telerik.Web.UI.Widgets.CellProperties = function (element)
        {
                Telerik.Web.UI.Widgets.CellProperties.initializeBase(this, [element]);

                this._cssClassSelector = null;
                this._cellAlignmentSelector = null;
                this._backgroundColorPicker = null;
                this._bgImageDialogCaller = null;
                this._cssText = "";

                this._columnWidthBox = null;
                this._columnHeightBox = null;

                this._columnWrapHolder = null;

                this._idHolder = null;

                this._editorObject = null;
                this._cellToModify = null;
                this._clientParameters = null;
                this._tablePreviewControl = null;
        }

        Telerik.Web.UI.Widgets.CellProperties.prototype = {
                initialize: function ()
                {
                        Telerik.Web.UI.Widgets.CellProperties.callBaseMethod(this, "initialize");
                        this._initializeChildren();
                },

                _initializeChildren: function ()
                {
                        this._cssClassSelector = $find("ClassSelectorCellCss");

                        this._cellAlignmentSelector = $find("alignmentSelectorCellContent");
                        this._backgroundColorPicker = $find("ColorPickerCellBackground");
                        this._bgImageDialogCaller = $find("ImageCallerCellBackgroundImage");
                        this._columnWidthBox = $find("SpinBoxCellWidth");
                        this._columnHeightBox = $find("SpinBoxCellHeight");
                        this._columnWrapHolder = $get("CellNoWrap");
                        this._idHolder = $get("CellId");
                        this._styleBuilder = $find("CellStyleBuilder");

                        this._tablePreviewControl = new Telerik.Web.UI.Widgets.TablePreview();
                        this._tablePreviewControl.set_previewHolder($get("CellProperties_PreviewTableHolder"));

                        this._initializeChildEvents();
                },

                _initializeChildEvents: function ()
                {
                        //NEW: StyleBuilder
                        this._styleBuilder.add_valueSelected(Function.createDelegate(this, this._styleBuilderClicked));
                },

                //NEW: StyleBuilder
                _styleBuilderClicked: function (oTool, args)
                {
                        //Editor object is supplied to all dialogs in the dialog parameters
                        var editor = this._clientParameters.editor;
                        var callbackFunction = Function.createDelegate(this, function (sender, args)
                        {
                                //Returned link - TODO: Use args.get_value() when the dialog returm methods are changed to return proper args object
                                var resulCell = args.get_value();
                                this._cssText = resulCell.style.cssText;
                                this._loadPropertyValues(resulCell);
                        });

                        //NEW: Use EditorCommandEventArgs
                        var parameterCell = this._cellToModify.cloneNode(true);
                        this._update(parameterCell);
                        var argument = new Telerik.Web.UI.EditorCommandEventArgs("StyleBuilder", null, parameterCell);

                        Telerik.Web.UI.Editor.CommandList._getDialogArguments(argument, "*", editor, "StyleBuilder");
                        argument.fontNames = editor.get_fontNames();
                        editor.showDialog("StyleBuilder", argument, callbackFunction);
                },

                clientInit: function (clientParameters)
                {
                        this._clientParameters = clientParameters;
                        this._editorObject = this._clientParameters.editor;
                        this._cssClasses = this._clientParameters.CellCssClasses;

                        this._cellAlignmentSelector.setTagName("TD");

                        this._bgImageDialogCaller.set_editor(this._editorObject);
                        this._backgroundColorPicker.set_items(this._clientParameters.Colors);
                        this._backgroundColorPicker.set_addCustomColorText(localization["AddCustomColor"]);
                        if (this._backgroundColorPicker._popupVisible) this._backgroundColorPicker.hide();

                        //localization
                        this._cssClassSelector.set_showText(true);
                        this._cssClassSelector.set_clearclasstext(localization["ClearClass"]);
                        this._cssClassSelector.set_text(localization["ApplyClass"]);
                        this._cssClassSelector.set_items(this._cssClasses);
                        this._cssClassSelector.add_valueSelected(this._cssValueSelected);

                },

                _setCssPropertyValue: function (element, cssProperty, value, attribute)
                {
                        if (!element || !cssProperty) return;
                        if (attribute) element.removeAttribute(attribute);
                        element.style[cssProperty] = value;
                },

                _cssValueSelected: function (oTool, args)
                {
                        if (!oTool) return;
                        var commandName = oTool.get_name();

                        if ("ApplyClass" == commandName)
                        {
                                var attribValue = oTool.get_selectedItem();
                                oTool.updateValue(attribValue);
                        }
                },
                set_cellToModify: function (value)
                {
                        this._cellToModify = value;
                        this._loadPropertyValues(this._cellToModify);
                },
                get_tablePreviewControl: function ()
                {
                        return this._tablePreviewControl;
                },
                ///////////////////////////////////// the fun starts here ///////////////

                _clear: function ()
                {
                        var EmptyCell = document.createElement('td');
                        EmptyCell.innerHTML = "&nbsp;";
                        this._loadPropertyValues(EmptyCell);
                },

                _loadPropertyValues: function (cellToModify)
                {
                        this._cellToModify = cellToModify;

                        this._cssText = this._cellToModify.style.cssText;

                        this._columnWidthBox.set_value(this._cellToModify.style.width || this._cellToModify.width);
                        this._columnHeightBox.set_value(this._cellToModify.style.height || this._cellToModify.height);

                        var oId = this._cellToModify.getAttribute("id"); //OPERA
                        this._idHolder.value = oId || "";

                        var textAlign = this._cellToModify.style["textAlign"];
                        var verticalAlign = this._cellToModify.style["verticalAlign"];
                        var alignAttributeValue = this._cellToModify.getAttribute("align");
                        var vAlignAttributeValue = this._cellToModify.getAttribute("vAlign");

                        if ((textAlign == "left" || textAlign == "center" || textAlign == "right") && (verticalAlign == "top" || verticalAlign == "middle" || verticalAlign == "bottom"))
                                this._cellAlignmentSelector.updateValue(textAlign, verticalAlign);
                        else if (alignAttributeValue || vAlignAttributeValue)
                                this._cellAlignmentSelector.updateValue(alignAttributeValue, vAlignAttributeValue);
                        else
                                this._cellAlignmentSelector.updateValue(null, null);

                        this._columnWrapHolder.checked = (this._cellToModify.style.whiteSpace == "nowrap");

                        var backgroundColor = this._cellToModify.style.backgroundColor;
                        this._backgroundColorPicker.set_color(backgroundColor);

                        var cssClassVal = this._cellToModify.className;
                        if (cssClassVal == null)
                        {
                                cssClassVal = "";
                        }

                        this._cssClassSelector.updateValue(cssClassVal);
                        if (cssClassVal == "")
                                this._cssClassSelector.set_selectedIndex(0);

                        if (this._bgImageDialogCaller && this._cellToModify)
                        {
                                var imagePath = this._cellToModify.style.backgroundImage;
                                imagePath = (!imagePath) ? "" : imagePath.substring(4, imagePath.length - 1);
                                this._bgImageDialogCaller.set_value(imagePath);
                        }

                },


                _updateMultiple: function (cells)
                {
                        for (var i = 0; i < cells.length; i++)
                        {
                                if (!this._update(cells[i]))
                                {
                                        return false;
                                }
                        }
                        return true;
                },

                //TEKI - Shortened this method 2 times + fixed a problem with setting width and height
                _update: function (cell)
                {
                        if (typeof (cell) != 'undefined')
                        {
                                this._cellToModify = cell;
                        }

                        var oCell = this._cellToModify;
                        if (!oCell) return false;

                        oCell.style.cssText = this._cssText;

                        //This must be set on top - before all else, because it is interfering with the style.width and style.height stuff
                        if (oCell.style.cssText == '')
                        {
                                oCell.removeAttribute('style', false);
                        }
                        var theWidthValue = this._columnWidthBox.get_value();
                        if (!this._isValueValid(theWidthValue))
                        {
                                return false;
                        }


                        oCell.removeAttribute("width", false);

                        oCell.style.width = theWidthValue ? this._convertIntToPixel(theWidthValue) : ""; //SAFARI - ConvertIntToPixel px

                        var theHeightValue = this._columnHeightBox.get_value();
                        if (!this._isValueValid(theHeightValue))
                        {
                                return false;
                        }

                        oCell.removeAttribute("height", false);
                        oCell.style.height = theHeightValue ? this._convertIntToPixel(theHeightValue) : ""; //SAFARI - px

                        this._setAttribValue("id", this._idHolder.value);

                        this._setCssPropertyValue(oCell, "textAlign", this._cellAlignmentSelector.getAlign(), "align");
                        this._setCssPropertyValue(oCell, "verticalAlign", this._cellAlignmentSelector.getVAlign(), "vAlign");

                        if (oCell.style["backgroundColor"] != this._backgroundColorPicker.get_color())
                        {
                                this._setCssPropertyValue(oCell, "backgroundColor", this._backgroundColorPicker.get_color(), "bgColor");
                        }

                        var backgroundImage = this._bgImageDialogCaller.get_value();
                        backgroundImage = (backgroundImage) ? "url(" + backgroundImage + ")" : "";
                        this._setCssPropertyValue(oCell, "backgroundImage", backgroundImage, "background");

                        oCell.className = this._cssClassSelector.get_value();

                        var whiteSpaceValue = (this._columnWrapHolder.checked) ? "nowrap" : "";
                        this._setCssPropertyValue(oCell, "whiteSpace", whiteSpaceValue, "noWrap");

                        return true;
                },

                _isValueValid: function (value)
                {
                        if (value == "") return true;
                        var valueInt = parseFloat(value, 10);
                        if (!isNaN(valueInt))
                        {
                                //NEW support for all css units
                                var isValidPercent = (valueInt + '%' == value);
                                var isValidPixel = (valueInt + 'px' == value.toLowerCase());
                                var isValidEm = (valueInt + 'em' == value.toLowerCase());
                                var isValidEx = (valueInt + 'ex' == value.toLowerCase());
                                var isValidIn = (valueInt + 'in' == value.toLowerCase());
                                var isValidCm = (valueInt + 'cm' == value.toLowerCase());
                                var isValidMm = (valueInt + 'mm' == value.toLowerCase());
                                var isValidPt = (valueInt + 'pt' == value.toLowerCase());
                                var isValidPc = (valueInt + 'pc' == value.toLowerCase());
                                var isValidNumber = (valueInt.toString() == value);

                                if (isValidPercent || isValidPixel || isValidEm || isValidEx || isValidIn || isValidCm || isValidMm || isValidPt || isValidPc || isValidNumber)
                                {
                                        return true;
                                }
                        }
                        return false;
                },

                _convertIntToPixel: function (oVal)
                {
                        var oNew = "" + oVal;

                        if (oNew.indexOf("%") != -1)
                        {
                                return oNew;
                        }
                        else
                        {
                                var arMatch = oNew.match(/(em|ex|px|in|cm|mm|pt|pc)$/); //NEW support for all css units
                                oNew = parseFloat(oNew);
                                if (!isNaN(oNew))
                                {
                                        oNew = (arMatch) ? oNew + arMatch[0] : oNew + "px"; //NEW support for all css units
                                        return oNew;
                                }
                        }
                        return oVal;
                },

                /* TEKI new - optimize the code a bit through refactoring */
                _setAttribValue: function (attribName, oVal, forceVal)
                {
                        if (oVal || (true == forceVal))//cellSpacing or cellPadding have by default 1 so we might want to set it to 0
                        {
                                this._cellToModify.setAttribute(attribName, oVal);
                        }
                        else
                        {
                                this._cellToModify.removeAttribute(attribName, false);
                        }
                },

                /////////////////////////////////////////////////////////////////////////

                dispose: function ()
                {
                        this._clientParameters = null;
                        this._cssClassSelector = null;
                        this._cellAlignmentSelector = null;
                        this._backgroundColorPicker = null;
                        this._bgImageDialogCaller = null;

                        this._columnWidthBox = null;
                        this._columnHeightBox = null;

                        this._columnWrapHolder = null;
                        this._cellToModify = null;
                        this._idHolder = null;

                        this._editorObject = null;
                        this._tablePreviewControl = null;

                        Telerik.Web.UI.Widgets.CellProperties.callBaseMethod(this, "dispose");
                }
        }

        Telerik.Web.UI.Widgets.CellProperties.registerClass('Telerik.Web.UI.Widgets.CellProperties', Telerik.Web.UI.RadWebControl, Telerik.Web.IParameterConsumer);
</script>
<style type="text/css">
.tableWizardCellProperties td
{
        padding: 3px 0;
}
</style>
<table border="0" cellpadding="0" cellspacing="0" style="margin-left: 4px;">
        <tr>
                <td style="vertical-align: top; padding-right: 4px;">
                        <fieldset style="height: 394px;" class="reCellPropertiesPreview">
                                <legend>
                                        <script type="text/javascript">document.write(localization["Preview"]);</script>
                                </legend>
                                <div id="CellProperties_PreviewTableHolder" style="overflow: auto; width: 385px;height: 381px;"></div>
                        </fieldset>
                </td>
                <td style="vertical-align: top;">
                        <fieldset style="height: 394px; width: 295px;" class="reCellProperties">
                                <legend>
                                        <script type="text/javascript">document.write(localization["Tab3HeaderText"]);</script>
                                </legend>
                                <table cellpadding="0" cellspacing="0" class="tableWizardCellProperties" style="margin: 10px 0 0 22px;">
                                        <tr>
                                                <td>
                                                        <div class="propertyLabel" style="width: 90px;">
                                                                <script type="text/javascript">document.write(localization["Height"]);</script>:
                                                        </div>
                                                </td>
                                                <td>
                                                        <div class="reToolWrapper Default" id="SpinBoxCellHeight">

                                        </div>
                                                        <script type="text/javascript">document.write(localization["PixelsOrPercents"]);</script>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td>
                                                        <div class="propertyLabel" style="width: 90px;">
                                                                <script type="text/javascript">document.write(localization["Width"])</script>:
                                                        </div>
                                                </td>
                                                <td>
                                                        <div class="reToolWrapper Default" id="SpinBoxCellWidth">

                                        </div>
                                                        <script type="text/javascript">document.write(localization["PixelsOrPercents"]);</script>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td>
                                                        <div class="propertyLabel" style="width: 90px;">
                                                                <script type="text/javascript">                                                                        document.write(localization["ContentAlignment"]);</script>:
                                                        </div>
                                                </td>
                                                <td>
                                                        <div class="reToolWrapper Default">
                                                <a id="alignmentSelectorCellContent" title="AlignmentSelector" class="reTool reSplitButton" href="#"><span class="AlignmentSelector">&nbsp;</span><span class="split_arrow">&nbsp;</span></a>
                                        </div>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td>
                                                        <div class="propertyLabel" style="width: 90px;">
                                                                <script type="text/javascript">document.write(localization["BackgroundColor"]);</script>:
                                                        </div>
                                                </td>
                                                <td>
                                                        <div class="reToolWrapper Default">
                                                <a id="ColorPickerCellBackground" title="BackColor" class="reTool reSplitButton" href="#"><span class="BackColor">&nbsp;</span><span class="split_arrow">&nbsp;</span></a>
                                        </div>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td style="padding: 3px 0;">
                                                        <div class="propertyLabel" style="width: 90px;">
                                                                <script type="text/javascript">document.write(localization["StyleBuilder"]);</script>
                                                        </div>
                                                </td>
                                                <td style="padding: 3px 0;">
                                                        <div class="reToolWrapper Default">
                                                <a id="CellStyleBuilder" title="Style Builder" class="reTool" href="#"><span class="StyleBuilder">&nbsp;</span></a>
                                        </div>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td>
                                                        <div class="propertyLabel" style="width: 90px;"><script type="text/javascript">document.write(localization["CssClass"]);</script>:</div>
                                                </td>
                                                <td>
                                                        <div class="reToolWrapper Default">
                                                <a id="ClassSelectorCellCss" title="ApplyClass" class="reDropdown" href="#"><span class="ApplyClass" style="width:90px;">ApplyClass</span></a>
                                        </div>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td>
                                                        <label for="cellbackImage" class="propertyLabel" style="width: 90px;">
                                                                <script type="text/javascript">document.write(localization["BackgroundImage"]);</script>:
                                                        </label>
                                                </td>
                                                <td>
                                                        <div class="reToolWrapper Default" id="ImageCallerCellBackgroundImage">
                                                <table class="reImageDialogCaller">
                                                        <tbody>
                                                                <tr>
                                                                        <td><input type="text" /></td><td><div class="reToolWrapper Default">
                                                                                <a id="ImageCallerCellBackgroundImage_CallerButton" title="Image Manager" class="reTool" href="#"><span class="ImageManager">&nbsp;</span></a>
                                                                        </div></td>
                                                                </tr>
                                                        </tbody>
                                                </table>
                                        </div>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td>
                                                        <label class="propertyLabel" for="CellId" style="width: 90px;"><script type="text/javascript">document.write(localization["Id"])</script>:</label>
                                                </td>
                                                <td>
                                                        <input type="text" class="textinput" id="CellId" style="width: 100px;" />
                                                </td>
                                        </tr>
                                        <tr>
                                                <td>
                                                </td>
                                                <td>
                                                        <input type="checkbox" id="CellNoWrap" style="border: 0;" />
                                                        <label for="CellNoWrap"><script type="text/javascript">document.write(localization["NoTextWrapping"]);</script></label>
                                                </td>
                                        </tr>
                                </table>
                        </fieldset>
                </td>
        </tr>
</table><input id="cellPropertiesPanel_ClientState" name="cellPropertiesPanel_ClientState" type="hidden" />
                                </div>

                        </div><div id="accessibilityRow" class="rmpHiddenView">

                                        <div id="accessibilityPanel">
                                        <div id="resourcesAccessibleTable">
                                                <script type="text/javascript">
//<![CDATA[
localization._fill({});
//]]>
</script>
<input id="resourcesAccessibleTable_ClientState" name="resourcesAccessibleTable_ClientState" type="hidden" />
                                        </div>
<script type="text/javascript">
        Type.registerNamespace("Telerik.Web.UI.Widgets");
        Telerik.Web.UI.Widgets.AccessibleTable = function (element)
        {
                Telerik.Web.UI.Widgets.AccessibleTable.initializeBase(this, [element]);

                this._clientParameters = null;
                this._table = null
                this._tableDocument = null;

                this._headingRows = 0;
                this._headingColumns = 0;
                this._caption = "";
                this._summary = "";
                this._captionHalign = "";
                this._captionValign = "";
                this._setCellID = false;

                this._headingRowsInput = null;
                this._headingColumnsInput = null;
                this._captionTextArea = null;
                this._summaryTextArea = null;
                this._setCellIDCheckBox = null;

                this._alignmentSelector = null;

                this._maxHeadRowsSpan = null;
                this._maxHeadColsSpan = null;
        }

        Telerik.Web.UI.Widgets.AccessibleTable.prototype = {
                initialize: function ()
                {
                        Telerik.Web.UI.Widgets.AccessibleTable.callBaseMethod(this, "initialize");
                        this._initializeChildren();
                },

                _initializeChildren: function ()
                {
                        this._headingRowsInput = $get("headingRows");
                        this._headingColumnsInput = $get("headingColumns");
                        this._captionTextArea = $get("CaptionText");
                        this._summaryTextArea = $get("SummaryText");
                        this._setCellIDCheckBox = $get("associateCellsWithHeaders");

                        this._alignmentSelector = $find("alignmentSelector");
                        this._maxHeadRowsSpan = $get("maxHeadRows");
                        this._maxHeadColsSpan = $get("maxHeadColumns");
                },

                clientInit: function (clientParameters)
                {
                        this._clientParameters = clientParameters;
                        if (this._clientParameters)
                        {
                                this._table = this._clientParameters.tableToModify;
                                this._tableDocument = this._clientParameters.tableDocument;
                        }

                        this._loadData();
                },

                _loadData: function ()
                {
                        if (this._table)        // retreive table's data
                        {
                                // caption
                                var caption = this._table.caption;
                                if (caption)
                                {
                                        this._captionHalign = this._getCaptionHalign(caption);
                                        this._captionValign = this._getCaptionValign(caption);
                                        if ($telerik.isIE) // IE
                                                this._caption = this._table.caption.innerText;
                                        else // NS
                                                this._caption = this._table.caption.childNodes[0].nodeValue;
                                }
                                else
                                {
                                        this._caption = '';
                                        this._captionHalign = '';
                                        this._captionValign = '';
                                }
                                this._alignmentSelector.setTagName("CAPTION");
                                this._alignmentSelector.updateValue(this._captionHalign, this._captionValign);

                                // summary
                                this._summary = this._table.summary;
                                // heading
                                this._headingRows = this._table.tHead ? this._table.tHead.rows.length : 0;
                                this._headingColumns = this._countHeadingColumns();
                                this._setCellID = this._checkHeadersHasIds() || this._checkCellsHasHeaders();

                                // show data
                                this._updateData(false);
                        }
                },

                _countHeadingColumns: function ()
                {
                        var count = 0;
                        if (this._table)
                        {
                                var tHead = this._getThead();
                                if (tHead)
                                {
                                        for (i = 0; i < tHead.rows.length; i++)
                                        {
                                                var row = tHead.rows[i];
                                                var cells = row.getElementsByTagName('TH');
                                                if ((cells && cells.length < count) || count == 0)
                                                        count = cells.length;
                                        }
                                }
                                for (k = 0; k < this._table.tBodies.length; k++)
                                {
                                        var tBody = this._table.tBodies[k];
                                        for (i = 0; i < tBody.rows.length; i++)
                                        {
                                                var row = tBody.rows[i];
                                                var cells = row.getElementsByTagName('TH');
                                                if ((cells && cells.length < count) || count == 0)
                                                        count = cells.length;
                                        }
                                }
                        }
                        return count;
                },

                _checkCellsHasHeaders: function ()
                {
                        if (this._table)
                        {
                                for (k = 0; k < this._table.tBodies.length; k++)
                                {
                                        var tBody = this._table.tBodies[k];
                                        for (i = 0; i < tBody.rows.length; i++)
                                        {
                                                var row = tBody.rows[i];
                                                for (j = 0; j < row.cells.length; j++)
                                                {
                                                        var cell = row.cells[j];
                                                        if (cell.getAttribute('headers'))
                                                        {
                                                                return true;
                                                        }
                                                }
                                        }
                                }
                        }
                        return false;
                },

                _checkHeadersHasIds: function ()
                {
                        if (this._table)
                        {
                                for (i = 0; i < this._table.rows.length; i++)
                                {
                                        var row = this._table.rows[i];
                                        for (j = 0; j < row.cells.length; j++)
                                        {
                                                var cell = row.cells[j];
                                                if ("TH" == cell.tagName.toUpperCase() && "" != cell.id)
                                                        return true;
                                        }
                                }
                        }
                        return false;
                },

                _updateData: function (save)
                {
                        if (save) // retreive data from controls
                        {
                                this._headingRows = parseInt(this._headingRowsInput.value);
                                this._headingColumns = parseInt(this._headingColumnsInput.value);
                                this._caption = this._captionTextArea.value;
                                this._summary = this._summaryTextArea.value;

                                this._captionHalign = this._alignmentSelector.getAlign();
                                this._captionValign = this._alignmentSelector.getVAlign();

                                this._setCellID = this._setCellIDCheckBox.checked;
                        }
                        else        // set data to controls
                        {
                                this._headingRowsInput.value = this._headingRows;
                                this._headingColumnsInput.value = this._headingColumns;
                                this._captionTextArea.value = this._caption;
                                this._summaryTextArea.value = this._summary;

                                this._alignmentSelector.updateValue(this._captionHalign, this._captionValign);

                                this._setCellIDCheckBox.checked = this._setCellID;
                                if (this._table)
                                {
                                        var maxRows = this._table.rows.length;
                                        var maxColumns = (this._table.rows.length > 0) ? this._table.rows[0].cells.length : 0;

                                        this._maxHeadRowsSpan.innerText = '(Max. ' + maxRows + ')';
                                        this._maxHeadColsSpan.innerText = '(Max. ' + maxColumns + ')';
                                }
                        }
                },

                _changeCellType: function (cellToConvert, newType)
                {
                        var isChangeMade = false;
                        if (cellToConvert.tagName.toUpperCase() != newType.toUpperCase())
                        {
                                var newCell = this._tableDocument.createElement(newType.toLowerCase());

                                this._mergeAttributes(newCell, cellToConvert);
                                cellToConvert.parentNode.replaceChild(newCell, cellToConvert);
                                isChangeMade = true;
                        }
                        return isChangeMade;
                },

                _mergeAttributes: function (destElem, sourceElem)
                {
                        if (destElem.mergeAttributes)
                        {
                                destElem.mergeAttributes(sourceElem);
                        }
                        else
                        {
                                for (var attrName in sourceElem.attributes)
                                {
                                        destElem.attrName = sourceElem.attributes[attrName];
                                }
                        }
                        if (sourceElem.colSpan > 1) destElem.colSpan = sourceElem.colSpan;
                        if (sourceElem.rowSpan > 1) destElem.rowSpan = sourceElem.rowSpan;
                        destElem.style.cssText = sourceElem.style.cssText;
                        destElem.innerHTML = sourceElem.innerHTML;
                },

                _updateTable: function ()
                {
                        if (null != this._table)
                        {
                                this._updateData(true);

                                this._updateCaption();
                                if (this._summary == "")
                                {
                                        this._table.removeAttribute('summary', false);
                                }
                                else
                                {
                                        this._table.summary = this._summary;
                                }
                                this._updateThead();
                                this._updateRows();
                                this._updateCellIDs();
                        }

                        return this._table;
                },

                _updateCaption: function ()
                {
                        var caption = this._table.caption;
                        if ($telerik.isIE)
                        {
                                if (!caption && "" != this._caption)
                                        caption = this._table.createCaption();
                                if (caption)
                                        caption.innerText = this._caption;
                        }
                        else
                        {
                                if (caption)
                                {
                                        this._table.removeChild(caption);
                                        caption = null;
                                }

                                if (!caption && "" != this._caption)
                                {
                                        var caption = this._tableDocument.createElement("caption");
                                        caption.innerHTML = this._caption;

                                        var table = this._table;
                                        var childNodes = table.childNodes;
                                        if (childNodes.length > 0)
                                                table.insertBefore(caption, childNodes[0]);
                                        else
                                                table.appendChild(caption);
                                }
                        }
                        //set the lign of the caption
                        this._setCaptionHalign(caption, this._captionHalign);
                        this._setCaptionValign(caption, this._captionValign);
                        //needed in IE
                        if (caption)
                        {
                                caption.removeAttribute("align");
                                caption.removeAttribute("vAlign");
                        }
                },

                _setCaptionHalign: function (caption, align)
                {
                        if (!caption) return;
                        caption.style["textAlign"] = align;
                },

                _getCaptionHalign: function (caption)
                {
                        if (!caption) return "";
                        var align = caption.getAttribute("align");
                        if (align)
                        {
                                var ucAlaign = align.toUpperCase();
                                switch (ucAlaign)
                                {
                                        case "LEFT":
                                        case "CENTER":
                                        case "TOP":
                                                this._setCaptionHalign(caption, align);
                                                break;
                                        case "TOP":
                                        case "BOTTOM":
                                                this._setCaptionValign(caption, align);
                                                break;
                                }
                        }
                        caption.removeAttribute("align");
                        return caption.style["textAlign"];
                },

                _setCaptionValign: function (caption, vAlign)
                {
                        if (!caption) return;
                        caption.style["verticalAlign"] = vAlign;
                        caption.style["captionSide"] = vAlign;
                },

                _getCaptionValign: function (caption)
                {
                        if (!caption) return;
                        var vAlign = caption.getAttribute("vAlign");
                        if (vAlign)
                                this._setCaptionValign(caption, vAlign)

                        var align = caption.getAttribute("align");
                        if (align)
                        {
                                var ucAlaign = align.toUpperCase();
                                switch (ucAlaign)
                                {
                                        case "TOP":
                                        case "BOTTOM":
                                                this._setCaptionValign(caption, align);
                                                caption.removeAttribute("align");
                                                break;
                                }
                        }
                        caption.removeAttribute("vAlign");
                        return caption.style["verticalAlign"];
                },

                _getTableColumns: function ()
                {
                        var numColumns = 0;
                        if (null != this._table && this._table.rows.length > 0)
                        {
                                numColumns = this._table.rows[0].cells.length;
                        }
                        return numColumns;
                },

                _getThead: function ()
                {
                        var arrElements = this._table.getElementsByTagName('THEAD');
                        if (arrElements.length > 0)
                                return arrElements[0];
                        else
                                return null;
                },

                _updateThead: function ()
                {
                        var numColumns = this._getTableColumns();
                        var tHead = this._getThead();
                        if (!tHead)
                        {
                                tHead = this._table.createTHead();
                        }

                        var tBodyInsertPos = 0;
                        for (i = 0; i < this._table.rows.length; i++)
                        {
                                var row = this._table.rows[i];
                                var parent = row.parentNode;

                                var parentTagName = parent.tagName.toUpperCase();

                                if (i < this._headingRows)
                                {        // rows that have to be in THEAD
                                        if ("THEAD" != parentTagName)
                                        {
                                                var newRow = tHead.insertRow(tHead.rows.length);
                                                for (j = 0; j < row.cells.length; j++)
                                                {
                                                        var newCell = this._tableDocument.createElement("th");

                                                        //Copy all attributes from the source cell to the new cell.
                                                        this._mergeAttributes(newCell, row.cells[j]);
                                                        newRow.insertBefore(newCell, null);
                                                }
                                                this._table.deleteRow(i + 1);
                                        }
                                }
                                else
                                {        // rows that have not be in THEAD
                                        if ("THEAD" == parentTagName)
                                        {
                                                var newRow = this._table.tBodies[0].insertRow(tBodyInsertPos++);
                                                for (j = 0; j < row.cells.length; j++)
                                                {
                                                        var newCell = newRow.insertBefore(this._tableDocument.createElement("td"), null);
                                                        //Copy all attributes from the source cell to the new cell.
                                                        this._mergeAttributes(newCell, row.cells[j]);
                                                }
                                        }
                                }
                        }
                        // remove the extra heading rows
                        if (this._headingRows < tHead.rows.length)
                        {
                                for (i = tHead.rows.length - 1; i >= this._headingRows; i--)
                                {
                                        tHead.deleteRow(i);
                                }
                        }

                },

                _updateRows: function ()
                {
                        if (this._table)
                        {
                                for (k = 0; k < this._table.tBodies.length; k++)
                                {
                                        var tBody = this._table.tBodies[k];
                                        for (i = 0; i < tBody.rows.length; i++)
                                        {
                                                var row = tBody.rows[i];
                                                for (j = 0; j < row.cells.length; j++)
                                                {
                                                        var cellType = j < this._headingColumns ? "TH" : "TD";
                                                        this._changeCellType(row.cells[j], cellType);
                                                }
                                        }
                                }
                        }
                },

                _updateCellIDs: function ()
                {
                        var haveIds = this._checkHeadersHasIds();
                        var haveHeaders = this._checkCellsHasHeaders();

                        if (this._table && this._table.tHead && (this._setCellID || haveIds || haveHeaders))
                        {
                                var tableID = this._table.id ? this._table.id : this._table.uniqueID;

                                if (!tableID)
                                {
                                        tableID = "table";
                                }

                                var arrHeaders = null;
                                var headingId = 0;

                                if (haveIds || this._setCellID)
                                {
                                        for (i = 0; i < this._table.tHead.rows.length; i++)
                                        {
                                                var row = this._table.tHead.rows[i];
                                                if (!arrHeaders)
                                                        arrHeaders = new Array(row.cells.length);

                                                for (j = 0; j < row.cells.length; j++)
                                                {
                                                        var cell = row.cells[j];

                                                        if (this._setCellID)
                                                        {
                                                                var id = cell.id ? cell.id : (tableID + "_heading_" + headingId++);
                                                                cell.id = id;
                                                                if (!arrHeaders[j])
                                                                        arrHeaders[j] = id;
                                                        }
                                                        else
                                                        {
                                                                cell.id = "";
                                                        }
                                                }
                                        }
                                }

                                for (k = 0; k < this._table.tBodies.length; k++)
                                {
                                        var tBody = this._table.tBodies[k];
                                        for (i = 0; i < tBody.rows.length; i++)
                                        {
                                                var row = tBody.rows[i];
                                                for (j = 0; j < row.cells.length; j++)
                                                {
                                                        var cell = row.cells[j];
                                                        var cellTagName = cell.tagName.toUpperCase();
                                                        if ("TH" == cellTagName)
                                                        {
                                                                if (this._setCellID)
                                                                        cell.id = cell.id ? cell.id : (tableID + "_heading_" + headingId++);
                                                                else
                                                                        cell.id = "";
                                                        }
                                                        else if ("TD" == cellTagName &&
                                                                        this._table.tHead.rows.length > 0 &&
                                                                        arrHeaders &&
                                                                        (haveHeaders || this._setCellID))
                                                        {
                                                                if (this._setCellID)
                                                                        cell.setAttribute("headers", arrHeaders[j]);
                                                                else
                                                                        cell.removeAttribute("headers", false);
                                                        }
                                                }
                                        }
                                }
                        }
                },

                set_tableToModify: function (value)
                {
                        this._table = value;
                },

                dispose: function ()
                {
                        this._clientParameters = null;
                        this._table = null
                        this._tableDocument = null;

                        this._headingRowsInput = null;
                        this._headingColumnsInput = null;
                        this._captionTextArea = null;
                        this._summaryTextArea = null;
                        this._setCellIDCheckBox = null;

                        this._alignmentSelector = null;

                        this._maxHeadRowsSpan = null;
                        this._maxHeadColsSpan = null;

                        Telerik.Web.UI.Widgets.AccessibleTable.callBaseMethod(this, "dispose");
                }
        }

        Telerik.Web.UI.Widgets.AccessibleTable.registerClass('Telerik.Web.UI.Widgets.AccessibleTable', Telerik.Web.UI.RadWebControl, Telerik.Web.IParameterConsumer);
</script>

<style type="text/css">
        .AccessibilityOptionsWrapper .reLabelCell
        {
                padding-bottom: 1px;
        }

        .AccessibilityOptionsWrapper .reControlCell
        {
                padding-bottom: 1px;
        }

        .AccessibilityOptionsWrapper fieldset
        {
                width: 688px;
                width: 690px\9;
        }
</style>
<table border="0" cellpadding="0" cellspacing="0" style="margin-left: 4px;" class="AccessibilityOptionsWrapper">
        <tr>
                <td>
                        <fieldset class="reTableWizardAccessible">
                                <legend><script type="text/javascript">document.write(localization["AccessibilityOptions"]);</script></legend>
                                <table cellpadding="0" cellspacing="0" class="reControlsLayout" style="height:auto;">
                                        <tr>
                                                <td class="reLabelCell">
                                                        <label class="reDialogLabel" for="headingRows">
                                                                <span style="text-align: right;"><script type="text/javascript">                                                                                                         document.write(localization["HeadingRows"]);</script></span>
                                                        </label>
                                                </td>
                                                <td class="reControlCell">
                                                        <input type="text" id="headingRows" />
                                                        <span id="maxHeadRows">
                                                                <!-- / -->
                                                        </span>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell">
                                                        <label class="reDialogLabel" for="headingColumns">
                                                                <span style="text-align: right;">

                                                                        <script type="text/javascript">
                                                                                document.write(localization["HeadingColumns"]);
                                                                        </script>

                                                                </span>
                                                        </label>
                                                </td>
                                                <td class="reControlCell">
                                                        <input type="text" id="headingColumns" class="s_input" />
                                                        <span id="maxHeadColumns"></span>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell">
                                                        <label class="reDialogLabel" for="CaptionText">
                                                                <span style="text-align: right;">

                                                                        <script type="text/javascript">
                                                                                document.write(localization["Caption"]);
                                                                        </script>

                                                                </span>
                                                        </label>
                                                </td>
                                                <td class="reControlCell">
                                                        <textarea id="CaptionText" rows="6" cols="10" style="overflow: auto; width: 540px;
                                                                height: 120px;"></textarea>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell">
                                                        <label class="reDialogLabel">
                                                                <span style="text-align: right;">

                                                                        <script type="text/javascript">
                                                                                document.write(localization["CaptionAlign"]);
                                                                        </script>

                                                                </span>
                                                        </label>
                                                </td>
                                                <td class="reControlCell">
                                                        <div class="reToolWrapper Default">
                                                <a id="alignmentSelector" title="AlignmentSelector" class="reTool reSplitButton" href="#"><span class="AlignmentSelector">&nbsp;</span><span class="split_arrow">&nbsp;</span></a>
                                        </div>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td class="reLabelCell">
                                                        <label for="accessibilitySummary" class="reDialogLabel">
                                                                <span style="text-align: right;">

                                                                        <script type="text/javascript">
                                                                                document.write(localization["Summary"]);
                                                                        </script>

                                                                </span>
                                                        </label>
                                                </td>
                                                <td class="reControlCell">
                                                        <textarea id="SummaryText" rows="6" cols="10" style="overflow: auto; width: 540px;
                                                                height: 120px;"></textarea>
                                                </td>
                                        </tr>
                                        <tr>
                                                <td colspan="2" class="reLabelCell" style="padding-left: 130px;">
                                                        <input type="checkbox" id="associateCellsWithHeaders" style="border: 0;" />
                                                        <label for="associateCellsWithHeaders">

                                                                <script type="text/javascript">
                                                                        document.write(localization["AssociateCellsWithHeaders"]);
                                                                </script>

                                                        </label>
                                                </td>
                                        </tr>
                                </table>
                        </fieldset>
                </td>
        </tr>
</table><input id="accessibilityPanel_ClientState" name="accessibilityPanel_ClientState" type="hidden" />
                                </div>

                        </div><input id="dialogMultiPage_ClientState" name="dialogMultiPage_ClientState" type="hidden" />
                </div>
                </td>
        </tr>
        <tr>
                <td class="reBottomcell">
                    <table cellpadding="0" cellspacing="0" class="reConfirmCancelButtonsTbl">
                <tr>
                    <td style="padding-right: 8px;">
                                    <button type="button" id="InsertButton">
                                                    <script type="text/javascript">
                                                    setInnerHtml("InsertButton", localization["OK"]);
                                                    </script>
                                            </button>
                                </td>
                                <td class="reRightMostCell">
                                    <button type="button" id="CancelButton">
                                                    <script type="text/javascript">
                                                    setInnerHtml("CancelButton", localization["Cancel"]);
                                                    </script>
                                            </button>
                                </td>
                            </tr>
                        </table>
                </td>
        </tr>
</table>
<!-- end of table wizard --><input id="dialogControl_ClientState" name="dialogControl_ClientState" type="hidden" />
        </div><input id="initializer_ClientState" name="initializer_ClientState" type="hidden" />
</div>

<script type="text/javascript">
//<![CDATA[
;(function() {
                        function loadHandler() {
                            var hf = $get('RadStyleSheetManager1_TSSM');
                            if (!hf._RSSM_init) { hf._RSSM_init = true; hf.value = ''; }
                            hf.value += ';Telerik.Web.UI, Version=2013.3.1015.45, Culture=neutral, PublicKeyToken=121fae78165ba3d4:en-US:7a1d9c2d-6cf2-464f-9ad3-e479c730ac61:e347b32f:a942ad92:eede8ae4:8a83f7a4:8cee9284:ed057d30:a3b7d93f:e59a902c:c8a024b';
                            Sys.Application.remove_load(loadHandler);
                        };
                        //Sys.Application.add_load(loadHandler);
                    })();Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.RadFormDecorator, {"_renderMode":2,"clientStateFieldID":"dialogsDecorator_ClientState","decoratedControls":65527,"enableRoundedCorners":false,"enabled":true,"skin":"Default"}, null, null, $get("dialogsDecorator"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.RadTabStrip, {"_selectedIndex":0,"_skin":"Default","clientStateFieldID":"TableWizardTab_ClientState","multiPageID":"dialogMultiPage","selectedIndexes":["0"],"tabData":[{"value":"Tab1HeaderText","_implPageViewID":"tableDesignRow"},{"value":"Tab2HeaderText","_implPageViewID":"tablePropertiesRow"},{"value":"Tab3HeaderText","_implPageViewID":"cellPropertiesRow"},{"value":"Tab4HeaderText","_implPageViewID":"accessibilityRow"}]}, null, null, $get("TableWizardTab"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxColumns_ClientState","name":"SpinBox","skin":"Default","visibleInput":false}, null, null, $get("SpinBoxColumns"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxColumnSpan_ClientState","name":"SpinBox","skin":"Default","visibleInput":false}, null, null, $get("SpinBoxColumnSpan"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxRows_ClientState","name":"SpinBox","skin":"Default","visibleInput":false}, null, null, $get("SpinBoxRows"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxRowSpan_ClientState","name":"SpinBox","skin":"Default","visibleInput":false}, null, null, $get("SpinBoxRowSpan"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Widgets.TableDesign, {"clientStateFieldID":"tableDesignPanel_ClientState"}, null, null, $get("tableDesignPanel"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxHeight_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("SpinBoxHeight"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxWidth_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("SpinBoxWidth"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Widgets.TableBorder, {"clientStateFieldID":"TableBorder_ClientState"}, null, null, $get("TableBorder"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxCellSpacing_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("SpinBoxCellSpacing"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxCellSPadding_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("SpinBoxCellSPadding"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.AlignmentSelector, {"addClickHandler":true,"clientStateFieldID":"AlignmentSelectorTable_ClientState","name":"AlignmentSelector","skin":"Default"}, null, null, $get("AlignmentSelectorTable"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.ColorPicker, {"addClickHandler":true,"clientStateFieldID":"ColorPicker_ClientState","name":"BackColor","skin":"Default"}, null, null, $get("ColorPicker"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorButton, {"addClickHandler":true,"clientStateFieldID":"StyleBuilder_ClientState","name":"StyleBuilder","skin":"Default"}, null, null, $get("StyleBuilder"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.ApplyClassDropDown, {"addClickHandler":true,"clientStateFieldID":"ClassSelector_ClientState","name":"ApplyClass","skin":"Default"}, null, null, $get("ClassSelector"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorButton, {"addClickHandler":true,"clientStateFieldID":"ImageCaller_CallerButton_ClientState","name":"ImageManager","skin":"Default"}, null, null, $get("ImageCaller_CallerButton"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.ImageDialogCaller, {"addClickHandler":true,"clientStateFieldID":"ImageCaller_ClientState","name":"ImageDialogCaller","skin":"Default"}, null, null, $get("ImageCaller"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Widgets.TableProperties, {"clientStateFieldID":"tablePropertiesPanel_ClientState"}, null, null, $get("tablePropertiesPanel"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxCellHeight_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("SpinBoxCellHeight"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"SpinBoxCellWidth_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("SpinBoxCellWidth"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.AlignmentSelector, {"addClickHandler":true,"clientStateFieldID":"alignmentSelectorCellContent_ClientState","name":"AlignmentSelector","skin":"Default"}, null, null, $get("alignmentSelectorCellContent"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.ColorPicker, {"addClickHandler":true,"clientStateFieldID":"ColorPickerCellBackground_ClientState","name":"BackColor","skin":"Default"}, null, null, $get("ColorPickerCellBackground"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorButton, {"addClickHandler":true,"clientStateFieldID":"CellStyleBuilder_ClientState","name":"StyleBuilder","skin":"Default"}, null, null, $get("CellStyleBuilder"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.ApplyClassDropDown, {"addClickHandler":true,"clientStateFieldID":"ClassSelectorCellCss_ClientState","name":"ApplyClass","skin":"Default"}, null, null, $get("ClassSelectorCellCss"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorButton, {"addClickHandler":true,"clientStateFieldID":"ImageCallerCellBackgroundImage_CallerButton_ClientState","name":"ImageManager","skin":"Default"}, null, null, $get("ImageCallerCellBackgroundImage_CallerButton"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.ImageDialogCaller, {"addClickHandler":true,"clientStateFieldID":"ImageCallerCellBackgroundImage_ClientState","name":"ImageDialogCaller","skin":"Default"}, null, null, $get("ImageCallerCellBackgroundImage"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Widgets.CellProperties, {"clientStateFieldID":"cellPropertiesPanel_ClientState"}, null, null, $get("cellPropertiesPanel"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.AlignmentSelector, {"addClickHandler":true,"clientStateFieldID":"alignmentSelector_ClientState","name":"AlignmentSelector","skin":"Default"}, null, null, $get("alignmentSelector"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Widgets.AccessibleTable, {"clientStateFieldID":"accessibilityPanel_ClientState"}, null, null, $get("accessibilityPanel"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.RadMultiPage, {"clientStateFieldID":"dialogMultiPage_ClientState","pageViewData":[{"id":"tableDesignRow"},{"id":"tablePropertiesRow"},{"id":"cellPropertiesRow"},{"id":"accessibilityRow"}],"selectedIndex":0}, null, null, $get("dialogMultiPage"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Widgets.TableWizard, {"clientStateFieldID":"dialogControl_ClientState"}, null, null, $get("dialogControl"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Dialogs.DialogInitializer, {"clientStateFieldID":"initializer_ClientState","parameterConsumers":["dialogControl"]}, null, null, $get("initializer"));
});
//]]>
</script>
</form></body></html>