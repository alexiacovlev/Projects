<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/tr/xhtml11/dtd/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" class="redImageProperties"><head>
<base target="_self" />
<title>
        Properties...
</title>
<link href="axd_dialog_imagemanager.skins.form.css" type="text/css" rel="stylesheet" />
</head>
<body><form method="post" action="dialog.html.ImageProperties.html" id="Form1">
<div class="aspNetHidden">
</div>

<script src="axd_dialog_forms.js" type="text/javascript"></script>
<script src="axd_dialog_imageproperties.js" type="text/javascript"></script>


<div class="aspNetHidden">

        <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="" />
</div><script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('RadScriptManager1', 'Form1', [], [], [], 90, '');
//]]>
</script>
<input type="hidden" name="dialogParametersHolder" id="dialogParametersHolder" /><div id="dialogsDecorator" class="RadFormDecorator" style="display:none;">
        <!-- 2013.3.1015.45 --><script type="text/javascript">
//<![CDATA[
if (typeof(WebForm_AutoFocus) != 'undefined')
{
        var old_WebForm_AutoFocus = WebForm_AutoFocus;
        WebForm_AutoFocus = function(arg)
        {
                Sys.Application.add_load(function()
                {
                        old_WebForm_AutoFocus(arg);
                        WebForm_AutoFocus = old_WebForm_AutoFocus;
                });
        }
}
if (typeof(Telerik) != 'undefined' && Type.isNamespace(Telerik.Web))
{
        if (Telerik.Web.UI.RadFormDecorator)
        {
                Telerik.Web.UI.RadFormDecorator.initializePage("dialogsDecorator", "", "Default", 65527);
        }
}
//]]>
</script><input id="dialogsDecorator_ClientState" name="dialogsDecorator_ClientState" type="hidden" />
</div><div id="initializer">
        <div id="dialogControl">
                <div id="resourcesSetImageProperties">
                        <script type="text/javascript">
//<![CDATA[
if (typeof(localization) == "undefined")
{
        var localization = {
                _fill : function(newStrings)
                {
                        for (var key in newStrings)
                        {
                                this[key] = newStrings[key];
                        }
                },
                setTitle : function(elementId, resourceKey) {
                        $get(elementId).title = this[resourceKey];
                }
        };
}
localization._fill({ActualSize:"Actual Size",Add:"Add",AddCustomColor:"Add Custom Color...",AddCustomTarget:"[add custom target...]",AllowedExtensions:"File extensions allowed",AllProperties:"All Properties...",ApplyClass:"Apply Class",Back:"Back",BackgroundColor:"Background Color",BackgroundImage:"Back Image",BestFit:"Best Fit",BorderColor:"Border Color",BorderWidth:"Border Width",Bottom:"Bottom",bytes:"bytes",Cancel:"Cancel",CellCss:"Cell CSS",ClassID:"Specify Class ID",ClassIDText:"Class ID",Clear:"Clear",ClearClass:"Clear Class",Client_AlertFile:"Please, provide file to upload!",ConfirmDelete:"Are you sure you want to delete the selected item?\r\nIt might still be in use. If deleted, some pages will not be displayed properly.\r\nPress \"OK\" to confirm deletion.",Close:"Close",ConstrainProportions:"Constrain proportions?",ControlButtons:"Control Buttons",Copy:"Copy",Create:"Create",CreateNewFolder:"Enter the new folder name",CreateThumbnail:"Create thumbnail",CssClass:"CSS Class",Decrease:"Decrease",Delete:"Delete",GridView:"Grid View",ThumbnailsView:"Thumbnails View",DimensionUnit:"Dimension unit",FileExists:"A file with a name same as the target already exists!",FileListSummary:"Table that lists the contents of the current directory",Forward:"Forward",GridPagerText:"{4} Page <strong>{0}</strong> of <strong>{1}</strong>. Items <strong>{2}</strong> to <strong>{3}</strong> of <strong>{5}</strong>",GridSortedAscToolTip:"Sort asc",GridSortedDescToolTip:"Sort desc",GridSortToolTip:"Click here to sort",Height:"Height",Id:"Id",ImageAltText:"Alt Text",ImageTitleText:"Title Text",ImageEditor:"Image Editor",ImageFieldSet:"Image Properties",Increase:"Increase",Insert:"Insert",InvalidCharactersInPath:"Invalid characters in folder name.",InvalidFileExtension:"The extension of the uploaded file is not valid. Please, provide a valid file!",InvalidFileSize:"The size of the uploaded file exceeds max size allowed",Kilobytes:"KB",Left:"Left",LookIn:"Look in",MaxFileSize:"Max file size allowed",Margin:"Margin",Megabytes:"MB",MessageCannotWriteToFolder:"Cannot write to the target folder!",MessageNoValidDimensions:"Please, provide valid image dimensions",MessageSourceNotLocal:"The specified for conversion image file resides on a different server!",Middle:"Middle",NameExists:"An object with the same name already exists in this directory!",NewFolder:"New Folder",NewImageName:"New image name",No:"No",None:"None",NonExistingFolder:"You are trying to navigate to a non-existing folder or you do not have proper permissions to view this folder. Please, contact the administrator.",NoPermissionsToCreateFolder:"The selected folder could not be created because the application did not have enough permissions. Please, contact the administrator.",NoPermissionsToDeleteFile:"The selected file could not be deleted because the application did not have enough permissions. Please, contact the administrator.",NoPermissionsToDeleteFolder:"The selected folder could not be deleted because the application did not have enough permissions. Please, contact the administrator.",NoUploadedFile:"Please, select a file to upload!",OK:"OK",Open:"Open",OverwriteExisting:"Overwrite if file exists?",Percent:"Percent",Pixel:"Pixel",Preview:"Preview",Properties:"Properties",PropertiesPanel:"Properties panel",Refresh:"Refresh",Remove:"Remove",Rename:"Rename",Right:"Right",Select:"Select",SelectFile:"Select file",SortByExt:"Ext",SortByExtTitle:"Sort by Extension",SortByFilename:"Filename",SortByFilenameTitle:"Sort by Filename",SortBySize:"Size",SortBySizeTitle:"Sort by Size",StyleBuilder:"Style Builder",TableCss:"Table CSS",Target:"Target",TargetBlank:"New Window",TargetMedia:"Media Pane",TargetParent:"Parent Window",TargetSearch:"Search Pane",TargetSelf:"Same Window",TargetTop:"Browser Window",Top:"Top",Up:"Up",Upload:"Upload",UploadFile:"Upload",Uploading:"Uploading...",Url:"URL",Width:"Width",Yes:"Yes",ZoomIn:"Zoom In",ZoomOut:"Zoom Out",Black:"Black",Blue:"Blue",Green:"Green",NoColor:"No Color",Orange:"Orange",Red:"Red",White:"White",Yellow:"Yellow",CustomTargets:"Custom Targets",PresetTargets:"Preset Targets",Paste:"Paste",UseControlVMessage:"Please, use CTRL + V to paste below the content you would like to be cleaned",PasteHtmlMessage:"Please, insert the Html content, which you want to paste",PasteMarkdownMessage:"Please, insert the Markdown content, which you want to paste"});
localization._fill({Constrain:"Constrain",HorizontalSpacing:"Horizontal Spacing",ImageAlignment:"Image Alignment",ImageSrc:"Image Src",LinkToOriginal:"Link to original",LongDescription:"Long Description",OpenInNewWindow:"Open in a new window",Title:"Image Properties",VerticalSpacing:"Vertical Spacing"});
//]]>
</script>
<input id="resourcesSetImageProperties_ClientState" name="resourcesSetImageProperties_ClientState" type="hidden" />
                </div>
<script type="text/javascript">
        //<![CDATA[
        Type.registerNamespace("Telerik.Web.UI.Widgets");

        Telerik.Web.UI.Widgets.ImageProperties = function (element) {
                Telerik.Web.UI.Widgets.ImageProperties.initializeBase(this, [element]);
                this._clientParameters = null;
                this._allowedASCII = new Array(8, 16, 35, 36, 37, 39, 45, 46);
                this._constrainDimentions = false;
                this._ratio = 0;

                //this is used when we try to load an image before the dialog is initialized
                this._initialImage = null;
        }

        Telerik.Web.UI.Widgets.ImageProperties.prototype = {
                initialize: function () {
                        Telerik.Web.UI.Widgets.ImageProperties.callBaseMethod(this, 'initialize');
                        this._setupChildren();
                        this.showThumbRow(false);
                        this._originalImage = null;
                        this._initialImage = null;
                        this._clientInitPassed = false;
                },

                dispose: function () {
                        this._disposeChildren();
                        Telerik.Web.UI.Widgets.ImageProperties.callBaseMethod(this, 'dispose');
                },

                clientInit: function (clientParameters) {
                        this._colors = clientParameters.Colors != null ? clientParameters.Colors : [];
                        this._editor = clientParameters.editor;
                        this._cssClasses = clientParameters.CssClasses != null ? clientParameters.CssClasses : [];
                        this._clientInitPassed = true;

                        this._initDropDowns();

                        if (this._imageSrc) {
                                this._imageSrc.set_editor(this._editor);
                        }
                        this._cleanImageAttributes();

                        if (!clientParameters.get_value) {
                                return;
                        }
                        var originalImage = null;

                        if (this._initialImage != null) {
                                originalImage = this._initialImage;
                                this._initialImage = null;
                        }
                        else {
                                try {
                                        //prevent"Can't execude code from a freed script"
                                        originalImage = clientParameters.get_value();
                                } catch (ex) { };
                        }

                        if (originalImage) {
                                this.loadImageProperties(originalImage);
                        }
                },

                _initDropDowns: function () {
                        //Set colors to the color picker
                        this._colorPicker.set_items(this._colors);
                        this._colorPicker.set_addCustomColorText(localization["AddCustomColor"]);

                        //Set css class names to the css dropdown and selects the one of the selected image if existing
                        //localization
                        this._imageCssClassList.set_showText(true);
                        this._imageCssClassList.set_clearclasstext(localization["ClearClass"]);
                        this._imageCssClassList.set_text(localization["ApplyClass"]);
                        this._imageCssClassList.set_value(localization["ApplyClass"]);
                        this._imageCssClassList.set_items(this._cssClasses);
                },

                _cleanImageAttributes: function () {
                        this._originalImage = null;
                        this._imageWidth.value = "";
                        this._imageHeight.value = "";
                        if (this._imageSrc) this._imageSrc.set_value("");
                        this._imageSrcValue = null;
                        this._imageAlt.value = "";
                        this._imageTitle.value = "";
                        this._imageLongDecs.value = "";
                        this._imageAlignment.updateValue("", null);
                        this._marginLeftSpinBox.set_value("");
                        this._marginTopSpinBox.set_value("");
                        this._marginRightSpinBox.set_value("");
                        this._marginBottomSpinBox.set_value("");
                        this._borderWidthSpinBox.set_value("");
                        this._colorPicker.set_color("");
                        this._imageCssClassList.updateValue("");
                },

                loadImageProperties: function (originalImage) {
                        if (!this._clientInitPassed) {
                                //wait for clientInit before loading the image
                                this._initialImage = originalImage;
                                return;
                        }

                        this._originalImage = originalImage;
                        var currentImage = this._originalImage.cloneNode(true);

                        var widthValue = this._getOriginalWidth(this._originalImage);
                        this._imageWidth.value = (widthValue.indexOf("px") != -1) ? parseInt(widthValue) : widthValue; //strp px from the width value
                        var heightValue = this._getOriginalHeight(this._originalImage);
                        this._imageHeight.value = (heightValue.indexOf("px") != -1) ? parseInt(heightValue) : heightValue; //strp px from the width value
                        //NEW: Support for %
                        this._ratio = this._originalImage.offsetWidth / this._originalImage.offsetHeight; //parseInt(this._imageWidth.value) / parseInt(this._imageHeight.value);
                        this._customSize = { width: this._getCustomWidth(this._originalImage), height: this._getCustomHeight(this._originalImage) };

                        var currentSrc = currentImage.getAttribute("src", 2);
                        if (this._imageSrc) {
                                this._imageSrc.set_value(currentSrc);
                                this._imageSrcValue = null;
                        }
                        else {
                                this._imageSrcValue = currentSrc;
                        }

                        this._imageAlt.value = this._getAttribute(currentImage, "alt");
                        this._imageTitle.value = this._getAttribute(currentImage, "title");
                        this._imageLongDecs.value = this._getAttribute(currentImage, "longDesc");

                        //TODO: This should be moved to a separate method - perhaps even a shared method because similar code is used in an editor filter and in the nodeinspectormodule
                        var floatJSProperty = ($telerik.isIE) ? "styleFloat" : "cssFloat";
                        var styleFloat = (typeof (currentImage.style[floatJSProperty]) == "undefined") ? "" : currentImage.style[floatJSProperty];
                        var verticalAlign = (typeof (currentImage.style["verticalAlign"]) == "undefined") ? "" : currentImage.style["verticalAlign"];
                        var alignValue = "";

                        if (verticalAlign == "" && styleFloat != "") {
                                switch (styleFloat) {
                                        case "left":
                                                alignValue = "left";
                                                break;
                                        case "right":
                                                alignValue = "right";
                                                break;
                                }
                        }
                        if (styleFloat == "") {
                                switch (verticalAlign) {
                                        case "top":
                                                alignValue = "top";
                                                break;
                                        case "middle":
                                                alignValue = "absmiddle";
                                                break;
                                        case "text-bottom":
                                                alignValue = "bottom";
                                                break;
                                }
                        }

                        this._imageAlignment.updateValue(alignValue, null);

                        if (currentImage.style.marginTop)
                                this._marginTopSpinBox.set_value(currentImage.style.marginTop.replace("px", ""));
                        else
                                this._marginTopSpinBox.set_value("");

                        if (currentImage.style.marginRight)
                                this._marginRightSpinBox.set_value(currentImage.style.marginRight.replace("px", ""));
                        else
                                this._marginRightSpinBox.set_value("");

                        if (currentImage.style.marginBottom)
                                this._marginBottomSpinBox.set_value(currentImage.style.marginBottom.replace("px", ""));
                        else
                                this._marginBottomSpinBox.set_value("");

                        if (currentImage.style.marginLeft)
                                this._marginLeftSpinBox.set_value(currentImage.style.marginLeft.replace("px", ""));
                        else
                                this._marginLeftSpinBox.set_value("");

                        var borderValue = parseInt(currentImage.style.borderWidth);
                        if (isNaN(borderValue)) borderValue = "";
                        if (!borderValue) {
                                var borderAttributeValue = currentImage.getAttribute("border");
                                if (borderAttributeValue) {
                                        borderValue = borderAttributeValue;
                                        currentImage.style.borderWidth = borderAttributeValue + "px";
                                        currentImage.style.borderStyle = "solid";
                                }
                        }
                        currentImage.removeAttribute("border");
                        this._borderWidthSpinBox.set_value(borderValue);

                        var borderColor = currentImage.style.borderColor.toUpperCase();
                        this._colorPicker.set_color(borderColor);

                        if (currentImage.className != null && currentImage.className != "") {
                                this._imageCssClassList.updateValue(currentImage.className);
                        }
                },

                showThumbRow: function (toShow) {
                        if (this._thumbRow) {
                                if (toShow == false) {
                                        this._thumbRow.style.display = "none";
                                }
                                else {
                                        this._thumbRow.style.display = "";
                                        if (this._chkThumb) this._chkThumb.checked = false;
                                        var chkNewWindow = $get("chkNewWindow");
                                        if (chkNewWindow) chkNewWindow.disabled = true;
                                }
                        }
                },

                isThumbLinkChecked: function () {
                        return this._thumbRow && this._chkThumb && this._chkThumb.checked;
                },

                isThumbNewWindowChecked: function () {
                        if (!this._thumbRow) return false;
                        var chkNewWindow = $get("chkNewWindow");
                        return chkNewWindow && chkNewWindow.checked;
                },

                _chkThumbClickHandler: function () {
                        if (this._thumbRow && this._chkThumb) {
                                var chkNewWindow = $get("chkNewWindow");
                                chkNewWindow.disabled = !this._chkThumb.checked;
                        }
                },

                _getOriginalWidth: function (currentImage) {
                        if (!currentImage) return "";

                        var width = this._getCustomWidth(currentImage) || currentImage.getAttribute("width") || currentImage.width || currentImage.offsetWidth || "";

                        return width == null ? "" : width + "";
                },
                _getCustomWidth: function (currentImage) {
                        if (!currentImage || !currentImage.style) return "";

                        return currentImage.style.width || (!$telerik.isIE ? currentImage.getAttribute("width") : "") || "";
                },

                _getOriginalHeight: function (currentImage) {
                        if (!currentImage) return "";

                        var height = this._getCustomHeight(currentImage) || currentImage.getAttribute("height") || currentImage.height || currentImage.offsetHeight || "";

                        return height == null ? "" : height + "";
                },
                _getCustomHeight: function (currentImage) {
                        if (!currentImage || !currentImage.style) return "";

                        return currentImage.style.height || (!$telerik.isIE ? currentImage.getAttribute("height") : "") || "";
                },

                _getImageOriginalSize: function (img) //NEW gets original image size
                {
                        var tempImg = new Image();
                        tempImg.src = img.getAttribute ? img.getAttribute("src") : img.src;
                        var size = {
                                width: tempImg.width,
                                height: tempImg.height
                        };
                        return size;
                },

                _clearImgeDimensions: function (image) //NEW clear image's style size properties if they concur with the original image size.
                {
                        var imageOriginalSize = this._getImageOriginalSize(image);

                        var imageOriginalWidth = imageOriginalSize.width;
                        var imageCurrentWidth = this._getOriginalWidth(image);
                        if (imageCurrentWidth.indexOf("px") != -1) imageCurrentWidth = parseInt(imageCurrentWidth); //remove the px unit

                        var imageOriginalHeight = imageOriginalSize.height;
                        var imageCurrentHeight = this._getOriginalHeight(image);
                        if (imageCurrentHeight.indexOf("px") != -1) imageCurrentHeight = parseInt(imageCurrentHeight); //remove the px unit

                        if (!this._customSize.width && (imageOriginalWidth == imageCurrentWidth && (imageCurrentHeight == 0 || imageOriginalHeight == imageCurrentHeight)))
                                image.style["width"] = "";
                        if (!this._customSize.height && (imageOriginalHeight == imageCurrentHeight && (imageCurrentWidth == 0 || imageOriginalWidth == imageCurrentWidth)))
                                image.style["height"] = "";
                },

                getModifiedImage: function () {
                        if (this._originalImage == null) {
                                return null;
                        }

                        var resultImage = this._originalImage.cloneNode(true);

                        //Make sure the image src attribute is set before the widht/height, as setting the src causes IE to add width and height attributes expicitly
                        var srcValue = this._imageSrcValue ? this._imageSrcValue : this._imageSrc.get_value();
                        this._setAttribute(resultImage, "src", srcValue);

                        this._setDimensionAttribute(resultImage, "width", this._imageWidth.value);
                        this._setDimensionAttribute(resultImage, "height", this._imageHeight.value);
                        this._clearImgeDimensions(resultImage); //check if the current dimensions coincide with the original image size and remove the css width properties

                        this._setAttribute(resultImage, "alt", this._imageAlt.value);
                        this._setAttribute(resultImage, "title", this._imageTitle.value);
                        this._setAttribute(resultImage, "longDesc", this._imageLongDecs.value);

                        //image align
                        this._setImgAlignStyle(resultImage, this._imageAlignment.getAlign());

                        var marginTop = parseInt(this._marginTopSpinBox.get_value());
                        resultImage.style.marginTop = (!isNaN(marginTop)) ? marginTop + "px" : "";

                        var marginRight = parseInt(this._marginRightSpinBox.get_value());
                        resultImage.style.marginRight = (!isNaN(marginRight)) ? marginRight + "px" : "";

                        var marginBottom = parseInt(this._marginBottomSpinBox.get_value());
                        resultImage.style.marginBottom = (!isNaN(marginBottom)) ? marginBottom + "px" : "";

                        var marginLeft = parseInt(this._marginLeftSpinBox.get_value());
                        resultImage.style.marginLeft = (!isNaN(marginLeft)) ? marginLeft + "px" : "";

                        var borderSize = parseInt(this._borderWidthSpinBox.get_value());
                        if (!isNaN(borderSize) && borderSize >= 0) {
                                resultImage.style.borderWidth = borderSize + "px";
                                resultImage.style.borderStyle = "solid";
                        }
                        else {
                                resultImage.style.borderWidth = "";
                                resultImage.style.borderStyle = "";
                        }
                        resultImage.removeAttribute("border");

                        if (this._colorPicker.get_color()) {
                                resultImage.style.borderColor = this._colorPicker.get_color();
                        }

                        this._setClass(resultImage, this._imageCssClassList);
                        return resultImage;
                },

                _setImgAlignStyle: function (img, align) {
                        var floatJSProperty = ($telerik.isIE) ? "styleFloat" : "cssFloat";
                        switch (align) {
                                case "left":
                                        img.style[floatJSProperty] = "left";
                                        img.style["verticalAlign"] = "";
                                        break;
                                case "right":
                                        img.style[floatJSProperty] = "right";
                                        img.style["verticalAlign"] = "";
                                        break;
                                case "top":
                                        img.style[floatJSProperty] = "";
                                        img.style["verticalAlign"] = "top";
                                        break;
                                case "bottom":
                                        img.style[floatJSProperty] = "";
                                        img.style["verticalAlign"] = "text-bottom";
                                        break;
                                case "absmiddle":
                                        img.style[floatJSProperty] = "";
                                        img.style["verticalAlign"] = "middle";
                                        break;
                                default:
                                        img.style[floatJSProperty] = "";
                                        img.style["verticalAlign"] = "";
                                        break;
                        }
                        img.removeAttribute("align");
                },

                _getAttribute: function (image, attributeName) {
                        var attributeValue = "";
                        if (image.getAttribute(attributeName)) {
                                attributeValue = image.getAttribute(attributeName);
                        }
                        return attributeValue;
                },

                _setAttribute: function (image, attributeName, attributeValue) {
                        if (attributeValue.trim()) {
                                image.setAttribute(attributeName, attributeValue);
                        }
                        else {
                                image.removeAttribute(attributeName, false);
                        }
                },

                _setClass: function (element, cssClassHolder) {
                        if (cssClassHolder.get_value() == "") {
                                element.removeAttribute("className");
                        }
                        else {
                                element.className = cssClassHolder.get_value();
                        }
                },

                _setupChildren: function () {
                        this._imageWidth = $get("ImageWidth");
                        this._imageHeight = $get("ImageHeight");
                        this._constrainButton = $get("ConstrainButton");
                        this._colorPicker = $find("BorderColor");
                        this._imageAlignment = $find("ImageAlignment");
                        this._imageAlignment.setTagName("IMG");

                        this._imageAlt = $get("ImageAlt");
                        this._imageTitle = $get("ImageTitle");
                        this._imageLongDecs = $get("ImageLongDesc");
                        this._imageSrc = $find("ImageSrc");
                        this._marginTopSpinBox = $find("marginTop");
                        this._marginRightSpinBox = $find("marginRight");
                        this._marginBottomSpinBox = $find("marginBottom");
                        this._marginLeftSpinBox = $find("marginLeft");
                        this._borderWidthSpinBox = $find("ImageBorderWidth");
                        this._imageCssClassList = $find("ImageCssClass");
                        this._insertButton = $get("IPInsertButton");
                        if (this._insertButton) this._insertButton.title = localization["OK"];
                        this._cancelButton = $get("IPCancelButton");
                        if (this._cancelButton) this._cancelButton.title = localization["Cancel"];
                        this._thumbRow = $get("thumbRow");
                        if (this._thumbRow) {
                                this._chkThumb = $get("chkThumb");
                                if (this._chkThumb) {
                                        $addHandlers(this._chkThumb, { "click": this._chkThumbClickHandler }, this);
                                }
                        }

                        this._initializeChildEvents();
                },

                _disposeChildren: function () {
                        if (this._imageWidth) $clearHandlers(this._imageWidth);
                        this._imageWidth = null;
                        if (this._imageHeight) $clearHandlers(this._imageHeight);
                        this._imageHeight = null;
                        if (this._constrainButton) $clearHandlers(this._constrainButton);
                        this._constrainButton = null;
                        if (this._chkThumb) $clearHandlers(this._chkThumb);
                        this._chkThumb = null;
                        if (this._insertButton) $clearHandlers(this._insertButton);
                        this._insertButton = null;
                        if (this._cancelButton) $clearHandlers(this._cancelButton);
                        this._cancelButton = null;
                        this._thumbRow = null;
                },

                _initializeChildEvents: function () {
                        $addHandlers(this._imageWidth, { "keyup": this._validateDimensionByWidth }, this);
                        $addHandlers(this._imageWidth, { "keydown": this._validateNumber }, this);
                        $addHandlers(this._imageHeight, { "keyup": this._validateDimensionByHeight }, this);
                        $addHandlers(this._imageHeight, { "keydown": this._validateNumber }, this);
                        $addHandlers(this._constrainButton, { "click": this._constrainClickHandler }, this);
                        if (this._insertButton) $addHandlers(this._insertButton, { "click": this._insertClickHandler }, this);
                        if (this._cancelButton) $addHandlers(this._cancelButton, { "click": this._cancelClickHandler }, this);
                        if (this._imageSrc) {
                                this._imageSrc.add_valueSelected(Function.createDelegate(this, this._imageSrcValueSelected));
                        }
                },

                _imageSrcValueSelected: function (sender, args) {
                        var editor = this._editor;
                        var doc;
                        if (editor && editor.get_document()) {
                                doc = editor.get_document();
                        }
                        else {
                                doc = document;
                        }
                        var img = doc.createElement("img");
                        img.setAttribute("src", sender.get_value());
                        this.loadImageProperties(img);

                },

                _setDimensionAttribute: function (image, attributeName, size) {
                        image.removeAttribute(attributeName);
                        var bRamoveStyleProperty = false;
                        if (!size) {
                                //remove style property if size is empty
                                if (image.style.removeAttribute) image.style.removeAttribute(attributeName, false);
                                else image.style[attributeName] = "";
                        }
                        else {
                                //NEW: Provide support for % as well, not just px
                                var unit = $telerik.parseUnit(size);
                                image.style[attributeName] = unit.size + unit.type;
                        }
                },

                _validateDimensionByWidth: function (e) {
                        this._validateDimension(e, "width");
                },

                _validateDimensionByHeight: function (e) {
                        this._validateDimension(e, "height");
                },

                _constrainClickHandler: function (e) {
                        this._constrainDimentions = !this._constrainDimentions;

                        if (this._constrainDimentions) {
                                //Update the readings on the gauges
                                //this._updateConstraintGauges(); there is no need to update the heiht on click of the this._constrainButton
                                Sys.UI.DomElement.addCssClass(this._constrainButton.parentNode, "redConstrainToggle");
                        }
                        else {
                                Sys.UI.DomElement.removeCssClass(this._constrainButton.parentNode, "redConstrainToggle");
                        }

                        //Cancel the postback that the button causes in FF
                        return $telerik.cancelRawEvent(e);
                },

                _updateConstraintGauges: function (attributeName) {
                        //If no attributeName is specified, the "width" is assumed
                        var useWidth = (attributeName != "height");

                        var dependantControl = null;
                        var rulingControl = null;
                        var ratio = 0;

                        if (useWidth) {
                                dependantControl = this._imageHeight;
                                rulingControl = this._imageWidth;
                                ratio = 1 / this._ratio;
                        }
                        else {
                                dependantControl = this._imageWidth;
                                rulingControl = this._imageHeight;
                                ratio = this._ratio;
                        }
                        var rulingControlValue = rulingControl.value;
                        var newValue = "";
                        if (rulingControlValue) {
                                //Support %, not just px
                                var rulingUnit = $telerik.parseUnit(rulingControlValue);
                                var size = rulingUnit.size;

                                //Set the value
                                newValue = Math.ceil(size * ratio);
                                var rulingUnitType = rulingUnit.type;
                                if (rulingUnitType != "px") newValue += rulingUnitType;
                        }
                        dependantControl.value = newValue;
                },

                _validateDimension: function (e, attributeName) {
                        if (!this._validateNumber(e))
                                return false;

                        if (this._constrainDimentions)
                                this._updateConstraintGauges(attributeName);

                        return true;
                },

                _validateNumber: function (e) {
                        if (window.event != null) e = window.event;

                        if (((e.keyCode >= 48) && (e.keyCode <= 57)) ||
                                ((e.keyCode >= 96) && (e.keyCode <= 105)) ||
                                (Array.contains(this._allowedASCII, e.keyCode))) {
                                return true;
                        }
                        else {
                                return $telerik.cancelRawEvent(e);
                        }
                },

                _insertClickHandler: function (e) {
                        var image = this.getModifiedImage();
                        if (image) {
                                var arg = new Telerik.Web.UI.EditorCommandEventArgs("SetImageProperies", null, image)
                                Telerik.Web.UI.Dialogs.CommonDialogScript.get_windowReference().close(arg);
                        }
                        else $telerik.cancelRawEvent(e); //cancel event if there is no image to return
                },

                _cancelClickHandler: function (e) {
                        Telerik.Web.UI.Dialogs.CommonDialogScript.get_windowReference().close();
                },

                get_imageWidth: function () {
                        return this._imageWidth;
                },

                get_imageHeight: function () {
                        return this._imageHeight;
                },

                get_ratio: function () {
                        return this._ratio;
                },

                set_ratio: function (value) {
                        this._ratio = value;
                }
        }

        Telerik.Web.UI.Widgets.ImageProperties.registerClass('Telerik.Web.UI.Widgets.ImageProperties', Telerik.Web.UI.RadWebControl, Telerik.Web.IParameterConsumer);
        //]]>
</script>
<style type="text/css">
        @media screen and (-webkit-min-device-pixel-ratio:0) {
                .reControlsLayout .reControlCell {
                        padding: 2px 3px;
                }
        }

        .reImgAlignWrapper {
                position: absolute;
                top: 0;
                right: -35px;
        }

        .RadForm_MetroTouch .reImgAlignWrapper,
        .RadForm_BlackMetroTouch .reImgAlignWrapper {
                right: -60px;
        }
</style>
<div class="redWrapper">
        <div class="redSection redSectionTop">
                <div class="redRow">
                        <span class="redLabel">
                                        <script type="text/javascript">
                                                document.write(localization["ImageSrc"]);
                                        </script>
                        </span>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default" id="ImageSrc">
                        <table class="reImageDialogCaller">
                                <tbody>
                                        <tr>
                                                <td><input type="text" /></td><td><div class="reToolWrapper Default">
                                                        <a id="ImageSrc_CallerButton" title="Image Manager" class="reTool" href="#"><span class="ImageManager">&nbsp;</span></a>
                                                </div></td>
                                        </tr>
                                </tbody>
                        </table>
                </div>
                        </div>
                </div>

                <div class="redRow">
                        <div class="redConstrainWrapper">
                                <label class="redLabel" for="ImageWidth">
                                        <script type="text/javascript">document.write(localization["Width"]);</script>
                                </label>
                                <input type="text" id="ImageWidth" /> <span class="redDimensionPixels">px</span>

                                <button id="ConstrainButton" class="redConstrainButton">&nbsp;</button>

                                <label class="redLabel redSecondLabel" for="ImageHeight">
                                        <script type="text/javascript">document.write(localization["Height"]);</script>
                                </label>
                                <input type="text" id="ImageHeight" /> <span class="redDimensionPixels">px</span>
                        </div>
                </div>

                <div class="redRow">
                        <span class="redLabel">
                                <script type="text/javascript">
                                                document.write(localization["ImageAlignment"]);
                                        </script>
                        </span>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default">
                        <a id="ImageAlignment" title="AlignmentSelector" class="reTool reSplitButton" href="#"><span class="AlignmentSelector">&nbsp;</span><span class="split_arrow">&nbsp;</span></a>
                </div>
                        </div>
                </div>

                <div class="redRow">
                        <span class="redLabel">
                                <script type="text/javascript">
                                        document.write(localization["BorderColor"]);
                                </script>
                        </span>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default">
                        <a id="BorderColor" title="BackColor" class="reTool reSplitButton" href="#"><span class="BackColor">&nbsp;</span><span class="split_arrow">&nbsp;</span></a>
                </div>
                        </div>

                        <span class="redLabel redSecondLabelAfterTool">
                                <script type="text/javascript">
                                        document.write(localization["BorderWidth"]);
                                </script>
                        </span>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default" id="ImageBorderWidth">

                </div>
                        </div>
                        <span class="redDimensionPixels">px</span>
                </div>

                <div class="redRow">
                        <span class="redLabel">
                                <script type="text/javascript">
                                        document.write(localization["Top"]);
                                </script>
                        </span>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default" id="marginTop">

                </div>
                        </div>
                         <span class="redDimensionPixels">px</span>
                        <span class="redLabel redSecondLabel">
                                <script type="text/javascript">
                                        document.write(localization["Bottom"]);
                                </script>
                        </span>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default" id="marginBottom">

                </div>
                        </div>
                        <span class="redDimensionPixels">px</span>
                </div>

                <div class="redRow">
                        <span class="redLabel">
                                <script type="text/javascript">
                                        document.write(localization["Right"]);
                                </script>
                        </span>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default" id="marginRight">

                </div>
                        </div>
                        <span class="redDimensionPixels">px</span>
                        <span class="redLabel redSecondLabel">
                                <script type="text/javascript">
                                        document.write(localization["Left"]);
                                </script>
                        </span>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default" id="marginLeft">

                </div>
                        </div>
                        <span class="redDimensionPixels">px</span>
                </div>

                <div class="redRow">
                        <label class="redLabel" for="ImageAlt">
                                <script type="text/javascript">
                                        document.write(localization["ImageAltText"]);
                                </script>
                        </label>
                        <input type="text" id="ImageAlt" />
                </div>
                <div class="redRow">
                        <label class="redLabel" for="ImageTitle">
                                <script type="text/javascript">
                                        document.write(localization["ImageTitleText"]);
                                </script>
                        </label>
                        <input type="text" id="ImageTitle" />
                </div>

                <div class="redRow">
                        <label class="redLabel" for="ImageLongDesc">
                                <script type="text/javascript">
                                        document.write(localization["LongDescription"]);
                                </script>
                        </label>
                        <input type="text" id="ImageLongDesc" />
                </div>

                <div class="redRow">
                        <label class="redLabel" for="">
                                <script type="text/javascript">
                                        document.write(localization["CssClass"]);
                                </script>
                        </label>
                        <div class="redInlineBlock redMiddle">
                                <div class="reToolWrapper Default">
                        <a id="ImageCssClass" title="ApplyClass" class="reDropdown" href="#"><span class="ApplyClass" style="width:80px;">ApplyClass</span></a>
                </div>
                        </div>
                </div>




        </div>

        <div id="controlButtonsRow" class="redActionButtonsWrapper">
                <button type="button" id="IPInsertButton">
                        <script type="text/javascript">
                                setInnerHtml("IPInsertButton", localization["OK"]);
                        </script>
                </button>
                <button type="button" id="IPCancelButton">
                        <script type="text/javascript">
                                setInnerHtml("IPCancelButton", localization["Cancel"]);
                        </script>
                </button>
        </div>
</div><input id="dialogControl_ClientState" name="dialogControl_ClientState" type="hidden" />
        </div><input id="initializer_ClientState" name="initializer_ClientState" type="hidden" />
</div>

<script type="text/javascript">
//<![CDATA[
;(function() {
                        function loadHandler() {
                            var hf = $get('RadStyleSheetManager1_TSSM');
                            if (!hf._RSSM_init) { hf._RSSM_init = true; hf.value = ''; }
                            hf.value += ';Telerik.Web.UI, Version=2013.3.1015.45, Culture=neutral, PublicKeyToken=121fae78165ba3d4:en-US:7a1d9c2d-6cf2-464f-9ad3-e479c730ac61:e347b32f:a942ad92:eede8ae4:8a83f7a4:e59a902c:c8a024b';
                            Sys.Application.remove_load(loadHandler);

                        };
                        //Sys.Application.add_load(loadHandler);
                    })();Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.RadFormDecorator, {"_renderMode":2,"clientStateFieldID":"dialogsDecorator_ClientState","decoratedControls":65527,"enableRoundedCorners":false,"enabled":true,"skin":"Default"}, null, null, $get("dialogsDecorator"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorButton, {"addClickHandler":true,"clientStateFieldID":"ImageSrc_CallerButton_ClientState","name":"ImageManager","skin":"Default"}, null, null, $get("ImageSrc_CallerButton"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.ImageDialogCaller, {"addClickHandler":true,"clientStateFieldID":"ImageSrc_ClientState","name":"ImageDialogCaller","skin":"Default"}, null, null, $get("ImageSrc"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.AlignmentSelector, {"addClickHandler":true,"clientStateFieldID":"ImageAlignment_ClientState","name":"AlignmentSelector","skin":"Default"}, null, null, $get("ImageAlignment"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.ColorPicker, {"addClickHandler":true,"clientStateFieldID":"BorderColor_ClientState","name":"BackColor","skin":"Default"}, null, null, $get("BorderColor"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"ImageBorderWidth_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("ImageBorderWidth"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"marginTop_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("marginTop"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"marginBottom_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("marginBottom"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"marginRight_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("marginRight"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.EditorSpinBox, {"addClickHandler":true,"clientStateFieldID":"marginLeft_ClientState","name":"SpinBox","skin":"Default"}, null, null, $get("marginLeft"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Editor.ApplyClassDropDown, {"addClickHandler":true,"clientStateFieldID":"ImageCssClass_ClientState","name":"ApplyClass","skin":"Default"}, null, null, $get("ImageCssClass"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Widgets.ImageProperties, {"clientStateFieldID":"dialogControl_ClientState"}, null, null, $get("dialogControl"));
});
Sys.Application.add_init(function() {
    $create(Telerik.Web.UI.Dialogs.DialogInitializer, {"clientStateFieldID":"initializer_ClientState","parameterConsumers":["dialogControl"]}, null, null, $get("initializer"));
});
//]]>
</script>
</form></body></html>