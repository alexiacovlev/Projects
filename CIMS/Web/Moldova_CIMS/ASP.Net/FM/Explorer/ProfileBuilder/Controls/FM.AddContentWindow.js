FM.AddContentWindow=function(c,g){this.designer=c;this.mode=g;this._window=AX.Window.createPopupWindow("Choose Folder Content",470,470,true,true);var a=this._window.$content;a.append("<style>div.fm-addcontent {position:absolute;top:0;left:0;right:0;bottom:30px;background-color:#FFF;border:solid 1px #787878;}div.fm-addcontent a { padding:6px;width:350px;height:50px;display:block;border-radius:3px;-webkit-border-radius:3px; moz-border-radius:3px;cursor:pointer;}div.fm-addcontent a:hover { background-color:#63a5fe;box-shadow: 2px 2px 4px #000;-webkit-box-shadow: 2px 2px 4px #000;-moz-box-shadow: 2px 2px 4px #000;} }div.fm-addcontent a img {width:48px;height:48px; }div.fm-addcontent a i { position:relative;top:-18px;left:10px;line-height:20px; font-size:10pt;}div.fm-addcontent-list {position:absolute;top:0;left:0;right:0;bottom:30px;background-color:#FFF;border:solid 1px #787878;overflow-y:auto}div.fm-addcontent-list a { padding:7px 3px 4px 6px;width:330px;height:20px;display:block;cursor:pointer;font-size:10pt;border-radius:3px;-webkit-border-radius:3px;}div.fm-addcontent-list a:hover { background-color:#63a5fe;box-shadow: 2px 2px 4px #000;-webkit-box-shadow: 2px 2px 4px #000;-moz-box-shadow: 2px 2px 4px #000;color:white;} }</style>");this.panel=$("<div class='fm-addcontent'></div>");a.append(this.panel);var f="/ASP.Net/FM/Explorer/Images/48/";var d="<div style='margin:20px 0 0 50px;'><a cmd='GRID'><img src='"+f+"48_grid.png'/><i>Grid (list of data records)</i></a><a cmd='FORM'><img src='"+f+"48_form.png'/><i>Form (data entry)</i></a><a cmd='WORKFLOW'><img src='"+f+"48_workflow.png'/><i>Workflow (step-by-step data entry)</i></a><div>&nbsp;</div><a cmd='GALLERY'><img src='"+f+"48_component.png'/><i>Open Component Gallery ...</i></a><div>&nbsp;</div><a cmd='FOLDER'><img src='"+f+"48_folder.png'/><i>Or set empty content.</i></a></div>";this.panel.html(d);this.panel.addHandler("click",this.onclick,this);var e=this._window;var b=$(FM.DialogUtils.buildButton("Close","X",55,"16_close.png",false)).css({position:"absolute",bottom:"3px",right:"1px"}).click(function(){e.close()});a.append(b);this._window.show()};FM.AddContentWindow.prototype={onclick:function(g){var f=_fm_getCommand(g);if(f==""){return}this.designer.updateFolder=true;if(f=="FOLDER"){this.designer.nodeControl="";this.designer.onLoadState(null)}else{if(f=="GALLERY"){this.panel.html("<div style='margin:30px;'>loading ...</div>");ExecuteService('{mode:""}',FM.Path+"Explorer/Dialogs/DialogService.asmx/GetGalleryList",$createDelegate(this.onGalleryloaded,this),_fm_onHandlerError);return}else{if(f=="CUSTOM"){var b=g.target.getAttribute("i");if(!b){return}var d=this.galleryItems[parseInt(b)];this.designer.nodeControl=d.Type;var c=d.Xml;var a={d:{Error:null,Value:c}};this.designer.onLoadState(a)}else{this.designer.nodeControl=f;var c='<mapNode type="'+f+'"></mapNode>';var a={d:{Error:null,Value:c}};this.designer.onLoadState(a)}}}this.designer._node.attr("c",this.designer.nodeControl);this._window.close()},onGalleryloaded:function(a){var d=a.d;var c="<div style='margin:20px 0 0 50px;'>";for(var b=0;b<d.length;b++){c+="<a cmd='CUSTOM' i='"+b+"'>"+d[b].Title+"</a>"}if(d.length==""){c+="We are sorry, but the gallery is empty. <br/>Please, contact with the responsible person."}c+="</div>";this.panel[0].className="fm-addcontent-list";this.panel.html(c);this.galleryItems=d},};