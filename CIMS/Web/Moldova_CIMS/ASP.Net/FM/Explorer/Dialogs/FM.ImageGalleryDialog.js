FM.ImageGalleryDialog=function(){this._window=AX.Window.createPopupWindow("Image Gallery Dialog",535,430,true);this._window.$content.append("<style>div.fm-gallery a { width:40px;height:40px;background-color:#FFF;display:inline-block; margin:7px;border-radius:1px;-webkit-border-radius:1px; moz-border-radius:1px;cursor:pointer;box-shadow: 2px 2px 4px #000;-webkit-box-shadow: 2px 2px 4px #000;-moz-box-shadow: 2px 2px 4px #000;}div.fm-gallery a:hover { background-color:#63a5fe; }div.fm-gallery a img { width:16px;height:16px;margin:12px 0 0 12px; }</style>");this.panel=$("<div style='position:absolute;top:15px;left:21px;right:20px;bottom:50px;' class='fm-gallery'></div>");this._window.$content.append(this.panel);this.panel.addHandler("click",this.onclick,this);this._window.$content.append("<div style='position:absolute;bottom:18px;left:183px;box-shadow:0 0 12px #000;width:164px;height:24px;background-color:#FFF;'></div>");this.navPanel=$("<div style='position:absolute;bottom:24px;left:193px;text-align:center;'><span cmd='0' class='fm-dlg-p-FL1'></span><span cmd='-' class='fm-dlg-p-L1'></span><label style='display:inline-block;position:relative;width:88px;top:1px;'>Page 1</label><span cmd='+' class='fm-dlg-p-R1'></span><span cmd='1' class='fm-dlg-p-LR1'></span></div>");this._window.$content.append(this.navPanel);$("SPAN",this.navPanel).addHandler("mousedown",this.nav_onclick,this);this.pageText=$("label",this.navPanel);this.relPath="/ASP.Net/Images/ico/";ExecuteService('{"relBasePath":"'+this.relPath+'"}',FM.Path+"Explorer/Dialogs/DialogService.asmx/GetImagesList",$.proxy(this.onLoadImages,this),_fm_onHandlerError);this.page=1;this.ipp=54};FM.ImageGalleryDialog.prototype={Show:function(a){this._window.show();this.onSelect=a},getValue:function(){return this.$input[0].value},onLoadImages:function(a){this.imageList=a.d;this.count=this.imageList.length;this.pageCount=Math.floor(this.count/this.ipp);if(this.count%this.ipp!=0){this.pageCount+=1}this.redraw()},redraw:function(){var d=(this.page-1)*this.ipp;var c=(d+this.ipp);var b="";for(var a=d;(a<c&&a<this.count);a++){b+='<a title="'+this.imageList[a]+'"><img src="'+this.relPath+this.imageList[a]+'"/></a>'}this.panel.html(b);this.pageText.text("Page "+this.page+" / "+this.pageCount)},nav_onclick:function(b){var a=$(b.target).attr("cmd");if(a=="0"){this.page=1}else{if(a=="-"){if(this.page>1){this.page-=1}}else{if(a=="+"){if(this.page<this.pageCount){this.page+=1}}else{if(a=="1"){this.page=this.pageCount}}}}this.redraw()},onclick:function(a){var c=a.target;if(c.tagName=="IMG"){c=c.parentNode}if(c.tagName=="A"){var b=$(c).attr("title");this.onSelect(b);this._window.close()}}};