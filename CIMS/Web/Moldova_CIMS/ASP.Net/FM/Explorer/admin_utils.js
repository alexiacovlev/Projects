// IE 9 XMLSerializer changes attributes orders, use native IE parser and deserializer
// Alfa-XP, Michael	Isipciuc, 2012.
//
var xml_IE_DOM=false;function xml_createParser(){if(window.ActiveXObject){xml_IE_DOM=true;var a=new ActiveXObject("Microsoft.XMLDOM");a.async=false;return a}else{return new DOMParser()}}function xml_loadXML(b,a){if(xml_IE_DOM){b.loadXML(a);return b}else{return b.parseFromString(a,"text/xml")}}function xml_convertToString(a){return(xml_IE_DOM)?a.xml:(new XMLSerializer()).serializeToString(a)}function xml_createNode(a,b){return $(a.createElement(b))}function xml_appendNode(c,a,d){var b=$(c.createElement(d));a.append(b);return b}function xml_appendFirst(d,b,e){var c=$(d.createElement(e));var a=b.children();if(a.length==0){b.append(c)}else{c.insertBefore(a.first())}return c}function xml_getOrCreate(c,a,d){var b=a.children(d+":first");if(b.length==0){b=$(c.createElement(d));a.append(b)}return b}function xml_updateNode(c,a,e,d){var b=a.children(e+":first");if(d!=""){if(b.length==0){b=xml_appendNode(c,a,e)}b.text(d)}else{if(b.length!=0){b.remove()}}}function xml_setNodeAttr(e,b,g,c,f,a){var d=b.children(g+":first");if(d.length==0){if(f==""&&!a){return}d=$(e.createElement(g));b.append(d)}d.attr(c,f)}function xml_updateAttr(b,a,c){if(c!=""){b.attr(a,c)}else{b.removeAttr(a)}}function xml_updateAttribute(b,a,c){if(c!=""){b.setAttribute(a,c)}else{b.removeAttribute(a)}}function xml_getAttribute(b,a){return(b?b.getAttribute(a):null)||""}function xml_random(a){return Math.round(Math.random()*a)}RMC_OpenTableSettings=function(a,c){if(!a){return}var b=window.parent.FM.TableSettingsDialog;if(!b){b=window.parent.FM.TableSettingsDialog=new window.parent.AX.Window(false);b.setSize(850,640)}b.refresh_callback=c;b.loadURL(FM.Path+"Explorer/#TableBuilder/t="+a);b.show()};RMC_OpenFormBuilder=function(a,c){if(!a){return}var b=window.parent.FM.FormBuilderDialog;if(!b){b=window.parent.FM.FormBuilderDialog=new window.parent.AX.Window(false);b.setSize(1000,650)}b.loadURL(FM.Path+"Explorer/#FormBuilder/t="+a+"/f="+c);b.show()};RMC_OpenWorkflowBuilder=function(a){if(!a){return}var b=window.parent.FM.WorkflowBuilderDialog;if(!b){b=window.parent.FM.WorkflowBuilderDialog=new window.parent.AX.Window(false);b.setSize(1160,690)}b.loadURL(FM.Path+"Explorer/#WorkflowBuilder/w="+a);b.show()};RMC_initTooltip=function(a){a.mouseover(function(){$(this).next().show()}).mouseout(function(){$(this).next().hide()})};RMC_Dialogs=[];RMC_OpenOrCreate=function(b,i,j,g,d,c,a,f,k){var e=RMC_Dialogs[b];if(!e){FM.ProgressBar.Show("loading",true);e=AX.Window.createPopupWindow(i,j,g,false,false);e.loadASCX(d,c,function(){FM.ProgressBar.Hide();a(e);f(e)});RMC_Dialogs[b]=e}else{if(e.component){f(e)}}e.onclose=k;return e};RMC_createDialog=function(g,e,f,i,d,j){var b=AX.Window.createPopupWindow(g,i,d,false,false);b.setBackground("#999999");var a="";if(e){b.$content.append("<div class='fm-dlg-hdr'><label>"+e+"</label></div>")}else{a=" style='top:0;'"}var k=$("<div class='fm-dlg fm-dlg-content'"+a+"></div>");b.$content.append(k);if(f){k.append(f)}b.$content.append("<div class='fm-dlg-buttons'>"+FM.DialogUtils.buildButton("OK","OK",55,"ok.png",true)+FM.DialogUtils.buildButton("Close","X",55,"16_close.png",false)+"</div>");var c=function(h){switch(_fm_getCommand(h)){case"OK":if(j()){b.close()}break;case"X":b.close();break}};$("div.fm-dlg-buttons",b.$content).click(c);return b};