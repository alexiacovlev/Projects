FM.NumberControl=function(a){};FM.NumberControl.prototype={init:function(){this.isInt=this.base.get("int")=="1";this.tb=this._ui;this.base.initInputBox(this.$ui,this._ui);this.min=this.base.get("min");this.max=this.base.get("max");this.$ui.addHandler("keypress",this.keyPress,this)},keyPress:function(d){var a=d.which;if(a==0||a>=48&&a<=57||a==8||a==9||a==37||a==39){return}var c=String.fromCharCode(a);var b=App.Settings.NumberGroupSeparator;if(c==b||c=="+"||c=="-"){return}if(!this.isInt&&c==App.Settings.NumberDecimalSeparator){return}d.preventDefault()},getNumber:function(){var a=this.base.value;if(a==""||a=="0"){return 0}if(this.isInt){return parseInt(a,10)}else{return parseFloat(a)}},parseTextValue:function(a){if(a==""){return""}try{return Num_parseNumber(a,this.isInt,this.min,this.max)}catch(b){this.base.showTooltip(b);this.tb.value=this.base.prevValue;return null}},setValue:function(a){if(!a){a=0}if(typeof(a)=="string"){a=(this.isInt)?parseInt(a,10):parseFloat(a);if(isNaN(a)){throw fmres("Form__WrongNumber","The number has wrong format")}}this.base.tb_setValue(a,Num_toString(a,this.isInt))}};Num_toString=function(a,d){var e=(d)?0:2;var i=a.toFixed(e);var h=i;var g="";if(!d){var c=i.split(".");h=c[0];g=App.Settings.NumberDecimalSeparator+c[1]}var b=h.length;if(b>3){var f=App.Settings.NumberGroupSeparator;i="";var a=3;while(b>0){b=b-3;if(b<0){a=a+b;b=0}if(i!=""){i=f+i}i=h.substr(b,a)+i}h=i}return h+g};Num_DigitRegexp=new RegExp("[0-9]");Num_parseNumber=function(j,e,d,h){if(j==""){return""}var i=App.Settings.NumberGroupSeparator;var a=App.Settings.NumberDecimalSeparator;var c=new String(j);var g=fmres("Form__WrongNumber","The number has wrong format");if(i!="."&&a!="."&&c.indexOf(".")!=-1){throw g}if(!e&&c.indexOf(i)!=-1&&c.indexOf(a)==-1){throw g}c=c.replace(/\s*/g,"");c=c.replace(/\xA0*/g,"");c=c.replace(new RegExp("\\"+i,"g"),"");c=c.replace(new RegExp("\\"+a,"g"),".");if(c==""){return c}var f=c.length-1;if("("==c.charAt(0)&&")"==c.charAt(f)){c="-"+c.substring(1,f)}else{if("-"==c.charAt(f)){c="-"+c.substring(0,f)}}if(!c.match(/^-?((\d+\.?\d*)|(\.\d+))$/)){throw g}var b=0;if(e){b=parseInt(c,10)}else{b=parseFloat(c)}if(isNaN(b)){throw g}if((d!=null&&b<parseInt(d))||(h!=null&&b>parseInt(h))){throw fmres("Form__WrongRangeNumber","Please enter number between range "+d+" .. "+h)}return b};