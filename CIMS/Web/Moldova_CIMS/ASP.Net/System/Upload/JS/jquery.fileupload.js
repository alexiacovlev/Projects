(function(h){var c="file_upload",f="undefined",g="function",e="number",a,d,b=function(k,i){var j=0;this.complete=function(){j+=1;if(j===i){k()}}};a=function(z){var x=this,s,l,J={namespace:c,uploadFormFilter:function(P){return true},fileInputFilter:function(P){return true},cssClass:c,dragDropSupport:true,dropZone:z,url:function(P){return P.attr("action")},method:function(P){return P.attr("method")},fieldName:function(P){return P.attr("name")},formData:function(P){return P.serializeArray()},multipart:true,multiFileRequest:false,withCredentials:false,forceIframeUpload:false},k={},M={},u=/^http(s)?:\/\//,w,v=function(){return typeof XMLHttpRequest!==f&&typeof File!==f&&(!J.multipart||typeof FormData!==f||typeof FileReader!==f)},F=function(){if(J.dragDropSupport){if(typeof J.onDocumentDragEnter===g){k["dragenter."+J.namespace]=function(P){J.onDocumentDragEnter(P)}}if(typeof J.onDocumentDragLeave===g){k["dragleave."+J.namespace]=function(P){J.onDocumentDragLeave(P)}}k["dragover."+J.namespace]=x.onDocumentDragOver;k["drop."+J.namespace]=x.onDocumentDrop;h(document).bind(k);if(typeof J.onDragEnter===g){M["dragenter."+J.namespace]=function(P){J.onDragEnter(P)}}if(typeof J.onDragLeave===g){M["dragleave."+J.namespace]=function(P){J.onDragLeave(P)}}M["dragover."+J.namespace]=x.onDragOver;M["drop."+J.namespace]=x.onDrop;J.dropZone.bind(M)}l.bind("change."+J.namespace,x.onChange)},j=function(){h.each(k,function(P,Q){h(document).unbind(P,Q)});h.each(M,function(P,Q){J.dropZone.unbind(P,Q)});l.unbind("change."+J.namespace)},n=function(R,P,S,Q){if(typeof Q.onProgress===g){S.upload.onprogress=function(T){Q.onProgress(T,R,P,S,Q)}}if(typeof Q.onLoad===g){S.onload=function(T){Q.onLoad(T,R,P,S,Q)}}if(typeof Q.onAbort===g){S.onabort=function(T){Q.onAbort(T,R,P,S,Q)}}if(typeof Q.onError===g){S.onerror=function(T){Q.onError(T,R,P,S,Q)}}},I=function(P){if(typeof P.url===g){return P.url(P.uploadForm||s)}return P.url},i=function(P){if(typeof P.method===g){return P.method(P.uploadForm||s)}return P.method},t=function(P){if(typeof P.fieldName===g){return P.fieldName(P.fileInput||l)}return P.fieldName},E=function(P){var Q;if(typeof P.formData===g){return P.formData(P.uploadForm||s)}else{if(h.isArray(P.formData)){return P.formData}else{if(P.formData){Q=[];h.each(P.formData,function(R,S){Q.push({name:R,value:S})});return Q}}}return[]},O=function(S){if(u.test(S)){var T=location.host,R=location.protocol.length+2,Q=S.indexOf(T,R),P=Q+T.length;if((Q===R||Q===S.indexOf("@",R)+1)&&(S.length===P||h.inArray(S.charAt(P),["/","?","#"])!==-1)){return true}return false}return true},D=function(Q,R,P){if(P){R.setRequestHeader("X-File-Name",unescape(encodeURIComponent(Q.name)))}R.setRequestHeader("Content-Type",Q.type);R.send(Q)},p=function(R,T,Q){var S=new FormData(),P;h.each(E(Q),function(U,V){S.append(V.name,V.value)});for(P=0;P<R.length;P+=1){S.append(t(Q),R[P])}T.send(S)},r=function(Q,R){var P=new FileReader();P.onload=function(S){Q.content=S.target.result;R()};P.readAsBinaryString(Q)},y=function(V,R,Q,P){var T="--",U="\r\n",S="";h.each(P,function(W,X){S+=T+V+U+'Content-Disposition: form-data; name="'+unescape(encodeURIComponent(X.name))+'"'+U+U+unescape(encodeURIComponent(X.value))+U});h.each(R,function(W,X){S+=T+V+U+'Content-Disposition: form-data; name="'+unescape(encodeURIComponent(Q))+'"; filename="'+unescape(encodeURIComponent(X.name))+'"'+U+"Content-Type: "+X.type+U+U+X.content+U});S+=T+V+T+U;return S},o=function(S,T,R){var U="----MultiPartFormBoundary"+(new Date()).getTime(),P,Q;T.setRequestHeader("Content-Type","multipart/form-data; boundary="+U);P=new b(function(){T.sendAsBinary(y(U,S,t(R),E(R)))},S.length);for(Q=0;Q<S.length;Q+=1){r(S[Q],P.complete)}},K=function(U,R,V,S){var Q=I(S),P=O(Q),T;n(U,R,V,S);V.open(i(S),Q,true);if(P){V.setRequestHeader("X-Requested-With","XMLHttpRequest")}else{if(S.withCredentials){V.withCredentials=true}}if(!S.multipart){D(U[R],V,P)}else{if(typeof R===e){T=[U[R]]}else{T=U}if(typeof FormData!==f){p(T,V,S)}else{if(typeof FileReader!==f){o(T,V,S)}else{h.error("Browser does neither support FormData nor FileReader interface")}}}},L=function(U,T,Q,S,R){var V=new XMLHttpRequest(),P=h.extend({},J);P.fileInput=Q;P.uploadForm=S;if(typeof P.initUpload===g){P.initUpload(U,T,R,V,P,function(){K(T,R,V,P)})}else{K(T,R,V,P)}},N=function(T,S,P,R){if(typeof J.validateFiles===g&&J.validateFiles(S)===false){return}var Q;if(J.multiFileRequest){L(T,S,P,R)}else{for(Q=0;Q<S.length;Q+=1){L(T,S,P,R,Q)}}},m=function(P,R,Q){var S=E(Q);R.find(":input").not(":disabled").attr("disabled",true).addClass(Q.namespace+"_disabled");h.each(S,function(T,U){h('<input type="hidden"/>').attr("name",U.name).val(U.value).addClass(Q.namespace+"_form_data").appendTo(R)});P.attr("name",t(Q)).appendTo(R)},B=function(P,R,Q){P.detach();R.find("."+Q.namespace+"_disabled").removeAttr("disabled").removeClass(Q.namespace+"_disabled");R.find("."+Q.namespace+"_form_data").remove()},H=function(P,V,T,S){var Q=V.attr("action"),U=V.attr("method"),R=V.attr("target");T.unbind("abort").bind("abort",function(W){T.readyState=0;T.unbind("load").attr("src","javascript".concat(":false;"));if(typeof S.onAbort===g){S.onAbort(W,[{name:P.val(),type:null,size:null}],0,T,S)}}).unbind("load").bind("load",function(W){T.readyState=4;if(typeof S.onLoad===g){S.onLoad(W,[{name:P.val(),type:null,size:null}],0,T,S)}h('<iframe src="javascript:false;" style="display:none"></iframe>').appendTo(V).remove()});V.attr("action",I(S)).attr("method",i(S)).attr("target",T.attr("name"));m(P,V,S);T.readyState=2;V.get(0).submit();B(P,V,S);V.attr("action",Q).attr("method",U).attr("target",R)},C=function(T,Q,S){var R=h('<iframe src="javascript:false;" style="display:none" name="iframe_'+J.namespace+"_"+(new Date()).getTime()+'"></iframe>'),P=h.extend({},J);P.fileInput=Q;P.uploadForm=S;R.readyState=0;R.abort=function(){R.trigger("abort")};R.bind("load",function(){R.unbind("load");if(typeof P.initUpload===g){P.initUpload(T,[{name:Q.val(),type:null,size:null}],0,R,P,function(){H(Q,S,R,P)})}else{H(Q,S,R,P)}}).appendTo(S)},G=function(){s=(z.is("form")?z:z.find("form")).filter(J.uploadFormFilter)},q=function(){l=s.find("input:file").filter(J.fileInputFilter)},A=function(P){var Q=P.clone(true);h("<form/>").append(Q).get(0).reset();P.after(Q).detach();q()};this.onDocumentDragOver=function(P){if(typeof J.onDocumentDragOver===g&&J.onDocumentDragOver(P)===false){return false}P.preventDefault()};this.onDocumentDrop=function(P){if(typeof J.onDocumentDrop===g&&J.onDocumentDrop(P)===false){return false}P.preventDefault()};this.onDragOver=function(Q){if(typeof J.onDragOver===g&&J.onDragOver(Q)===false){return false}var P=Q.originalEvent.dataTransfer;if(P){P.dropEffect=P.effectAllowed="copy"}Q.preventDefault()};this.onDrop=function(Q){if(typeof J.onDrop===g&&J.onDrop(Q)===false){return false}var P=Q.originalEvent.dataTransfer;if(P&&P.files&&v()){N(Q,P.files)}Q.preventDefault()};this.onChange=function(R){if(typeof J.onChange===g&&J.onChange(R)===false){return false}var P=h(R.target),Q=h(R.target.form);if(Q.length===1){P.data(c+"_form",Q);A(P)}else{Q=P.data(c+"_form")}if(!J.forceIframeUpload&&R.target.files&&v()){N(R,R.target.files,P,Q)}else{C(R,P,Q)}};this.init=function(P){if(P){h.extend(J,P);w=P}G();q();if(z.data(J.namespace)){h.error('FileUpload with namespace "'+J.namespace+'" already assigned to this element');return}z.data(J.namespace,x).addClass(J.cssClass);J.dropZone.not(z).addClass(J.cssClass);F()};this.options=function(R){var T,Q,S,P;if(typeof R===f){return h.extend({},J)}if(w){h.extend(w,R)}j();h.each(R,function(U,V){switch(U){case"namespace":h.error("The FileUpload namespace cannot be updated.");return;case"uploadFormFilter":S=true;P=true;break;case"fileInputFilter":P=true;break;case"cssClass":T=J.cssClass;break;case"dropZone":Q=J.dropZone;break}J[U]=V});if(S){G()}if(P){q()}if(typeof T!==f){z.removeClass(T).addClass(J.cssClass);(Q?Q:J.dropZone).not(z).removeClass(T);J.dropZone.not(z).addClass(J.cssClass)}else{if(Q){Q.not(z).removeClass(J.cssClass);J.dropZone.not(z).addClass(J.cssClass)}}F()};this.option=function(Q,R){var P;if(typeof R===f){return J[Q]}P={};P[Q]=R;x.options(P)};this.destroy=function(){j();z.removeData(J.namespace).removeClass(J.cssClass);J.dropZone.not(z).removeClass(J.cssClass)}};d={init:function(i){return this.each(function(){(new a(h(this))).init(i)})},option:function(k,l,j){j=j?j:c;var i=h(this).data(j);if(i){if(typeof k==="string"){return i.option(k,l)}return i.options(k)}else{h.error('No FileUpload with namespace "'+j+'" assigned to this element')}},destroy:function(i){i=i?i:c;return this.each(function(){var j=h(this).data(i);if(j){j.destroy()}else{h.error('No FileUpload with namespace "'+i+'" assigned to this element')}})}};h.fn.fileUpload=function(i){if(d[i]){return d[i].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof i==="object"||!i){return d.init.apply(this,arguments)}else{h.error("Method "+i+" does not exist on jQuery.fileUpload")}}}}(jQuery));